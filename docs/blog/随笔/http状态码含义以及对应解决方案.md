# 关于常见 HTTP 状态码的详细总结。

我们将按照状态码的类别进行划分，并对每个重要的状态码提供其 **含义、常见场景、可能的原因** 以及 **排查和解决方案**。

---

### **HTTP 状态码简介**

HTTP 状态码（HTTP Status Code）是由 3 位数字组成的代码，是 HTTP 响应消息中状态行的第一部分。它用来表示客户端 HTTP 请求的完成状态。理解状态码对于 Web 开发、API 调试、SEO 优化和系统运维至关重要。

状态码被分为五大类：

*   **1xx (信息性状态码)**：表示请求已被接收，继续处理。
*   **2xx (成功状态码)**：表示请求已成功被服务器接收、理解、并接受。
*   **3xx (重定向状态码)**：表示需要客户端采取进一步的操作才能完成请求。
*   **4xx (<span style="color:#d59bf6;">客户端</span>错误状态码)**：表示客户端的请求有语法错误或请求无法实现。
*   **5xx (<span style="color:#d59bf6;">服务器</span>错误状态码)**：表示服务器在处理请求的过程中发生了错误。

---

### **1xx 信息性状态码 (Informational)**

这类状态码非常少见，通常只是一个临时的响应，告诉客户端可以继续发送请求或服务器正在切换协议。

#### **100 Continue**
*   **含义**：服务器已经收到了请求头，并且客户端应该继续发送请求体（在有请求体的情况下，例如 POST 请求）。
*   **场景**：当客户端发送一个大的 POST 请求时，可以先发送一个带有 `Expect: 100-continue` 请求头的初始请求。服务器返回 100，表示“好的，你的请求头没问题，把数据发过来吧”。如果请求头有问题，服务器会直接返回一个错误码（如 4xx），避免了客户端浪费带宽传输大量数据。
*   **解决方案**：通常由 HTTP 客户端库和服务器自动处理，开发者无需关心。

#### **101 Switching Protocols**
*   **含义**：服务器根据客户端的请求，正在切换协议。
*   **场景**：最常见的场景是 **WebSocket** 协议的升级。客户端请求从 HTTP 协议升级到 WebSocket 协议，服务器同意后返回 101。
*   **解决方案**：由浏览器、客户端库和服务器框架（如 Nginx, Node.js）自动处理协议升级过程。

---

### **2xx 成功状态码 (Success)**

表示操作被成功接收并处理。

#### **200 OK**
*   **含义**：请求成功。这是最常见的成功状态码。
*   **场景**：
    *   GET 请求：资源已成功获取，并在响应体中返回。
    *   POST 请求：操作成功，响应体中可能包含操作结果。
    *   PUT/DELETE 请求：操作成功，但没有更具体的状态码来表示。
*   **背后信息**：一切正常。

#### **201 Created**
*   **含义**：请求成功，并且服务器创建了一个新的资源。
*   **场景**：在 RESTful API 中，当使用 `POST` 或 `PUT` 请求成功创建一个新用户、一篇文章或其他资源时，应返回 201。
*   **背后信息**：响应头中通常会包含一个 `Location` 字段，指向新创建资源的 URL。例如：`Location: /api/users/123`。

#### **202 Accepted**
*   **含义**：服务器已接受请求，但尚未处理完成。请求最终可能会也可能不会被执行。
*   **场景**：用于 **异步处理**。例如，提交一个需要几分钟才能完成的批处理任务或视频转码任务。服务器立即返回 202，表示“我收到你的任务了，正在后台处理”，而不是让客户端一直等待。
*   **背后信息**：服务器应该提供一种方式让客户端可以查询任务状态，例如在响应体中返回一个任务 ID 或状态查询的 URL。

#### **204 No Content**
*   **含义**：服务器成功处理了请求，但没有返回任何内容（响应体为空）。
*   **场景**：
    *   `DELETE` 请求成功删除资源后。
    *   `PUT` 请求成功更新资源，但不需要返回更新后的资源内容。
*   **背后信息**：这可以节省带宽，因为浏览器或客户端收到 204 后，不需要刷新页面或解析响应体。

#### **206 Partial Content**
*   **含义**：服务器成功处理了部分 GET 请求。
*   **场景**：用于 **断点续传** 或 **分块下载**。当客户端使用 `Range` 请求头请求资源的一部分时，服务器会返回 206，并在响应头中通过 `Content-Range` 字段告知返回的是哪一部分数据。视频播放器的拖动进度条功能也依赖此状态码。

---

### **3xx 重定向状态码 (Redirection)**

客户端需要进行后续操作。

#### **301 Moved Permanently**
*   **含义**：请求的资源已被 **永久** 移动到新的 URL。
*   **场景**：
    *   网站域名更换（`http://old-domain.com` -> `http://new-domain.com`）。
    *   URL 结构调整（`http://site.com/post/123` -> `http://site.com/article/123`）。
    *   HTTP 重定向到 HTTPS。
*   **背后信息**：对 SEO 非常重要。搜索引擎会更新其索引，将旧地址的权重转移到新地址。浏览器会缓存这个重定向，后续对旧地址的请求会直接访问新地址。

#### **302 Found (临时重定向)**
*   **含义**：请求的资源被 **临时** 移动到新的 URL。
*   **场景**：
    *   未登录用户访问需要登录的页面，临时重定向到登录页。登录成功后，再重定向回去。
    *   A/B 测试，临时将部分用户导向不同版本的页面。
*   **背后信息**：搜索引擎不会更新其索引，仍然会抓取旧的地址。浏览器不会缓存这个重定向。

#### **304 Not Modified**
*   **含义**：资源未被修改，客户端可以使用缓存的版本。
*   **场景**：用于 **HTTP 缓存**。客户端在请求时会带上 `If-None-Match`（ETag）或 `If-Modified-Since`（上次修改时间）等请求头。服务器发现资源没有变化，就返回 304，且响应体为空，告诉浏览器直接用本地缓存。
*   **背后信息**：极大地提升了网页加载速度，节省了服务器带宽。

---

### **4xx 客户端错误状态码 (Client Error)**

这是开发和调试中最常遇到的一类错误，表示错误源于客户端。

#### **400 Bad Request**
*   **含义**：服务器无法理解客户端的请求。这是一个非常通用的客户端错误码。
*   **可能原因**：
    1.  **请求语法错误**：URL 格式错误、请求头格式错误等。
    2.  **请求参数无效**：提交的表单数据类型不正确（如需要数字却提供了字符串），或者缺少必要的参数。
    3.  **请求体格式错误**：发送的 JSON、XML 等数据格式不正确，导致服务器无法解析。
    4.  **请求大小过大**：超出了服务器的限制。
*   **解决方案/排查思路**：
    *   **开发者**：使用开发者工具（如 Chrome DevTools 的 Network 面板）检查请求的 URL、请求头、请求体。确认参数名、参数值和数据格式是否符合 API 文档要求。
    *   **API 使用者**：仔细阅读 API 文档，确保请求的每一个部分都正确无误。

#### **401 Unauthorized**
*   **含义**：请求需要 **身份验证**。客户端尚未提供凭据，或提供的凭据无效。通俗讲就是“你没有登录”。
*   **可能原因**：
    1.  **未提供认证信息**：请求头中缺少 `Authorization` 字段。
    2.  **认证信息错误**：提供的 Token、API Key、用户名/密码错误或已过期。
    3.  **认证方案不支持**：客户端使用的认证方案（如 Basic, Bearer）服务器不支持。
*   **解决方案/排查思路**：
    *   **用户**：尝试重新登录。
    *   **开发者**：
        1.  确认是否在请求头中正确添加了 `Authorization` 字段（如 `Authorization: Bearer <your_token>`）。
        2.  检查 Token 是否拼写正确、是否在有效期内、是否被撤销。
        3.  确认认证服务器的配置是否正确。

#### **403 Forbidden**
*   **含义**：服务器理解请求，但拒绝执行。客户端没有 **权限** 访问该资源。
*   **与 401 的区别**：
    *   **401 Unauthorized**：身份问题，表示“你是谁？”（未认证）。
    *   **403 Forbidden**：权限问题，表示“我知道你是谁，但你不能做这个操作”（已认证，但未授权）。
*   **可能原因**：
    1.  **角色权限不足**：用户登录了，但其角色（如普通用户）没有权限访问管理员才能访问的页面或 API。
    2.  **IP 地址被禁止**：服务器配置了 IP 黑名单，客户端 IP 在其中。
    3.  **文件系统权限**：服务器上的文件或目录没有正确的读取/执行权限（例如，Nginx/Apache 用户没有权限读取目标文件）。
    4.  **Web 应用防火墙（WAF）拦截**：请求被 WAF 判断为潜在的攻击（如 SQL 注入、XSS）而被拦截。
*   **解决方案/排查思路**：
    *   **用户**：联系管理员申请权限。
    *   **开发者/运维**：
        1.  检查用户的角色和权限配置。
        2.  检查服务器的防火墙、安全组或 WAF 的拦截日志。
        3.  检查服务器上对应文件/目录的权限设置（`chmod`, `chown`）。

#### **404 Not Found**
*   **含义**：服务器找不到请求的资源。这是最著名的状态码。
*   **可能原因**：
    1.  **URL 拼写错误**：最常见的原因。
    2.  **资源已被删除或移动**：链接是旧的，资源已经不存在了。
    3.  **API 路由不存在**：后端应用中没有定义处理该 URL 的路由规则。
    4.  **静态文件路径错误**：请求的图片、CSS、JS 文件在服务器上路径不正确或不存在。
*   **解决方案/排查思路**：
    *   **用户**：检查 URL 是否有拼写错误。
    *   **开发者**：
        1.  确认 API 路由定义是否正确覆盖了该 URL。
        2.  检查静态文件部署的路径和 Web 服务器的配置。
        3.  对于被删除的资源，可以考虑返回 410 Gone，或设置 301 重定向到相关页面。
    4.  **最佳实践**：创建一个用户友好的自定义 404 页面，引导用户返回首页或进行搜索。

#### **405 Method Not Allowed**
*   **含义**：请求的 HTTP 方法（GET, POST, PUT, DELETE 等）不被该资源所支持。
*   **可能原因**：
    1.  一个只读的资源，客户端却试图使用 `POST` 或 `DELETE` 方法。
    2.  API 路由虽然存在，但只接受 `GET` 请求，而客户端发送了 `POST` 请求。
*   **解决方案/排查思路**：
    *   **开发者**：
        1.  检查 API 文档，确认该 URL 支持哪些 HTTP 方法。
        2.  检查后端代码中路由的定义，确保 HTTP 方法设置正确。
        3.  服务器在返回 405 时，应在响应头的 `Allow` 字段中指明支持的方法，如 `Allow: GET, POST`。

#### **429 Too Many Requests**
*   **含义**：客户端在给定时间内发送了太多的请求，触发了服务器的 **速率限制**（Rate Limiting）。
*   **可能原因**：
    1.  API 被滥用或遭受恶意攻击。
    2.  客户端程序出现 bug，陷入循环，疯狂发送请求。
    3.  正常使用，但超出了 API 提供商设定的配额。
*   **解决方案/排查思路**：
    *   **开发者**：
        1.  在代码中实现 **指数退避**（Exponential Backoff）重试机制，即每次重试前等待更长的时间。
        2.  优化代码，减少不必要的 API 调用。
        3.  检查 API 文档，了解速率限制的具体规则，并在客户端进行相应的节流控制。
        4.  服务器响应中可能会包含 `Retry-After` 头，告知客户端需要等待多久才能再次请求。

---

### **5xx 服务器错误状态码 (Server Error)**

表示服务器端出现了问题，无法完成看似有效的请求。

#### **500 Internal Server Error**
*   **含义**：服务器遇到了一个未知的、无法处理的错误。这是一个非常笼统的错误码。
*   **可能原因**：
    1.  **应用程序代码 Bug**：最常见的原因。代码中出现未捕获的异常（如空指针、数据库查询失败等）。
    2.  **数据库问题**：数据库服务器宕机、连接超时或查询语句错误。
    3.  **外部服务依赖失败**：应用依赖的第三方 API 或微服务不可用。
    4.  **服务器配置错误**：例如，`.htaccess` 文件语法错误。
*   **解决方案/排查思路**：
    *   **用户**：只能等待并稍后重试。可以尝试清除缓存和 Cookie，但这通常无效。
    *   **开发者/运维**：
        1.  **查看服务器日志！** 这是定位 500 错误最关键的一步。错误日志（如 Nginx error log, Apache error log, 应用自身的日志文件）会详细记录异常的类型、位置和堆栈跟踪。
        2.  检查数据库和所有外部服务的健康状况。
        3.  开启应用的调试模式（仅在开发环境），可能会在页面上直接显示错误信息。
        4.  实施代码审查和自动化测试，减少 bug。

#### **502 Bad Gateway**
*   **含义**：服务器作为网关或代理，从上游服务器收到了无效的响应。
*   **场景**：常见于使用反向代理（如 Nginx）的架构中。`客户端 -> Nginx -> 应用服务器 (Node.js/PHP-FPM/Tomcat)`。502 表示 Nginx 与后面的应用服务器通信时出了问题。
*   **可能原因**：
    1.  **上游应用服务器崩溃或未启动**：Nginx 无法连接到应用服务器。
    2.  **上游应用服务器超载**：应用服务器因请求过多而无法响应，导致连接超时。
    3.  **代理配置错误**：Nginx 配置中的代理地址或端口错误。
    4.  **网络问题**：网关和上游服务器之间的网络不通。
*   **解决方案/排查思路**：
    *   **运维**：
        1.  检查上游应用服务器（如 `pm2`, `systemd`, `tomcat`）的进程是否在运行，并查看其日志。
        2.  检查 Nginx 的错误日志，通常会指明连接哪个上游服务器失败。
        3.  检查服务器资源使用情况（CPU、内存），看是否因为资源耗尽导致应用崩溃。
        4.  检查防火墙或网络配置。

#### **503 Service Unavailable**
*   **含义**：服务器当前无法处理请求。这通常是临时性的。
*   **可能原因**：
    1.  **服务器过载**：流量激增，服务器资源（CPU、内存、连接数）耗尽，无法处理新的请求。
    2.  **服务器正在维护**：管理员正在进行部署、升级或重启，临时将服务下线。
*   **解决方案/排查思路**：
    *   **用户**：等待一段时间后重试。
    *   **运维**：
        1.  如果是过载，需要进行扩容（增加服务器实例）或性能优化。
        2.  如果是维护，应配置一个用户友好的维护页面，并尽量缩短维护时间。
        3.  服务器可以在响应头中加入 `Retry-After` 字段，建议客户端在多久后重试。

#### **504 Gateway Timeout**
*   **含义**：服务器作为网关或代理，未能及时从上游服务器获得响应。
*   **与 502 的区别**：
    *   **502 Bad Gateway**：连接到了上游，但上游返回了无效响应或根本没响应（如连接被拒绝）。问题在于 **通信结果**。
    *   **504 Gateway Timeout**：连接到了上游，也发送了请求，但在规定的时间内 **没有等到响应**。问题在于 **等待时间**。
*   **可能原因**：
    1.  **上游应用处理请求时间过长**：一个复杂的数据库查询、一个耗时的计算任务或一个外部 API 调用超时。
    2.  **网络延迟**：网关和上游服务器之间的网络状况不佳。
*   **解决方案/排查思路**：
    *   **开发者/运维**：
        1.  **优化慢查询和耗时代码**：这是根本原因。通过日志和性能分析工具找到瓶颈并进行优化。
        2.  **将长任务异步化**：对于耗时长的操作，应使用 202 Accepted 模式，转为后台异步处理。
        3.  **增加代理的超时时间**：可以适当增加 Nginx 等代理服务器的 `proxy_read_timeout` 等配置项，但这只是治标不治本的方法，可能会掩盖深层次的性能问题。

---

### **总结表**

| 类别    | 状态码 | 名称                  | 核心含义                   |
| :------ | :----- | :-------------------- | :------------------------- |
| **1xx** | 100    | Continue              | 继续发送请求体             |
| **2xx** | 200    | OK                    | 请求成功                   |
|         | 201    | Created               | 资源创建成功               |
|         | 204    | No Content            | 成功，但无返回内容         |
| **3xx** | 301    | Moved Permanently     | 永久重定向                 |
|         | 302    | Found                 | 临时重定向                 |
|         | 304    | Not Modified          | 使用缓存                   |
| **4xx** | 400    | Bad Request           | 请求无效（语法、参数错）   |
|         | 401    | Unauthorized          | 未认证（需要登录）         |
|         | 403    | Forbidden             | 已认证，但无权限           |
|         | 404    | Not Found             | 资源不存在                 |
|         | 405    | Method Not Allowed    | 请求方法不支持             |
|         | 429    | Too Many Requests     | 请求过于频繁（被限流）     |
| **5xx** | 500    | Internal Server Error | 服务器内部代码错误         |
|         | 502    | Bad Gateway           | 网关错误（上游服务出问题） |
|         | 503    | Service Unavailable   | 服务不可用（过载或维护）   |
|         | 504    | Gateway Timeout       | 网关超时（上游响应慢）     |