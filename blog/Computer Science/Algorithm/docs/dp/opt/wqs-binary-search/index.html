
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录、分享">
      
      
        <meta name="author" content="gzh">
      
      
        <link rel="canonical" href="https://gongzihang6.github.io/blog/Computer%20Science/Algorithm/docs/dp/opt/wqs-binary-search/">
      
      
      
      
      <link rel="icon" href="https://s2.loli.net/2025/02/12/aE5ovtzAlNTd9Uh.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Wqs binary search - Blog of GZH</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/简历.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&display=swap">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
    <script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-40HC6RYSR1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-40HC6RYSR1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-40HC6RYSR1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../../../.." title="Blog of GZH" class="md-header__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Blog of GZH
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Wqs binary search
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭自动模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭自动模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 128c0-35.3 28.7-64 64-64h512c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm320 0v256h256V128zm-141.7 47.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4zM160 233.2l19 42.8h-38zM448 164c11 0 20 9 20 20v4h60c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45l-35.2.1h-72c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/ZH-TW/" hreflang="zh-TW" class="md-select__link">
              China(TW)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../.." class="md-tabs__link">
        
  
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../java%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
  
    
  
  Computer Science

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-tabs__link">
          
  
  
    
  
  MachineLearning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-tabs__link">
          
  
  
    
  
  每日诗词

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E6%9C%8B%E5%8F%8B%E5%9C%88/" class="md-tabs__link">
          
  
  
    
  
  朋友圈

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E9%95%BF%E6%9C%9F%E4%B8%BB%E4%B9%89/fitness/" class="md-tabs__link">
          
  
  
    
  
  长期主义

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../about/geren/" class="md-tabs__link">
          
  
  
    
  
  关于

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../.." title="Blog of GZH" class="md-nav__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    Blog of GZH
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    主页
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computer Science
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Java
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java面向对象基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../%E5%B8%B8%E7%94%A8API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java集合框架与常用API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E6%8F%90%E9%AB%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java高级技术
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Algorithm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/%E5%B9%B6%E6%9F%A5%E9%9B%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并查集
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LeetCode热题100
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            LeetCode热题100
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode%E7%83%AD%E9%A2%98100/%E5%AD%97%E6%AF%8D%E5%BC%82%E4%BD%8D%E8%AF%8D%E5%88%86%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字母异位词分组
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LeetCode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            LeetCode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%BA%A4%E6%98%93%E9%80%86%E5%BA%8F%E5%AF%B9%E7%9A%84%E6%80%BB%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    交易逆序对的总数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%8D%95%E8%AF%8D%E6%8E%A5%E9%BE%99/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单词接龙
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%B2%9B%E5%B1%BF%E6%95%B0%E9%87%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    岛屿数量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%88%86%E8%80%83%E5%9C%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分考场
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8B%89%E9%A9%AC%E8%BD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    拉马车
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%88%86%E5%B7%A7%E5%85%8B%E5%8A%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分巧克力
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/k%E5%80%8D%E5%8C%BA%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K倍区间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    编辑距离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8E%A5%E9%9B%A8%E6%B0%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    接雨水
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BB%84%E5%90%88%E6%80%BB%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    组合总和
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%85%A8%E6%8E%92%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    全排列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    乘积最大子数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. 最长回文子串
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%89%8DK%E4%B8%AA%E9%AB%98%E9%A2%91%E5%85%83%E7%B4%A0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    前K个高频元素
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%9C%80%E5%B0%8F%E6%A0%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小栈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/Pow%28x%2Cn%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pow(x,n)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F%E6%97%B6%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络延迟时间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E8%AE%A1%E7%AE%97%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算质数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%AF%B9%E8%A7%92%E7%BA%BF%E4%B8%8A%E7%9A%84%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    对角线上的质数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    零钱兑换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/01%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分查找
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8B%AC%E5%8F%B7%E5%8C%B9%E9%85%8D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    括号匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/300%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    300最长递增子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/115%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    115不同的子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/712%E4%B8%A4%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%8FASCII%E5%88%A0%E9%99%A4%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    712两个字符串的最小ASCII删除和
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/516%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    516最长回文子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/139%E5%8D%95%E8%AF%8D%E6%8B%86%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    139单词拆分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/221%E6%9C%80%E5%A4%A7%E6%AD%A3%E6%96%B9%E5%BD%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    221最大正方形
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2845%E7%BB%9F%E8%AE%A1%E8%B6%A3%E5%91%B3%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2845统计趣味子数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2799%E7%BB%9F%E8%AE%A1%E5%AE%8C%E5%85%A8%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2799统计完全子数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/1399%E7%BB%9F%E8%AE%A1%E6%9C%80%E5%A4%A7%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1399统计最大组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2338%E7%BB%9F%E8%AE%A1%E7%90%86%E6%83%B3%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2338统计理想数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2179%E7%BB%9F%E8%AE%A1%E6%95%B0%E7%BB%84%E4%B8%AD%E5%A5%BD%E4%B8%89%E5%85%83%E7%BB%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2179统计数组中好三元组数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2537%E7%BB%9F%E8%AE%A1%E5%A5%BD%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2537统计好子数组的数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2140%E8%A7%A3%E5%86%B3%E6%99%BA%E5%8A%9B%E9%97%AE%E9%A2%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2140解决智力问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2278%E5%AD%97%E6%AF%8D%E5%9C%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E7%99%BE%E5%88%86%E6%AF%94/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2278字母在字符串中的百分比
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MachineLearning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            MachineLearning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K近邻学习与降维
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E5%A4%9A%E5%88%86%E7%B1%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模型评估与多分类
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E5%85%AC%E5%BC%8F%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    公式测试
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E7%BB%8F%E5%85%B8%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    经典卷积神经网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E7%90%86%E8%A7%A3YOLO%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    理解YOLO网络结构
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    每日诗词
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            每日诗词
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    虞美人·玉阑干外清江浦
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%8F%A9%E8%90%A8%E8%9B%AE%C2%B7%E5%9B%9E%E6%96%87%E5%A4%8F%E9%97%BA%E6%80%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    菩萨蛮·回文夏闺怨
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B8%85%E5%B9%B3%E4%B9%90%C2%B7%E5%85%AD%E7%9B%98%E5%B1%B1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    清平乐·六盘山
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B4%9E%E4%BB%99%E6%AD%8C%C2%B7%E5%92%8F%E6%9F%B3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    洞仙歌·咏柳
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E7%A7%8B%E5%85%B4%E5%85%AB%E9%A6%96%C2%B7%E5%85%B6%E4%B8%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    秋兴八首·其一
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%8E%E5%8F%B2%E9%83%8E%E4%B8%AD%E9%92%A6%E5%90%AC%E9%BB%84%E9%B9%A4%E6%A5%BC%E4%B8%8A%E5%90%B9%E7%AC%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    与史郎中钦听黄鹤楼上吹笛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%A4%8F%E6%97%A5%E5%8D%97%E4%BA%AD%E6%80%80%E8%BE%9B%E5%A4%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    夏日南亭怀辛大
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%A1%8C%E9%A6%99%E5%AD%90%C2%B7%E7%A7%8B%E4%B8%8E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    行香子·秋与
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%87%AA%E9%A2%98%E9%87%91%E5%B1%B1%E7%94%BB%E5%83%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    自题金山画像
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    朋友圈
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            朋友圈
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%9C%8B%E5%8F%8B%E5%9C%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    朋友圈
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    长期主义
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            长期主义
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E9%95%BF%E6%9C%9F%E4%B8%BB%E4%B9%89/fitness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitness
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            关于
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/geren/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    作者个人简介
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/%E7%AE%80%E5%8E%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人简历
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/zcw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    支持作者
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    功能测试
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      引入
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      传统方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="传统方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      几何直观
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      共线情形的处理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      对偶方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="对偶方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lagrange" class="md-nav__link">
    <span class="md-ellipsis">
      Lagrange 对偶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      凸共轭
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      次梯度
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      凸性证明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="凸性证明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      归约为含参凸优化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      利用状态转移方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      四边形不等式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      交换论证
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      例题
    </span>
  </a>
  
    <nav class="md-nav" aria-label="例题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      模板题目
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      区间分拆问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      二维的限制条件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      更广泛的限制条件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      参考资料与注释
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Wqs binary search</h1>

<div class="admonition info">
<p class="admonition-title">💾 AI智能摘要 (DeepSeek)</p>
<p>WQS二分是一种优化带数量限制动态规划问题的高效算法，通过引入惩罚参数将原问题转化为无约束优化问题。其核心思想是利用目标函数关于数量的凸性，通过二分调整惩罚值使得最优解恰好满足数量限制，将复杂度从O(nm)降至O(T(n)logL)。该方法适用于满足凸性条件的组合优化问题，在算法竞赛中常用于处理物品选择等典型场景。</p>
</div>
<div class="admonition info">
<p class="admonition-title">📖 阅读信息</p>
<p>阅读时间：<strong>25</strong> 分钟 | 中文字符：<strong>10074</strong> | 有效代码行数：<strong>9</strong></p>
</div>
<h2 id="_1">引入<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本文介绍利用 WQS 二分优化动态规划问题的方法。在不同的文章中，它也常称作带权二分、凸优化 DP、凸完全单调性 DP、Lagrange 乘子法等，在国外也称作 Aliens Trick。它最早由王钦石在《浅析一类二分方法》一文中总结。</p>
<p>WQS 二分通常用于解决这样一类优化问题：它们带有数量限制，直接求解代价较高；但一旦去除这一限制，问题本身就变得容易得多。</p>
<p>比如，假设要解决的问题是，要从 <span class="arithmatex">\(n\)</span> 个物品中选取 <span class="arithmatex">\(m\)</span> 个，并最优化某个较复杂的目标函数。如果设从前 <span class="arithmatex">\(i\)</span> 个物品中选取 <span class="arithmatex">\(j\)</span> 个，目标函数的最优值为 <span class="arithmatex">\(f(i,j)\)</span>，那么原问题的答案就是 <span class="arithmatex">\(f(n,m)\)</span>。这类问题中，状态转移方程通常是二维的。直接实现该状态转移方程，时间复杂度是 <span class="arithmatex">\(O(nm)\)</span> 的，难以接受。</p>
<p>进一步假设，没有数量限制的最优化问题容易解决。但是，选取到的最优数量未必满足原问题的数量限制。假设选取的物品过多。那么，就可以考虑在选取物品时，为每个选取到的物品都附加一个固定大小的惩罚 <span class="arithmatex">\(k\)</span>（即「带权二分」中的「权」），仍然解没有数量限制的最优化问题。根据 <span class="arithmatex">\(k\)</span> 的取值不同，选取到的最优数量也会有所不同；而且，随着 <span class="arithmatex">\(k\)</span> 的变化，选取到的最优数量也是单调变化的。所以，可以通过二分，找到 <span class="arithmatex">\(k\)</span> 使得选取到的最优数量恰为 <span class="arithmatex">\(m\)</span>。假设此时目标函数的最优值为 <span class="arithmatex">\(f_k(n)\)</span>，那么，只要消除额外附加的惩罚造成的价值损失，就能得到原问题的答案 <span class="arithmatex">\(f(n,m)=f_k(n)+km\)</span>。假设单次求解附加惩罚的问题的复杂度是 <span class="arithmatex">\(O(T(n))\)</span> 的，那么，算法的整体复杂度也就降低到了 <span class="arithmatex">\(O(T(n)\log L)\)</span>，其中，<span class="arithmatex">\(O(\log L)\)</span> 是二分 <span class="arithmatex">\(k\)</span> 需要的次数。</p>
<p>这就是 WQS 二分的基本想法。但是，这一想法能够行得通，前提是 <span class="arithmatex">\(f(n,m)\)</span> 关于 <span class="arithmatex">\(m\)</span> 是凸的。否则，可能不存在使得最优数量恰为 <span class="arithmatex">\(m\)</span> 的附加惩罚 <span class="arithmatex">\(k\)</span>。这也是这种 DP 优化方法常常称为「凸优化 DP」或「凸完全单调性 DP」的原因。</p>
<h2 id="_2">传统方法<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>设非空集合 <span class="arithmatex">\(X\)</span> 为（有限的）决策空间，<span class="arithmatex">\(f:X\rightarrow\mathbf R\)</span> 为目标函数，且另有函数 <span class="arithmatex">\(g:X\rightarrow\mathbf R^d\)</span> 用于施加限制。需要求解的问题，可以看作是计算如下最优化问题的价值函数 <span class="arithmatex">\(v(y)\)</span> 在某处的取值：</p>
<div class="arithmatex">\[
\begin{aligned}
v(y)=\min_{x\in X}\;&amp;f(x)\\
\text{subject to }&amp;g(x)=y.
\end{aligned}
\]</div>
<p>比如，对于前文提到的限制数量的问题，<span class="arithmatex">\(X\)</span> 可以理解为所有物品集合的子集族，<span class="arithmatex">\(x\in X\)</span> 是单个子集，<span class="arithmatex">\(f(x)\)</span> 是单个子集的价值函数，<span class="arithmatex">\(g(x)\)</span> 是子集 <span class="arithmatex">\(x\)</span> 中的元素个数。当然，<span class="arithmatex">\(g(x)\)</span> 并非只能是数量限制，后文提供了更为广泛的限制条件的例子。</p>
<details class="info" open="open">
<summary>约定</summary>
<p>为了行文方便，本文仅讨论最小化目标函数的问题。最大化目标函数的问题与之相仿，只是需要将本文中的（下）凸函数相应地替换成凹函数（或称上凸函数）。或者，可以通过添加负号，将最大化目标函数的问题，转化为最小化它的相反数的问题。</p>
</details>
<h3 id="_3">几何直观<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>因为算法竞赛中遇到的大多数问题都是组合优化问题，决策空间 <span class="arithmatex">\(X\)</span> 通常没有良好的结构，所以，可以转而考察集合</p>
<div class="arithmatex">\[
\mathcal D = \{(g(x),f(x))\in\mathbf R\times\mathbf R^d:x\in X\}.
\]</div>
<p>传统方法能够解决的主要是 <span class="arithmatex">\(d=1\)</span> 的情形，即只有一个限制的情形。下图提供了此时点集 <span class="arithmatex">\(\mathcal D\)</span> 的一种可能的图示。</p>
<p><img alt="" src="../../images/wqs-binary-search/wqs-f-g-space.svg" /></p>
<p>图中的红点和蓝点是 <span class="arithmatex">\(X\)</span> 中所有可能的选择投影在平面 <span class="arithmatex">\((g(x),f(x))\)</span> 上得到的集合 <span class="arithmatex">\(\mathcal D\)</span>。于是，原问题所要求的就是横坐标为 <span class="arithmatex">\(y\)</span> 的那些点中，纵坐标的最小值 <span class="arithmatex">\(v(y)\)</span>。当 <span class="arithmatex">\(y\)</span> 变动时，所有这样的点 <span class="arithmatex">\((y,v(y))\)</span> 就构成了图中的红点的集合。</p>
<p>为了求得点 <span class="arithmatex">\((y,v(y))\)</span> 的纵坐标，可以考虑用斜率为 <span class="arithmatex">\(\lambda\in\mathbf R\)</span> 的直线去切集合 <span class="arithmatex">\(\mathcal D\)</span>。如图所示，当直线的斜率选取得恰当时，经过点 <span class="arithmatex">\((y,v(y))\)</span> 的那条直线，是所有经过集合 <span class="arithmatex">\(\mathcal D\)</span> 中的点且斜率为 <span class="arithmatex">\(\lambda\)</span> 的直线中，截距 <span class="arithmatex">\(f(x)-\lambda g(x)\)</span> 最小的。将这一最小值记为</p>
<div class="arithmatex">\[
h(\lambda) = \min_{x\in X}f(x)-\lambda g(x).
\]</div>
<p>那么，因为 <span class="arithmatex">\((y,v(y))\)</span> 同样位于该直线上，就可以得到原问题的解</p>
<div class="arithmatex">\[
v(y) = h(\lambda) + \lambda y.
\]</div>
<p>假设对于所有合理范围的 <span class="arithmatex">\(\lambda\)</span>，上述函数 <span class="arithmatex">\(h(\lambda)\)</span> 都是容易求解的。这在算法竞赛中常常是成立的，因为它去掉了原问题中的限制条件。那么，现在面临的最为重要的两个问题，就是</p>
<ol>
<li>是否存在这样的直线斜率 <span class="arithmatex">\(\lambda\)</span>，使得它的截距最小值恰好取得在点 <span class="arithmatex">\((y,v(y))\)</span> 处，以及</li>
<li>如果存在，如何找到这样的斜率 <span class="arithmatex">\(\lambda\)</span>。</li>
</ol>
<p>第一个问题相对容易解决。因为当直线斜率 <span class="arithmatex">\(\lambda\)</span> 发生变化时，所有这些直线切出的集合（即它们对应的上半平面的交）必然是一个凸集。因此，这些直线能够经过某个点，当且仅当这个点在该凸集的下凸壳上。这等价于说，函数 <span class="arithmatex">\(v(y)\)</span> 是 <a href="../slope-trick/#离散点集上的凸函数">凸函数</a>。</p>
<p>第二个问题则更为精细。因为所求点的横坐标已经知道是 <span class="arithmatex">\(y\)</span>，所以，一个自然的思路是，计算 <span class="arithmatex">\(h(\lambda)\)</span> 时，顺便求出限制函数 <span class="arithmatex">\(g(x)\)</span> 在当前最优解 <span class="arithmatex">\(x_\lambda\)</span> 处的取值。比如，在前文提到的例子中，求解带惩罚的问题时，可以记录带惩罚的目标函数取得最优解时，选取的物品数量。然后，将 <span class="arithmatex">\(g(x_\lambda)\)</span> 与所期望的 <span class="arithmatex">\(y\)</span> 进行比较，并相应调整下次计算时的 <span class="arithmatex">\(\lambda\)</span> 的取值。这就是最为传统的 WQS 二分的方法。</p>
<p>总结一下，传统 WQS 二分的基本流程如下：</p>
<ol>
<li>初始时，选取一个 <span class="arithmatex">\(\lambda\)</span> 的合理的区间；</li>
<li>在当前的区间中选择一个 <span class="arithmatex">\(\lambda\)</span>；</li>
<li>求解带惩罚的问题 <span class="arithmatex">\(h(\lambda)=\min_{x\in X}f(x)-\lambda g(x)\)</span>，并记录它的最优解 <span class="arithmatex">\(x_\lambda\)</span> 处 <span class="arithmatex">\(g(x)\)</span> 的取值 <span class="arithmatex">\(g(x_\lambda)\)</span>；</li>
<li>如果 <span class="arithmatex">\(g(x_\lambda)=y\)</span>，就得到原问题的最优价值 <span class="arithmatex">\(v(y)=h(\lambda)+\lambda y\)</span>，直接结束算法；</li>
<li>否则，根据 <span class="arithmatex">\(g(x_\lambda)\)</span> 与 <span class="arithmatex">\(y\)</span> 的大小关系，调整 <span class="arithmatex">\(\lambda\)</span> 的区间，并回到步骤 2。</li>
</ol>
<p>这一基本流程已经足以解决一些问题，但并不完善。接下来，本文将讨论对这一基本流程的改进。</p>
<h3 id="_4">共线情形的处理<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>在应用基本流程时，首先遇到的问题就是共线情形无法正确处理。</p>
<p>如果点集 <span class="arithmatex">\(\mathcal D\)</span> 的下凸壳上有三个及以上的红点共线，那么在上述基本流程中，可能无法正确地判断 <span class="arithmatex">\(g(x_\lambda)\)</span> 与 <span class="arithmatex">\(y\)</span> 的大小关系。比如，设共线的三个红点的横坐标分别为 <span class="arithmatex">\(y_1,y_2,y_3\)</span>，且它们共线的直线的斜率为 <span class="arithmatex">\(\lambda^*\)</span>。那么，要正确求解 <span class="arithmatex">\(v(y_2)\)</span>，就必须保证算法终止时，最后计算的问题是 <span class="arithmatex">\(h(\lambda^*)\)</span>，因为 <span class="arithmatex">\(\lambda^*\)</span> 是唯一一个最小化截距时能够经过点 <span class="arithmatex">\((y_2,v(y_2))\)</span> 的直线的斜率。但是，因为在求解 <span class="arithmatex">\(h(\lambda^*)\)</span> 的过程中，记录的 <span class="arithmatex">\(g(x_{\lambda^*})\)</span> 可能是 <span class="arithmatex">\(y_1,y_2,y_3\)</span> 中的任意一个。如果记录到的 <span class="arithmatex">\(g(x_{\lambda^*})\)</span> 不等于 <span class="arithmatex">\(y_2\)</span>，那么算法将错误地继续运行，并向着背离 <span class="arithmatex">\(y_2\)</span> 的方向调整 <span class="arithmatex">\(\lambda\)</span> 的区间，最终将得到错误的结果。</p>
<p>为了解决共线的情形，一种处理方法是在记录最优解 <span class="arithmatex">\(x_\lambda\)</span> 对应的 <span class="arithmatex">\(g(x_\lambda)\)</span> 时，总是使之尽可能大（或尽可能小）。同时，将二分中的终止条件从寻找恰好满足 <span class="arithmatex">\(g(x_\lambda)=y\)</span> 的 <span class="arithmatex">\(\lambda\)</span> 改为寻找满足 <span class="arithmatex">\(g(x_\lambda)\ge y\)</span>（或 <span class="arithmatex">\(g(x_\lambda)\le y\)</span>）的最小（或最大）的 <span class="arithmatex">\(\lambda\)</span>。在上一段的例子中，这相当于计算问题 <span class="arithmatex">\(h(\lambda^*)\)</span> 时，输出的 <span class="arithmatex">\(g(x_{\lambda^*})\)</span> 是 <span class="arithmatex">\(y_3\)</span>。这就保证了算法终止时，最后计算的问题是 <span class="arithmatex">\(h(\lambda^*)\)</span>。实现这一方法时，需要注意最后输出的不是 <span class="arithmatex">\(h(\lambda)+\lambda g(x_{\lambda})\)</span> 而是 <span class="arithmatex">\(h(\lambda)+\lambda y\)</span>，因为记录的 <span class="arithmatex">\(g(x_\lambda)\)</span> 未必等于实际的限制 <span class="arithmatex">\(y\)</span>。</p>
<p>另一种处理方法是实数二分。如果问题涉及的数字都是整数，显然，WQS 二分中的斜率也是整数。在二分中引入实数，是为了保证错误地排除正确选项 <span class="arithmatex">\(\lambda^*\)</span> 时，可以通过小数部分调整回来，最终逼近正确答案 <span class="arithmatex">\(\lambda^*\)</span>。例如，在上面的例子中，如果计算问题 <span class="arithmatex">\(h(\lambda^*)\)</span> 时，记录的 <span class="arithmatex">\(g(x_{\lambda^*})\)</span> 是 <span class="arithmatex">\(y_1\)</span>，小于所希望的 <span class="arithmatex">\(y_2\)</span>，那么，算法就会转而考虑区间 <span class="arithmatex">\((\lambda^*,\lambda_r]\)</span>，其中，<span class="arithmatex">\(\lambda_r\)</span> 是 <span class="arithmatex">\(\lambda\)</span> 所在区间的右端点。对于整数的情形，这一区间实际应该写作 <span class="arithmatex">\([\lambda_*+1,\lambda_r]\)</span>，这就排除了在后续算法中接近正确答案 <span class="arithmatex">\(\lambda^*\)</span> 的可能。但是，实数二分时，考虑的区间仍然是 <span class="arithmatex">\((\lambda^*,\lambda_r]\)</span>，而且，对于该区间中的 <span class="arithmatex">\(\lambda\)</span>，求解 <span class="arithmatex">\(h(\lambda)\)</span> 时记录的 <span class="arithmatex">\(g(x_\lambda)\)</span> 总是不小于 <span class="arithmatex">\(y_3\)</span>，从而严格大于 <span class="arithmatex">\(y_2\)</span> 的。因此，随着算法继续进行，会不断地舍去右半区间，从而，最终得到的 <span class="arithmatex">\(\lambda\)</span> 的范围可以保证在 <span class="arithmatex">\(\lambda^*\)</span> 附近。当然，因为已经知道所求的斜率是一个整数，实数二分终止时的精度不必太高，只要能保证二分的区间中只包含一个整数即可，这一整数就是要寻找的 <span class="arithmatex">\(\lambda^*\)</span>。</p>
<p>正确地处理共线情形后，WQS 二分足以解决绝大多数算法竞赛会遇到的 WQS 二分的问题。但是，这一方法仍然存在一些不足之处：它无法处理 <span class="arithmatex">\(g(x_\lambda)\)</span> 难以记录的情形，也无法处理高维 WQS 二分中多个点共面的情形。本文将进一步考察最优化问题 <span class="arithmatex">\(v(y)\)</span> 的性质，并提出更为一般的处理方法。</p>
<h2 id="_5">对偶方法<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>本节介绍一种 WQS 二分的实现方法，它只要求对于所有 <span class="arithmatex">\(\lambda\in\mathbf R^d\)</span>，可以高效地计算</p>
<div class="arithmatex">\[
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x)
\]</div>
<p>的取值，且原问题的最优价值 <span class="arithmatex">\(v(y)\)</span> 是关于 <span class="arithmatex">\(y\in\mathbf R^d\)</span> 的凸函数<sup id="fnref:high-d-convex"><a class="footnote-ref" href="#fn:high-d-convex">1</a></sup>。用一句话概括，本节将证明原问题的价值函数 <span class="arithmatex">\(v(y)\)</span> 就等于它的对偶问题的最优价值</p>
<div class="arithmatex">\[
v^\star(y) = \sup_{\lambda\in\mathbf R^d} h(\lambda)+\lambda\cdot y,
\]</div>
<p>而对偶问题的目标函数是关于 <span class="arithmatex">\(\lambda\in\mathbf R^d\)</span> 的凹函数，从而是单峰函数，可以通过 <a href="../../../basic/binary/#三分法">三分法</a> 或 <a href="../../../basic/binary/#优化黄金分割法">黄金分割法</a> 高效地求解，复杂度仍然是 <span class="arithmatex">\(O(T(n)\log^d L)\)</span> 的。这就完全地解决了传统 WQS 二分方法中记录 <span class="arithmatex">\(g(x_\lambda)\)</span> 的值可能会出现的问题，同时，允许将 WQS 二分的思想应用至高维的情形。</p>
<p>另外，本节还说明，<span class="arithmatex">\(g(x_\lambda)\)</span> 的范围可以通过 <span class="arithmatex">\(h(\lambda)\)</span> 求得，而无需在求解 <span class="arithmatex">\(h(\lambda)\)</span> 时额外记录。例如，对于 <span class="arithmatex">\(d=1\)</span> 且问题只涉及整数的情形，可以证明 <span class="arithmatex">\(g(x_\lambda)\)</span> 的取值范围恰为</p>
<div class="arithmatex">\[
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
\]</div>
<p>这实际上也对于不得不采取前文所述二分流程的题目，提供了又一种解决共线问题的方法。</p>
<p>接下来，本节将用凸分析的理论证明这些结论成立。至于这些方法的具体应用，可以参考 <a href="#例题">例题</a> 一节。</p>
<h3 id="lagrange">Lagrange 对偶<a class="headerlink" href="#lagrange" title="Permanent link">&para;</a></h3>
<p>考虑用 <a href="https://en.wikipedia.org/wiki/Lagrange_multiplier">Lagrange 乘子法</a> 解决该问题。引入 Lagrange 乘子 <span class="arithmatex">\(\lambda\in\mathbf R^d\)</span>，那么，Lagrangian 可以写作</p>
<div class="arithmatex">\[
L(x,\lambda,y) = f(x) - \lambda\cdot g(x)+\lambda\cdot y.
\]</div>
<p>因为只要 <span class="arithmatex">\(g(x)-y\)</span> 有一个分量非零，就可以让相应的 <span class="arithmatex">\(\lambda\)</span> 的分量趋于（正或负）无穷，所以有</p>
<div class="arithmatex">\[
\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y)
= \begin{cases}
f(x),&amp;g(x)=y,\\
+\infty,&amp;\text{otherwise}.
\end{cases}
\]</div>
<p>这说明，原问题可以写作</p>
<div class="arithmatex">\[
\begin{aligned}
v(y) &amp;= \min_{x\in X}\sup_{\lambda\in\mathbf R^d}L(x,\lambda,y).
\end{aligned}
\]</div>
<p>交换两次最值操作，就得到它的 <a href="https://en.wikipedia.org/wiki/Duality_\(optimization\)">对偶问题</a>：</p>
<div class="arithmatex">\[
\begin{aligned}
v^\star(y)&amp;=\sup_{\lambda\in\mathbf R^d}\min_{x\in X}L(x,\lambda,y)\\
&amp;=\sup_{\lambda\in\mathbf R^d}h(\lambda)+\lambda\cdot y.
\end{aligned}
\]</div>
<p>马上要说明的是，在 <span class="arithmatex">\(v(y)\)</span> 是关于 <span class="arithmatex">\(y\)</span> 的凸函数的条件下，强对偶（strong duality）成立，即 <span class="arithmatex">\(v^\star(y)=v(y)\)</span>。</p>
<h3 id="_6">凸共轭<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>为了说明强对偶成立，需要引入凸共轭的概念。</p>
<details class="abstract" open="open">
<summary>凸共轭</summary>
<p>对于函数 <span class="arithmatex">\(f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}\)</span>，它的 <strong>凸共轭</strong>（convex conjugate），或称 <strong>Legendre–Fenchel 变换</strong>（Legendre–Fenchel transformation），是指函数</p>
<div class="arithmatex">\[
f^*(x^*) = \sup_{x\in\mathbf R^d}x^*\cdot x - f(x).
\]</div>
</details>
<p>从变量 <span class="arithmatex">\(x^*\)</span> 的角度看，<span class="arithmatex">\(f^*(x^*)\)</span> 是一系列线性函数的上确界，所以，必然是 <span class="arithmatex">\(\mathbf R^d\)</span> 上的凸函数。</p>
<details class="info" open="open">
<summary>超平面的「斜率向量」和「截距」</summary>
<p>本文所讨论的向量空间 <span class="arithmatex">\(\mathbf R^{d+1}\)</span> 中的超平面的方程都具有形式</p>
<div class="arithmatex">\[
y = k\cdot x + b.
\]</div>
<p>也就是说，本文不会涉及平行于 <span class="arithmatex">\(y\)</span> 轴的超平面。为表述方便，本文并不严谨地将 <span class="arithmatex">\(k\)</span> 称为该超平面的「斜率向量」，<span class="arithmatex">\(b\)</span> 称为该超平面的「截距」。将这一超平面的方程写成更标准的形式，就是</p>
<div class="arithmatex">\[
k\cdot x - y = -b.
\]</div>
<p>它的一个法向量是 <span class="arithmatex">\((k,-1)\)</span>。因此，所谓的斜率向量其实是将超平面的法向量归一化使得它的最后一个分量等于 <span class="arithmatex">\(-1\)</span> 时，所得到的法向量的前 <span class="arithmatex">\(d\)</span> 个分量。</p>
</details>
<p>几何直观上，函数 <span class="arithmatex">\(f(x)\)</span> 的凸共轭描述的是，对于所有斜率向量为 <span class="arithmatex">\(x^*\)</span> 且与函数 <span class="arithmatex">\(f(x)\)</span> 的上境图</p>
<div class="arithmatex">\[
\operatorname{epi}f = \{(x,y)\in\mathbf R^d\times\mathbf R:f(x)\le y\}
\]</div>
<p>相交的超平面，截距 <span class="arithmatex">\(f(x)-x^*\cdot x\)</span> 的最小值就是 <span class="arithmatex">\(-f^*(x^*)\)</span>。换句话说，函数 <span class="arithmatex">\(f(x)\)</span> 总在超平面 <span class="arithmatex">\(y = x^*\cdot x-f^*(x^*)\)</span> 上方，且与该平面切于点 <span class="arithmatex">\((x_0,f(x_0))\)</span>；当然，可能存在其余的切点。这样的超平面，称为 <span class="arithmatex">\(f(x)\)</span> 在 <span class="arithmatex">\(x_0\)</span> 处的 <strong>支撑超平面</strong>（supporting hyperplane）。函数 <span class="arithmatex">\(f(x)\)</span> 的一个支撑超平面的截距由它的斜率向量唯一确定，凸共轭就提供了这个从斜率向量到截距的映射。</p>
<p>在集合 <span class="arithmatex">\(X\)</span> 上最小化 <span class="arithmatex">\(f(x)-\lambda\cdot g(x)\)</span> 就等价于在集合 <span class="arithmatex">\(\{(y,v(y))\}\)</span> 上最小化 <span class="arithmatex">\(v(y)-\lambda\cdot y\)</span>：</p>
<div class="arithmatex">\[
\begin{aligned}
\min_x f(x)-\lambda\cdot g(x) &amp;= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x) - \lambda\cdot g(x)\right)\\
&amp;= \min_{y\in g(X)}\left(\min_{x\in X:g(x)=y} f(x)\right) - \lambda\cdot y \\
&amp;= \min_{y\in g(X)}v(y) - \lambda\cdot y.
\end{aligned}
\]</div>
<p>因此，有</p>
<div class="arithmatex">\[
h(\lambda) = \min_{y\in g(X)}v(y) - \lambda\cdot y = -v^*(\lambda).
\]</div>
<p>这说明 <span class="arithmatex">\(h(\lambda)\)</span> 是关于 <span class="arithmatex">\(\lambda\in\mathbf R^d\)</span> 的凹函数。进而，有</p>
<div class="arithmatex">\[
v^\star(y) = \sup_{\lambda\in\mathbf R^d}\lambda\cdot y-v^*(\lambda) = v^{**}(y).
\]</div>
<p>也就是说，对偶问题的价值函数 <span class="arithmatex">\(v^{\star}(y)\)</span> 是原问题的价值函数 <span class="arithmatex">\(v(y)\)</span> 的双重凸共轭，也称为 <strong>双共轭</strong>（biconjugate）。</p>
<p>所以，问题转化为：什么样的函数 <span class="arithmatex">\(v(y)\)</span> 满足它的双共轭就等于它自身？这一问题的答案由如下定理给出：</p>
<details class="note" open="open">
<summary>定理（Fenchel–Moreau）</summary>
<p>对于函数 <span class="arithmatex">\(f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}\)</span>，它的双共轭等于它自身，即 <span class="arithmatex">\(f^{**}=f\)</span>，当且仅当以下三个条件之一满足：</p>
<ol>
<li><span class="arithmatex">\(f(x)\)</span> 是正常凸函数且 <a href="https://en.wikipedia.org/wiki/Semi-continuity">下半连续</a>，</li>
<li><span class="arithmatex">\(f(x)\equiv+\infty\)</span>，或</li>
<li><span class="arithmatex">\(f(x)\equiv-\infty\)</span>。</li>
</ol>
</details>
<details class="note">
<summary>证明</summary>
<p>一个函数是正常的（proper），当且仅当它从不取得 <span class="arithmatex">\(-\infty\)</span> 的值，且不永远取得 <span class="arithmatex">\(+\infty\)</span> 的值。</p>
<p>对于非正常函数的情形，可以验证 <span class="arithmatex">\(f(x)\equiv+\infty\)</span> 和 <span class="arithmatex">\(f(x)\equiv-\infty\)</span> 互为共轭。除此之外，只要 <span class="arithmatex">\(f(x)\)</span> 在任何一点处取到 <span class="arithmatex">\(-\infty\)</span>，必然有 <span class="arithmatex">\(f^*(x^*)\equiv+\infty\)</span>。所以，满足 <span class="arithmatex">\(f^{**}=f\)</span> 的非正常函数只有这两种情形。下面的讨论仅限于正常函数。对于正常函数，下半连续且凸的条件等价于它的上境图是闭凸集。</p>
<p>这一条件的必要性是容易的。因为 <span class="arithmatex">\(f=f^{**}\)</span> 是 <span class="arithmatex">\(f^*\)</span> 的凸共轭，作为一系列线性函数的上确界，它的上境图必然是一系列闭凸集的交集，所以必然是闭凸集。这就说明，满足 <span class="arithmatex">\(f^{**}=f\)</span> 的正常函数必然是下半连续且凸的。</p>
<p>反过来，这些条件也是充分的。和其他强对偶定理的证明一样，证明可以分为两步。</p>
<p>第一步，说明弱对偶成立，即 <span class="arithmatex">\(f(x)\ge f^{**}(x)\)</span>。由凸共轭的定义可知，对于所有 <span class="arithmatex">\(x,x^*\in\mathbf R^d\)</span>，都有</p>
<div class="arithmatex">\[
f^*(x^*) \ge x^*\cdot x-f(x).
\]</div>
<p>这就说明，对于所有 <span class="arithmatex">\(x,x^*\in\mathbf R^d\)</span>，同样有</p>
<div class="arithmatex">\[
f(x) \ge x^*\cdot x-f^*(x^*).
\]</div>
<p>对不等式右侧中的 <span class="arithmatex">\(x^*\)</span> 取上确界，就有 <span class="arithmatex">\(f(x)\ge f^{**}(x)\)</span>。</p>
<p>第二步，利用 <a href="https://en.wikipedia.org/wiki/Hyperplane_separation_theorem">超平面分离定理</a> 说明 <span class="arithmatex">\(f(x)\le f^{**}(x)\)</span>。假设不然，存在 <span class="arithmatex">\(x_0\in\mathbf R^d\)</span> 使得 <span class="arithmatex">\(f(x_0)&gt;f^{**}(x_0)\)</span> 成立。因为 <span class="arithmatex">\(f(x)\)</span> 的上境图 <span class="arithmatex">\(\operatorname{epi}(f)\)</span> 是闭凸集，而且单点集 <span class="arithmatex">\(\{(x_0,f^{**}(x_0))\}\)</span> 是紧凸集，所以，根据超平面分离定理，存在 <span class="arithmatex">\((\lambda,t)\in\mathbf R^d\times\mathbf R\)</span> 和 <span class="arithmatex">\(\alpha\in\mathbf R\)</span> 使得对于所有 <span class="arithmatex">\(x\in\operatorname{dom} f:=\{x\in\mathbf R^d:f(x)&lt;+\infty\}\)</span> 和所有 <span class="arithmatex">\(y\ge f(x)\)</span> 都有</p>
<div class="arithmatex">\[
\lambda\cdot x-ty &lt;\alpha &lt;\lambda\cdot x_0 - tf^{**}(x_0)
\]</div>
<p>成立。因为 <span class="arithmatex">\(y\)</span> 可以选得任意大，所以必然有 <span class="arithmatex">\(t\ge 0\)</span>。这又可以分为两种情形。</p>
<p>首先，讨论 <span class="arithmatex">\(t&gt;0\)</span> 的情形。此时，将不等式的各部分都同除以 <span class="arithmatex">\(t\)</span>，并设 <span class="arithmatex">\(\lambda'=t^{-1}\lambda\)</span> 和 <span class="arithmatex">\(\alpha'=t^{-1}\alpha\)</span>，就得到</p>
<div class="arithmatex">\[
\lambda'\cdot x-y &lt; \alpha'&lt; \lambda'\cdot x_0-f^{**}(x_0).
\]</div>
<p>对所有 <span class="arithmatex">\(x\in\operatorname{dom} f\)</span>，令 <span class="arithmatex">\(y=f(x)\)</span>，就都成立</p>
<div class="arithmatex">\[
\alpha' &gt; \lambda'\cdot x - f(x).
\]</div>
<p>故而，对不等号右侧的 <span class="arithmatex">\(x\)</span> 取上确界，有</p>
<div class="arithmatex">\[
\alpha' \ge \sup_{x\in\mathbf R^d}\lambda'\cdot x - f(x) = f^*(\lambda').
\]</div>
<p>进而，有</p>
<div class="arithmatex">\[
f^{**}(x_0) &lt; \lambda'\cdot x_0-f^*(\lambda') \le \sup_{x^*\in\mathbf R^d}x^*\cdot x_0-f^*(x^*) = f^{**}(x_0).
\]</div>
<p>这一矛盾说明 <span class="arithmatex">\(t&gt;0\)</span> 的情形并不成立。</p>
<p>最后，讨论 <span class="arithmatex">\(t=0\)</span> 的情形。事实上，将要说明的是，可以通过微扰，将它转化为 <span class="arithmatex">\(t&gt;0\)</span> 的情形。任取 <span class="arithmatex">\(\lambda_0\in\operatorname{dom}f^*\)</span>，根据凸共轭的定义可知，对于任何 <span class="arithmatex">\(x\in\operatorname{dom}f\)</span> 和 <span class="arithmatex">\(y\ge f(x)\)</span> 都有</p>
<div class="arithmatex">\[
\lambda_0\cdot x-y\le f^*(\lambda_0).
\]</div>
<p>因此，对于任意 <span class="arithmatex">\(\varepsilon&gt;0\)</span>，都有</p>
<div class="arithmatex">\[
(\lambda+\varepsilon\lambda_0)\cdot x - \varepsilon y&lt;\alpha+\varepsilon f^*(\lambda_0).
\]</div>
<p>同时，因为 <span class="arithmatex">\(\alpha&lt;\lambda\cdot x_0\)</span>，所以，对于充分小的 <span class="arithmatex">\(\varepsilon&gt;0\)</span>，又有</p>
<div class="arithmatex">\[
\alpha+\varepsilon f^*(\lambda_0) &lt; (\lambda+\varepsilon\lambda_0)\cdot x_0 - \varepsilon f^{**}(x_0).
\]</div>
<p>因此，如果取 <span class="arithmatex">\(\lambda'=\lambda+\varepsilon\lambda_0\)</span>，<span class="arithmatex">\(t'=\varepsilon\)</span> 和 <span class="arithmatex">\(\alpha'=\alpha+\varepsilon f^*(\lambda_0)\)</span>，那么，就有</p>
<div class="arithmatex">\[
\lambda'\cdot x-t'y &lt;\alpha' &lt;\lambda'\cdot x_0 - t'f^{**}(x_0).
\]</div>
<p>这就又回到了前一种情形，仍然会导致矛盾。</p>
<p>这一矛盾说明，并不存在满足 <span class="arithmatex">\(f(x_0)&gt;f^{**}(x_0)\)</span> 的点 <span class="arithmatex">\(x_0\in\mathbf R^d\)</span>。故而，总有 <span class="arithmatex">\(f(x_0)\le f^{**}(x_0)\)</span>。</p>
<p>结合这两步证明的结果，就得到 <span class="arithmatex">\(f^{**}(x)=f(x)\)</span> 成立。</p>
</details>
<p>因此，强对偶成立，当且仅当 <span class="arithmatex">\(v(y)\)</span> 是关于 <span class="arithmatex">\(y\in\mathbf R^d\)</span> 的凸函数<sup id="fnref:other-conditions"><a class="footnote-ref" href="#fn:other-conditions">2</a></sup>。</p>
<h3 id="_7">次梯度<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>上一节说明了，带惩罚的问题的价值函数 <span class="arithmatex">\(h(\lambda)\)</span> 是原问题的价值函数 <span class="arithmatex">\(v(y)\)</span> 的凸共轭的相反数。因为凸共轭的定义实际上是一个含参数的最优化问题，所以它也成立类似 <a href="https://en.wikipedia.org/wiki/Envelope_theorem">包络定理</a> 的结论。但是，因为凸函数并非处处可微的，所以需要首先将导数的定义推广到凸函数的情形。这就引出了次梯度的概念。</p>
<details class="abstract" open="open">
<summary>次梯度</summary>
<p>对于凸函数 <span class="arithmatex">\(f:\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}\)</span> 和 <span class="arithmatex">\(x_0\in\operatorname{dom}f\)</span>，如果向量 <span class="arithmatex">\(x^*\in\mathbf R^d\)</span> 满足对于任何 <span class="arithmatex">\(x\in\mathbf R^d\)</span>，都有</p>
<div class="arithmatex">\[
f(x) \ge f(x_0)+x^*\cdot(x-x_0),
\]</div>
<p>那么，就称 <span class="arithmatex">\(x^*\)</span> 是 <span class="arithmatex">\(f(x)\)</span> 在 <span class="arithmatex">\(x_0\)</span> 处的一个 <strong>次梯度</strong>（subgradient）。函数 <span class="arithmatex">\(f(x)\)</span> 在 <span class="arithmatex">\(x_0\)</span> 处的全体次梯度的集合称为它在该处的 <strong>次微分</strong>（subdifferential），记作 <span class="arithmatex">\(\partial f(x_0)\)</span>。</p>
</details>
<p>几何直观上，凸函数 <span class="arithmatex">\(f(x)\)</span> 在 <span class="arithmatex">\(x_0\)</span> 处的次微分，就是它在该处的所有支撑超平面的斜率向量的集合。对于一维的情形，次微分</p>
<div class="arithmatex">\[
\partial f(x_0) = [\partial_-f(x_0),\partial_+f(x_0)],
\]</div>
<p>其中，<span class="arithmatex">\(\partial_-f(x_0)\)</span> 和 <span class="arithmatex">\(\partial_+f(x_0)\)</span> 分别是函数 <span class="arithmatex">\(f(x)\)</span> 在 <span class="arithmatex">\(x_0\)</span> 处的左右导数。进一步地，对于整数集上的凸函数 <span class="arithmatex">\(f:\mathbf Z\rightarrow\mathbf R\cup\{\pm\infty\}\)</span> 延拓而来的 <span class="arithmatex">\(\tilde f(x)\)</span>，它在整数点 <span class="arithmatex">\(x=k\)</span> 处的左右导数就是左右两侧的一阶差分：</p>
<div class="arithmatex">\[
\partial\tilde f(k) = [f(k)-f(k-1),f(k+1)-f(k)]. 
\]</div>
<p>显然，凸函数 <span class="arithmatex">\(f(x)\)</span> 在点 <span class="arithmatex">\(x_0\)</span> 处可微，当且仅当它在该处的次微分 <span class="arithmatex">\(\partial f(x_0)\)</span> 是单点集。</p>
<p>因为凸共轭提供了从支撑超平面的斜率向量到它的截距的映射，所以，利用凸共轭，可以判断一个斜率向量 <span class="arithmatex">\(x^*\)</span> 是否是凸函数 <span class="arithmatex">\(f(x)\)</span> 在给定点 <span class="arithmatex">\(x\)</span> 处的一个次梯度。</p>
<details class="note" open="open">
<summary>定理（凸共轭与次梯度）</summary>
<p>对于正常凸函数 <span class="arithmatex">\(f:\mathbf R^d\rightarrow\mathbf R\)</span> 和任意 <span class="arithmatex">\(x,x^*\in\mathbf R^d\)</span>，都有</p>
<div class="arithmatex">\[
x^*\in\partial f(x) \iff x^*\cdot x = f(x) + f^*(x^*).
\]</div>
<p>进而，如果 <span class="arithmatex">\(f\)</span> 还是下半连续的，那么这两个条件都等价于 <span class="arithmatex">\(x\in\partial f^*(x^*)\)</span>。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>按照次梯度的定义，<span class="arithmatex">\(x^*\in\partial f(x)\)</span>，当且仅当</p>
<div class="arithmatex">\[
f(x') \ge f(x) + x^*\cdot(x'-x),~\forall x'\in\mathbf R^d.
\]</div>
<p>这等价于</p>
<div class="arithmatex">\[
x^*\cdot x - f(x) \ge x^*\cdot x'-f(x'),~\forall x'\in\mathbf R^d.
\]</div>
<p>这又等价于</p>
<div class="arithmatex">\[
x^*\cdot x - f(x) \ge \sup_{x'\in\mathbf R^d}x^*\cdot x'-f(x') = f^*(x^*).
\]</div>
<p>但是，依据凸共轭的定义，总是有</p>
<div class="arithmatex">\[
x^*\cdot x - f(x) \le f^*(x^*).
\]</div>
<p>因此，前一式中的大于等于号实际上等价于等号，也就等价于下式</p>
<div class="arithmatex">\[
x^*\cdot x = f(x) + f^*(x^*).
\]</div>
<p>这就完成了第一部分的证明。</p>
<p>对于 <span class="arithmatex">\(f\)</span> 是下半连续的正常凸函数的情形，依 Fenchel–Moreau 定理，有 <span class="arithmatex">\(f^{**}=f\)</span>。因此，这两个条件等价于</p>
<div class="arithmatex">\[
x^*\cdot x = f^*(x^*) + f^{**}(x).
\]</div>
<p>再次应用第一部分的结论，它们也就等价于 <span class="arithmatex">\(x\in\partial f^*(x^*)\)</span>。</p>
</details>
<p>这一结论说明，如果 <span class="arithmatex">\(f^{**}=f\)</span>，那么凸共轭 <span class="arithmatex">\(f^*\)</span> 在 <span class="arithmatex">\(x^*\)</span> 处的次微分 <span class="arithmatex">\(\partial f^{*}(x^*)\)</span>，恰好就是斜率向量为 <span class="arithmatex">\(x^*\)</span> 的支撑超平面与上境图 <span class="arithmatex">\(\operatorname{epi}f\)</span> 的交点的 <span class="arithmatex">\(x\)</span> 分量的集合。</p>
<details class="note" open="open">
<summary>推论</summary>
<p>对于下半连续的正常凸函数 <span class="arithmatex">\(f:\mathbf R^d\rightarrow\mathbf R\)</span> 和任意 <span class="arithmatex">\(x,x^*\in\mathbf R^d\)</span>，都有</p>
<div class="arithmatex">\[
\begin{aligned}
\partial f(x) &amp;= \arg\max_{y^*\in\mathbf R^d} x\cdot y^* - f^*(y^*),\\
\partial f^*(x^*) &amp;= \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y).
\end{aligned}
\]</div>
</details>
<details class="note">
<summary>证明</summary>
<p>下面，证明第二个等式。第一个等式的证明与之类似。</p>
<p>按照凸共轭的定义，有</p>
<div class="arithmatex">\[
f^*(x^*) = \sup_{y\in\mathbf R^d} x^*\cdot y - f(y),
\]</div>
<p>所以，</p>
<div class="arithmatex">\[
x \in \arg\max_{y\in\mathbf R^d} x^*\cdot y - f(y)
\]</div>
<p>当且仅当 <span class="arithmatex">\(f^*(x^*) = x^*\cdot x - f(x)\)</span>，而这一等式成立，又当且仅当 <span class="arithmatex">\(x\in\partial f^*(x^*)\)</span>。这就证明了两个集合是相等的。</p>
</details>
<p>应用到本文的场景中，这一结论说明，求解问题</p>
<div class="arithmatex">\[
h(\lambda) = \min_{x\in X}f(x)-\lambda\cdot g(x) = \min_{y\in g(X)}v(y) - \lambda\cdot y
\]</div>
<p>时，限制函数 <span class="arithmatex">\(g(x)\)</span> 在最优决策集合上的取值恰为 <span class="arithmatex">\(\partial(-h(\lambda))\)</span>。对于 <span class="arithmatex">\(d=1\)</span> 且问题只涉及整数的情形，这一集合就是区间</p>
<div class="arithmatex">\[
[h(\lambda-1)-h(\lambda),h(\lambda)-h(\lambda+1)].
\]</div>
<p>对于连续的整数 <span class="arithmatex">\(\lambda\)</span>，这些区间首尾相接，所以，如果用于二分，只需要计算一侧的端点即可。</p>
<h2 id="_8">凸性证明<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<p>应用 WQS 二分的前提条件是价值函数的凸性。在算法竞赛中，可以通过打表、感性理解等方式猜测凸性成立。但是，严格地证明凸性成立，往往并不容易。本节结合如下经典题目，介绍算法竞赛中常见的证明凸性的方法。</p>
<details class="example" open="open">
<summary>种树问题</summary>
<p>有 <span class="arithmatex">\(n\)</span> 个树坑，要种 <span class="arithmatex">\(m\)</span> 棵树。树不能栽种于相邻的两个坑。给定长度为 <span class="arithmatex">\(n\)</span> 的序列 <span class="arithmatex">\(\{a_i\}\)</span>，表示在每个坑种树的收益，收益可正可负。求种完这 <span class="arithmatex">\(m\)</span> 棵树最大可能的收益和。</p>
<p>简言之，就是在长度为 <span class="arithmatex">\(n\)</span> 的链上，求解大小为 <span class="arithmatex">\(m\)</span> 的最大权独立集的问题。</p>
</details>
<p>这些方法粗略地可以分为四类：</p>
<ul>
<li>归约为凸优化问题（包括 <a href="../../../math/linear-programming/">线性规划</a> 等）的价值函数对参数的凸性，这包括建立 <a href="../../../graph/flow/min-cost/">费用流</a> 模型等方法；</li>
<li>利用状态转移方程也可以归纳地证明凸性成立，过程中可能会用到一些 <a href="../slope-trick/#凸函数的变换">保持凸性的变换</a>；</li>
<li>对于区间分拆类型的问题，可以验证每段区间的成本函数满足 <a href="../quadrangle/">四边形不等式</a>；</li>
<li>最后，对于特殊的问题，也可以通过交换论证直接说明凸性成立。</li>
</ul>
<p>这些证明方法本身往往都同该问题的某种解法联系在一起。</p>
<h3 id="_9">归约为含参凸优化<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>考虑如下形式的含参凸优化问题：</p>
<div class="arithmatex">\[
v(y)=\inf_{x\in\mathcal D(y)} f(x,y).
\]</div>
<p>其中，目标函数 <span class="arithmatex">\(f:\mathbf R^n\times\mathbf R^d\rightarrow\mathbf R\cup\{\pm\infty\}\)</span> 对于每个 <span class="arithmatex">\(y\in\mathbf R^d\)</span> 都是关于 <span class="arithmatex">\(x\in\mathbf R^m\)</span> 的凸函数，而可行域 <span class="arithmatex">\(\mathcal D:\mathbf R^d\rightarrow \mathcal P(\mathbf R^m)\)</span> 是 <span class="arithmatex">\(\mathbf R^d\)</span> 上的集合值函数，且对于每个 <span class="arithmatex">\(y\in\mathbf R^d\)</span>，集合 <span class="arithmatex">\(\mathcal D(y)\)</span> 都是凸集。这些条件保证了对于任意参数 <span class="arithmatex">\(y\in\mathbf R^d\)</span>，这都是一个凸优化问题。</p>
<details class="note" open="open">
<summary>定理</summary>
<p>假设上述含参凸优化问题满足如下条件：</p>
<ol>
<li>目标函数 <span class="arithmatex">\(f(x,y)\)</span> 是关于 <span class="arithmatex">\((x,y)\)</span> 的凸函数；</li>
<li>可行域映射 <span class="arithmatex">\(y\mapsto\mathcal D(y)\)</span> 的图像 <span class="arithmatex">\(\{(x,y):x\in\mathcal D(y)\}\)</span> 是凸集。</li>
</ol>
<p>如果对于任意 <span class="arithmatex">\(y\in\mathbf R^d\)</span>，都有 <span class="arithmatex">\(v(y)&gt;-\infty\)</span>，那么，价值函数 <span class="arithmatex">\(v(y)\)</span> 是关于 <span class="arithmatex">\(y\)</span> 的正常凸函数。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>对于任意 <span class="arithmatex">\(y_1,y_2\in\mathbf R^d\)</span> 和 <span class="arithmatex">\(\alpha\in(0,1)\)</span>，需要证明</p>
<div class="arithmatex">\[
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
\]</div>
<p>如果 <span class="arithmatex">\(v(y_1)=+\infty\)</span> 或 <span class="arithmatex">\(v(y_2)=+\infty\)</span>，那么不等式的右侧就是 <span class="arithmatex">\(+\infty\)</span>，不等式必然成立。否则，<span class="arithmatex">\(v(y_1)\)</span> 和 <span class="arithmatex">\(v(y_2)\)</span> 都是有限值。对于任意 <span class="arithmatex">\(\varepsilon&gt;0\)</span> 和 <span class="arithmatex">\(i=1,2\)</span>，都存在 <span class="arithmatex">\(x_i\in\mathcal D(y_i)\)</span> 使得 <span class="arithmatex">\(f(x_i,y_i)&lt; v(y_i)+\varepsilon\)</span> 成立。利用映射 <span class="arithmatex">\(\mathcal D\)</span> 的图像的凸性可知</p>
<div class="arithmatex">\[
\alpha x_1+(1-\alpha)x_2 \in \mathcal D(\alpha y_1+(1-\alpha)y_2).
\]</div>
<p>也就是说，<span class="arithmatex">\(\alpha x_1+(1-\alpha)x_2\)</span> 是参数为 <span class="arithmatex">\(\alpha y_1+(1-\alpha)y_2\)</span> 的最优化问题的一个可行解。利用最优化条件和目标函数的凸性可知</p>
<div class="arithmatex">\[
\begin{aligned}
v(\alpha y_1+(1-\alpha)y_2)
&amp;\le f(\alpha x_1+(1-\alpha)x_2,\alpha y_1+(1-\alpha)y_2) \\
&amp;\le \alpha f(x_1,y_1) + (1-\alpha)f(x_2,y_2) \\
&amp;&lt; \alpha v(y_1) + (1-\alpha) v(y_2) + \varepsilon.
\end{aligned}
\]</div>
<p>因为 <span class="arithmatex">\(\varepsilon\)</span> 的选取是任意的，令 <span class="arithmatex">\(\varepsilon\rightarrow 0\)</span>，就有</p>
<div class="arithmatex">\[
v(\alpha y_1+(1-\alpha)y_2) \le \alpha v(y_1) + (1-\alpha) v(y_2).
\]</div>
<p>因此，价值函数 <span class="arithmatex">\(v(y)\)</span> 的凸性成立。</p>
</details>
<p>算法竞赛中，最为常见的凸优化问题就是线性规划问题。</p>
<details class="note" open="open">
<summary>推论</summary>
<p>设 <span class="arithmatex">\(c\in\mathbf R^n\)</span>，<span class="arithmatex">\(A_1\in\mathbf R^{d_1\times n}\)</span>，<span class="arithmatex">\(A_2\in\mathbf R^{d_2\times n}\)</span>，<span class="arithmatex">\(y_1\in\mathbf R^{d_1}\)</span>，<span class="arithmatex">\(y_2\in\mathbf R^{d_2}\)</span>。考虑如下含参线性规划问题：</p>
<div class="arithmatex">\[
v(y_1,y_2)=\min_{x\in\mathbf R^n} c\cdot x \text{ subject to }A_1x\le y_1,A_2x=y_2,x\ge 0.
\]</div>
<p>那么，价值函数 <span class="arithmatex">\(v(y_1,y_2)\)</span> 是关于 <span class="arithmatex">\((y_1,y_2)\)</span> 的凸函数。</p>
</details>
<p>无论是不等式约束，还是等式约束，线性规划的价值函数都是约束条件参数的凸函数。</p>
<p>很多图论问题都可以写成线性规划问题的形式：</p>
<ul>
<li>网络流问题：最大流、最小割、最小费用流；</li>
<li>无负环的最短路问题；</li>
<li>二分图的最大（权）匹配、最小点覆盖等问题；</li>
<li>一般图的最大（权）匹配问题；</li>
<li>最小生成树问题<sup id="fnref:mst"><a class="footnote-ref" href="#fn:mst">3</a></sup>。</li>
</ul>
<p>因此，这些问题的价值函数都是这些问题的参数的凸（凹）函数。</p>
<details class="warning" open="open">
<summary>整数约束</summary>
<p>利用图论模型为实际问题建模时，通常有隐含的整数限制，例如一条边只能选或不选、流量只能是整数等。因此，它们只能转化为整数线性规划（integer linear programming, ILP）问题而非线性规划（LP）问题。因为 ILP 问题并非凸优化问题，所以它的价值函数未必是该问题的参数的凸函数。将一个 ILP 问题中的整数约束松弛掉后就得到一个 LP 问题，但后者未必存在满足整数约束的最优解。因此，松弛整数约束后得到的 LP 的最优价值有可能严格优于相应的 ILP 问题，两者未必等价。</p>
<p>上文列举的那些图论问题，都可以写成一个 LP 问题而不需要施加整数约束；但对于其他的一些问题，例如一般图的最大独立集问题等，整数约束则是必要的。另外，即使一个图论问题可以写成 LP 的形式，在该问题引入额外的线性约束条件后，仍然可能会破坏相应的 ILP 问题和 LP 问题的等价性，从而这个带约束的图论问题不再能够写成线性规划的形式。</p>
</details>
<p>例如，在费用流的语境下，有如下常见结论：</p>
<details class="note" open="open">
<summary>推论</summary>
<p><a href="../../../graph/flow/min-cost/">最小费用流模型</a> 中，最小费用 <span class="arithmatex">\(v(m)\)</span> 是流量 <span class="arithmatex">\(m\)</span> 的凸函数。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>设有向图 <span class="arithmatex">\(G=(V,E)\)</span>，边 <span class="arithmatex">\((i,j)\)</span> 的容量为 <span class="arithmatex">\(c_{ij}\)</span>，单位流量的费用为 <span class="arithmatex">\(w_{ij}\)</span>,，源点和汇点分别为 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(t\)</span>。记决策变量为 <span class="arithmatex">\(\{f_{ij}\}\)</span>，其中，<span class="arithmatex">\(f_{ij}\)</span> 为边 <span class="arithmatex">\((i,j)\in E\)</span> 的流量。那么，最小费用流可以写成如下线性规划问题：</p>
<div class="arithmatex">\[
\begin{aligned}
v(m)=\min_{\{f_{ij}\}}\;&amp;\sum_{(i,j)\in E}w_{ij}f_{ij}\\
\text{subject to }&amp;\sum_{(j,i)\in E}f_{ji} - \sum_{(i,j)\in E}f_{ij} = 
\begin{cases}
-m, &amp; i=s,\\
m,  &amp; i=t,\\
0,  &amp; \text{otherwise},
\end{cases}
~\forall i\in V,\\
&amp;0\le f_{ij}\le c_{ij},~\forall (i,j)\in E.
\end{aligned}
\]</div>
<p>因此，最小费用 <span class="arithmatex">\(v(m)\)</span> 是参数 <span class="arithmatex">\(m\)</span> 的凸函数。</p>
</details>
<p>算法竞赛中很多问题都可以归约为网络流等图论问题，从而都可以通过类似的方式建立价值函数的凸性。</p>
<p>利用这一方法，可以得到种树问题的第一个凸性证明：</p>
<details class="example">
<summary>凸性证明一</summary>
<p>种树问题的最大收益实际上可以通过如下最大费用最大流模型得出：</p>
<ul>
<li>从源点 <span class="arithmatex">\(s\)</span> 出发，向结点 <span class="arithmatex">\(r\)</span>，连接一条容量为 <span class="arithmatex">\(m\)</span>、费用为 <span class="arithmatex">\(0\)</span> 的边；</li>
<li>从结点 <span class="arithmatex">\(r\)</span> 出发，向每个奇数结点 <span class="arithmatex">\(i=1,3,\cdots,2\lceil n/2\rceil-1\)</span> 连接一条容量为 <span class="arithmatex">\(1\)</span>、费用为 <span class="arithmatex">\(0\)</span> 的边；</li>
<li>从每个偶数结点 <span class="arithmatex">\(i=0,2,\cdots,2\lfloor n/2\rfloor\)</span> 出发，向汇点 <span class="arithmatex">\(t\)</span> 连接一条容量为 <span class="arithmatex">\(1\)</span>、费用为 <span class="arithmatex">\(0\)</span> 的边；</li>
<li>对于每个 <span class="arithmatex">\(i=1,\cdots,n\)</span>，从 <span class="arithmatex">\(i-1\)</span> 和 <span class="arithmatex">\(i\)</span> 中的奇数结点出发，向偶数结点连接一条容量为 <span class="arithmatex">\(1\)</span>、费用为 <span class="arithmatex">\(a_i\)</span> 的边。</li>
</ul>
<p>最终答案就是求得的最大费用。将这一图论模型转换为相应的线性规划问题（具体见上文推论的证明），那么，总流量 <span class="arithmatex">\(m\)</span> 将出现在表示边 <span class="arithmatex">\((s,r)\)</span> 的流量限制的不等式中。由推论可知，最大费用 <span class="arithmatex">\(v(m)\)</span> 是流量 <span class="arithmatex">\(m\)</span> 的凹函数。</p>
<p>利用该费用流模型，可以通过模拟费用流或 <a href="../../../basic/greedy/#后悔解法">反悔贪心</a> 的方法在 <span class="arithmatex">\(O(n\log n)\)</span> 的复杂度内解决该问题。</p>
</details>
<h3 id="_10">利用状态转移方程<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>尽管状态转移方程无法提供有效的计算方式，但是，它常常可以用于证明状态函数 <span class="arithmatex">\(f(i,j)\)</span> 对于参数 <span class="arithmatex">\(j\)</span> 具有凸性。具体地说，就是将 <span class="arithmatex">\(f(i,\cdot)\)</span> 这一函数视为 <span class="arithmatex">\(i\)</span> 处的状态，就可以将关于 <span class="arithmatex">\(f(i,j)\)</span> 的状态转移方程看作是关于 <span class="arithmatex">\(f(i,\cdot)\)</span> 的递推关系，从而可以归纳地证明每个 <span class="arithmatex">\(f(i,\cdot)\)</span> 都是凸函数。这类证明凸性的方法在 <a href="../slope-trick/">Slope Trick 优化 DP</a> 的场景中更为常见，该页面也讨论了常见的保持凸性的变换。</p>
<p>这一方法同样可以用于证明种树问题的凸性：</p>
<details class="example">
<summary>凸性证明二</summary>
<p>设 <span class="arithmatex">\(f(i,j)\)</span> 为前 <span class="arithmatex">\(i\)</span> 个坑种 <span class="arithmatex">\(j\)</span> 棵树时的最大收益。考察如下状态转移方程：</p>
<div class="arithmatex">\[
f(i,j) = \max\{f(i-1,j),f(i-2,j-1)+a_i\}.
\]</div>
<p>将这一状态转移方程看作是函数 <span class="arithmatex">\(f(i,\cdot)\)</span> 的递推关系式。因为最值符号内涉及两个不同的函数，这并不能表达为卷积上确界的形式。但是，仍然可以通过归纳的方法证明函数 <span class="arithmatex">\(f(i,\cdot)\)</span> 是凹函数。</p>
<p>实际上，需要归纳地证明如下两点：</p>
<ul>
<li><span class="arithmatex">\(f(i,j)-f(i-2,j-1)\)</span> 关于 <span class="arithmatex">\(j\)</span> 递减；</li>
<li><span class="arithmatex">\(f(i,j)-f(i-1,j)\)</span> 关于 <span class="arithmatex">\(j\)</span> 递增。</li>
</ul>
<p>归纳起点是平凡的。假设它们对于所有 <span class="arithmatex">\(i-1\)</span> 及之前的自然数都成立，现在证明它对 <span class="arithmatex">\(i\)</span> 也成立。直接验证即可。</p>
<p>首先，由归纳假设，有</p>
<div class="arithmatex">\[
f(i-1,j) - f(i-2,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j)-f(i-1,j))
\]</div>
<p>关于 <span class="arithmatex">\(j\)</span> 递减。所以，有</p>
<div class="arithmatex">\[
f(i,j) - f(i-2,j-1) = \max\{f(i-1,j) - f(i-2,j-1), a_i\}
\]</div>
<p>关于 <span class="arithmatex">\(j\)</span> 递减，且</p>
<div class="arithmatex">\[
f(i,j) - f(i-1,j) = \max\{0,a_i-(f(i,j) - f(i-2,j-1))\}
\]</div>
<p>关于 <span class="arithmatex">\(j\)</span> 递增。这就完成了归纳。</p>
<p>进而，有</p>
<div class="arithmatex">\[
f(i,j) - f(i,j-1) = (f(i,j)-f(i-2,j-1)) - (f(i,j-1) - f(i-1,j-1)) - (f(i-1,j-1) - f(i-2,j-1))
\]</div>
<p>关于 <span class="arithmatex">\(j\)</span> 递减。这就说明 <span class="arithmatex">\(f(i,j)\)</span> 是关于 <span class="arithmatex">\(j\)</span> 的凹函数，从而，价值函数 <span class="arithmatex">\(v(m)=f(n,m)\)</span> 是关于 <span class="arithmatex">\(m\)</span> 的凹函数。</p>
<p>这个证明的一个副产品是，对于任意 <span class="arithmatex">\(i\)</span>，都存在 <span class="arithmatex">\(p_i\)</span> 使得</p>
<div class="arithmatex">\[
f(i,j) =
\begin{cases}
f(i-1,j), &amp; j\le p_i,\\
f(i-2,j-1) + a_i, &amp; j&gt; p_i.
\end{cases}
\]</div>
<p>这说明，可以通过平衡树直接维护序列 <span class="arithmatex">\(f(i,\cdot)\)</span>，复杂度是 <span class="arithmatex">\(O(n\log^2n)\)</span> 的。但是，好处是可以处理任意种树间隔的一般情形，且一次性地获得了所有 <span class="arithmatex">\(v(m)\)</span> 的值。</p>
</details>
<h3 id="_11">四边形不等式<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>算法竞赛中，另一类常见的成立凸性的问题是 <a href="../quadrangle/#区间分拆问题">区间分拆问题</a>。该页面证明了，如果单个区间的成本函数满足四边形不等式，那么限制区间个数的区间分拆问题的最小成本是区间个数的凸函数。该页面同样提供了一些判断某个函数 <span class="arithmatex">\(w(l,r)\)</span> 是否满足四边形不等式的方法。最为直接的方法就是计算它的二阶混合差分：</p>
<div class="arithmatex">\[
\begin{aligned}
\Delta_l \Delta_r w(l,r) &amp;= \Delta_l(w(l,r+1)-w(l,r)) \\
&amp;= w(l+1,r+1)-w(l+1,r)-w(l,r+1)+w(l,r).
\end{aligned}
\]</div>
<p>函数 <span class="arithmatex">\(w(l,r)\)</span> 满足四边形不等式，当且仅当 <span class="arithmatex">\(\Delta_l \Delta_r w(l,r)\)</span> 非正。直观上，满足四边形不等式的函数通常意味着，区间向两侧扩大——即左端点向左移动和右端点向右移动——具有某种协同效应。</p>
<p>种树问题同样可以看作是一个区间分拆问题，可以通过验证四边形不等式进行证明。</p>
<details class="example">
<summary>凸性证明三</summary>
<p>在种树的收益序列前添加一个 <span class="arithmatex">\(a_0\)</span>，它可以是任何值。然后，种树问题就等价于将序列 <span class="arithmatex">\(\{a_0,a_1,\cdots,a_n\}\)</span> 分成 <span class="arithmatex">\(m\)</span> 段，且每段的收益函数为</p>
<div class="arithmatex">\[
w(l,r) = \max_{i\in[l+1,r]} a_i
\]</div>
<p>的区间分拆问题。也就是说，每一段的收益是除去第一棵树外，其余树的收益的最大值——这就保证了间隔种树。</p>
<p>因为这是最大化问题，需要验证「交叉大于包含」，即对于任意 <span class="arithmatex">\(a&lt;b&lt;c&lt;d\)</span>，都成立</p>
<div class="arithmatex">\[
w(a,c)+w(b,d) \ge w(a,d)+w(b,c).
\]</div>
<p>代入收益函数的表达式，并设</p>
<div class="arithmatex">\[
A = \max_{i\in[a+1,b]} a_i,~ B = \max_{i\in[b+1,c]} a_i,~ C = \max_{i\in[c+1,d]}a_i,
\]</div>
<p>则要证明的不等式可以写作</p>
<div class="arithmatex">\[
\max\{A,B\} + \max\{B,C\} \ge \max\{A,B,C\} + B.
\]</div>
<p>注意到不等号左侧的两项 <span class="arithmatex">\(\max\{A,B\}\)</span> 和 <span class="arithmatex">\(\max\{B,C\}\)</span> 中较大的那个就等于 <span class="arithmatex">\(\max\{A,B,C\}\)</span>，而它们中较小的那个总是不小于 <span class="arithmatex">\(B\)</span>，因此该不等式成立。</p>
<p>将种树问题转化为区间分拆问题后，只需要用 ST 表等方式预处理区间最值，可以单次 <span class="arithmatex">\(O(1)\)</span> 地计算单个区间的成本，就可以套用区间分拆问题的算法在 <span class="arithmatex">\(O(n\log n\log L)\)</span> 或 <span class="arithmatex">\(O(n(n+m))\)</span> 的时间复杂度内解决该问题。该方法同样可以处理任意种树间隔的问题。</p>
</details>
<h3 id="_12">交换论证<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>组合优化问题中，证明价值函数的凸性常常会用到交换论证（exchange argument）。具体地说，就是从参数为 <span class="arithmatex">\(m-1\)</span> 和 <span class="arithmatex">\(m+1\)</span> 的问题的最优解出发，通过交换部分元素，构造出参数为 <span class="arithmatex">\(m\)</span> 且价值不超过 <span class="arithmatex">\((v(m-1)+v(m+1))/2\)</span> 的可行解，从而利用 <span class="arithmatex">\(v(m)\)</span> 的最优性来证明凸性的论证方法。相较于凸优化的情形，组合优化问题中并不存在自然地构造两个解的「中间形态」的方法，因此，交换论证的应用通常具有一定的技巧性。</p>
<details class="warning" open="open">
<summary>「边际成本递增」并不一定导致凸性</summary>
<p>组合优化问题中，目标函数常常具有一些「边际成本递增」的性质，但是这并不必然导致凸性。一个典型的例子是 <a href="https://www.luogu.com.cn/problem/P3354">[IOI 2005] Riv 河流</a>，该问题的链上版本是满足四边形不等式因而具有凸性的，但是树上版本存在凸性不成立的例子。</p>
<p>用于刻画「边际成本递增」的一个常见性质是函数的超模性（supermodularity）。对于有限集合 <span class="arithmatex">\(X\)</span> 的子集族 <span class="arithmatex">\(\mathcal PX\)</span> 上的函数 <span class="arithmatex">\(f:\mathcal PX\rightarrow\mathbf R\)</span>，如果它满足以下两条等价性质之一：</p>
<ol>
<li>（交叉小于包含）对于任何子集 <span class="arithmatex">\(A,B\subseteq X\)</span>，都有 <span class="arithmatex">\(f(A)+f(B) \le f(A\cup B) + f(A\cap B)\)</span> 成立；</li>
<li>（边际成本递增）对于任何子集 <span class="arithmatex">\(A\subseteq B\subseteq X\)</span> 以及 <span class="arithmatex">\(x\in X\setminus B\)</span>，都有 <span class="arithmatex">\(f(A\cup\{x\})-f(A)\le f(B\cup\{x\})-f(B)\)</span> 成立；</li>
</ol>
<p>就称函数 <span class="arithmatex">\(f\)</span> 是 <strong>超模的</strong>（supermodular）。但是，超模函数作为目标函数的最优化问题中，价值函数</p>
<div class="arithmatex">\[
v(m) = \min_{A\subseteq X} f(A) \text{ subject to }|A|=m
\]</div>
<p><strong>未必</strong> 是 <span class="arithmatex">\(m\)</span> 的凸函数。究其原因，就是从子集大小分别为 <span class="arithmatex">\(m-1\)</span> 和 <span class="arithmatex">\(m+1\)</span> 的最优解，一般来说是无法构造出子集大小为 <span class="arithmatex">\(m\)</span> 且满足前述价值函数大小关系的可行解的。</p>
</details>
<p>交换论证提供了种树问题凸性的又一种证明方式。</p>
<details class="example">
<summary>凸性证明四</summary>
<p>利用交换论证。设种 <span class="arithmatex">\(m-1\)</span> 棵树和种 <span class="arithmatex">\(m+1\)</span> 棵树的最优方案分别由 <span class="arithmatex">\(\{x_i^{(m-1)}\}\in\{0,1\}^n\)</span> 和 <span class="arithmatex">\(\{x_i^{(m+1)}\}\in\{0,1\}^n\)</span> 给出，其中，取值为 <span class="arithmatex">\(1\)</span> 表示该坑位种了一棵树，取值为 <span class="arithmatex">\(0\)</span> 表示该坑位没有种树。定义序列 <span class="arithmatex">\(\{z_i\}\in\{0,\pm 1\}^n\)</span> 满足</p>
<div class="arithmatex">\[
z_i = x_i^{(m+1)} - x_i^{(m-1)},~i=1,\cdots,n.
\]</div>
<p>这个序列标记了两个种树方案的差异。这一序列中取值为 <span class="arithmatex">\(0\)</span> 的位置表示该坑位要么在两个方案中都种了一棵树，要么在两个方案中都没有种树；而取值为 <span class="arithmatex">\(-1\)</span> 和 <span class="arithmatex">\(+1\)</span> 的位置则分别表示只在方案 <span class="arithmatex">\(x^{(m-1)}\)</span> 或只在方案 <span class="arithmatex">\(x^{(m+1)}\)</span> 中，该坑位种了一棵树。因为任何方案中都不能在相邻的坑位种树，所以有如下观察：</p>
<ul>
<li>连续的非零子段中，<span class="arithmatex">\(z_i\)</span> 的取值必然在 <span class="arithmatex">\(\pm 1\)</span> 之间相互交错的；</li>
<li>极大的连续非零子段左右两侧的 <span class="arithmatex">\(0\)</span>，必然表示在两个方案中都没有种树。</li>
</ul>
<p>因此，如果某个极大的连续非零子段中，<span class="arithmatex">\(z_i\)</span> 的和恰好为 <span class="arithmatex">\(+1\)</span>，也就是说，在该段坑位中，方案 <span class="arithmatex">\(x^{(m+1)}\)</span> 比方案 <span class="arithmatex">\(x^{(m-1)}\)</span> 多种了一棵树，那么就可以在该段内交换两个方案的种树位置。这样，就得到了两个各种 <span class="arithmatex">\(m\)</span> 棵树的可行方案。因为没有改变两个方案中总的种树的位置和数量，只是将它们重新分配，所以总的收益不变，仍然是 <span class="arithmatex">\(v(m-1)+v(m+1)\)</span>。但是，这两个种 <span class="arithmatex">\(m\)</span> 棵树的方案未必是最优的，因此，它们各自的收益不会超过 <span class="arithmatex">\(v(m)\)</span>。这就证明了</p>
<div class="arithmatex">\[
v(m-1) + v(m+1) \le 2v(m),
\]</div>
<p>也就是说，<span class="arithmatex">\(v(m)\)</span> 是关于 <span class="arithmatex">\(m\)</span> 的凹函数。</p>
<p>现在，只剩下一个问题，就是和恰好为 <span class="arithmatex">\(+1\)</span> 的极大连续非零子段是否存在。因为是若干个交错的 <span class="arithmatex">\(\pm 1\)</span> 相加，一个连续非零子段的和只能是 <span class="arithmatex">\(0\)</span> 或 <span class="arithmatex">\(\pm 1\)</span>。又因为所有这些极大连续非零子段的和等于 <span class="arithmatex">\(2\)</span>，所以，一定存在至少两个和恰好为 <span class="arithmatex">\(+1\)</span> 的极大连续非零子段。这就完成了证明。</p>
</details>
<h2 id="_13">例题<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<p>本节介绍几个不同场景下应用 WQS 二分方法的例题。</p>
<h3 id="_14">模板题目<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<details class="example" open="open">
<summary><a href="https://www.luogu.com.cn/problem/P1484">Luogu P1484 种树</a></summary>
<p>有 <span class="arithmatex">\(n\)</span> 个树坑，<strong>至多</strong> 种 <span class="arithmatex">\(m\)</span> 棵树。树不能栽种于相邻的两个坑。给定长度为 <span class="arithmatex">\(n\)</span> 的序列 <span class="arithmatex">\(\{a_i\}\)</span>，表示在每个坑种树的收益，收益可正可负。求种完这 <span class="arithmatex">\(m\)</span> 棵树最大可能的收益和。</p>
</details>
<details class="note">
<summary>解答</summary>
<p>与前文讨论的种树问题稍有不同，本题要求至多种 <span class="arithmatex">\(m\)</span> 棵树，而非恰好种 <span class="arithmatex">\(m\)</span> 棵树。仍然用 <span class="arithmatex">\(v(m)\)</span> 表示前文讨论的种树问题的价值函数，本题的答案实际上是 <span class="arithmatex">\(\tilde v(m)=\max_{k\le m}v(k)\)</span>。因为 <span class="arithmatex">\(v(m)\)</span> 是凹函数，也就是一个单峰函数，本题的答案相当于只保留 <span class="arithmatex">\(v(m)\)</span> 上升至峰顶的部分，然后函数会一直留在峰顶；这相当于仅仅保留切线斜率非负的部分。因此，本题与前文讨论的题目的唯一差别，就是 WQS 二分时，初始的斜率范围为 <span class="arithmatex">\([0,\max_ia_i]\)</span> 而非 <span class="arithmatex">\([\min_ia_i,\max_ia_i]\)</span>。</p>
<p>应用 WQS 二分的方法移除数量限制后，问题转化为计算链上最大权独立集，只是将原本的收益 <span class="arithmatex">\(\{a_i\}\)</span> 替换为了 <span class="arithmatex">\(\{a_i+k\}\)</span>。这是经典的动态规划题目。可以设 <span class="arithmatex">\(f(i,j)\)</span> 为第 <span class="arithmatex">\(i\)</span> 个坑位选择种树（<span class="arithmatex">\(j=1\)</span>）或不种树（<span class="arithmatex">\(j=0\)</span>）时，前 <span class="arithmatex">\(i\)</span> 个树坑的子问题的最大收益。由此，可以写出状态转移方程为</p>
<div class="arithmatex">\[
\begin{aligned}
f(i,0) &amp;= \max\{f(i-1,0),f(i-1,1)\},\\
f(i,1) &amp;= f(i-1,0) + a_i + k.
\end{aligned}
\]</div>
<p>初始条件为 <span class="arithmatex">\(f(0,0)=0\)</span> 和 <span class="arithmatex">\(f(0,1)=-\infty\)</span>，最终答案为 <span class="arithmatex">\(\max\{f(n,0),f(n,1)\}\)</span>。单次计算复杂度为 <span class="arithmatex">\(O(n)\)</span>，整体时间复杂度为 <span class="arithmatex">\(O(n\log L)\)</span>，其中，<span class="arithmatex">\(L=\max_i|a_i|\)</span>。</p>
<p>参考实现如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">传统方法</label><label for="__tabbed_1_2">对偶方法</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
</details>
<details class="example" open="open">
<summary><a href="https://www.luogu.com.cn/problem/P2619">Luogu P2619 [国家集训队] Tree I</a></summary>
<p>给定一张带权无向连通图，每条边是黑色或白色。求恰有 <span class="arithmatex">\(m\)</span> 条白边的生成树的最小权。</p>
</details>
<details class="note">
<summary>解答</summary>
<p>首先，通过交换论证可以证明 <span class="arithmatex">\(v(m)\)</span> 是凸函数。不妨假设所有边的边权各不相同：那些存在两边边权相同的情形，可以通过微扰使之变为边权各不相同的情形；然后只要令微扰的幅度趋近于零，就可以证明函数的凸性在极限情形——也就是存在两边边权相同的情形——仍然成立。证明的关键在于如下引理：<sup id="fnref:edge-swap"><a class="footnote-ref" href="#fn:edge-swap">4</a></sup></p>
<details class="note" open="open">
<summary>引理</summary>
<p>设 <span class="arithmatex">\(S\)</span> 和 <span class="arithmatex">\(T\)</span> 是无向连通图 <span class="arithmatex">\(G=(V,E)\)</span> 的两个生成树。对于任意 <span class="arithmatex">\(e\in S\setminus T\)</span>，都存在至少一条边 <span class="arithmatex">\(f\in T\setminus S\)</span>，使得 <span class="arithmatex">\(S-e+f\)</span> 和 <span class="arithmatex">\(T-f+e\)</span> 都是图 <span class="arithmatex">\(G\)</span> 的生成树。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>设 <span class="arithmatex">\(e=(u,v)\)</span>，且 <span class="arithmatex">\(P\)</span> 是树 <span class="arithmatex">\(T\)</span> 中连接 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span> 的唯一一条路径。因为 <span class="arithmatex">\(P+e\)</span> 是图 <span class="arithmatex">\(T+e\)</span> 中唯一的环路，所以删掉 <span class="arithmatex">\(P\)</span> 中的任何一条边 <span class="arithmatex">\(f\)</span> 都可以使得 <span class="arithmatex">\(T-f+e\)</span> 是一棵生成树。与此同时，图 <span class="arithmatex">\(S-e\)</span> 是有两个连通分量的森林，它们的顶点集分别记作 <span class="arithmatex">\(V_1\)</span> 和 <span class="arithmatex">\(V_2\)</span>，所以，只要选择边 <span class="arithmatex">\(f\in P\)</span> 使得 <span class="arithmatex">\(f\)</span> 连通了 <span class="arithmatex">\(V_1\)</span> 和 <span class="arithmatex">\(V_2\)</span>，就能保证 <span class="arithmatex">\(S-e+f\)</span> 是一棵生成树。这样的边 <span class="arithmatex">\(f\)</span> 总是存在的，因为 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span> 分别属于 <span class="arithmatex">\(V_1\)</span> 和 <span class="arithmatex">\(V_2\)</span>，而 <span class="arithmatex">\(P\)</span> 连接了 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(v\)</span>。而且，<span class="arithmatex">\(f\notin S\)</span>，因为图 <span class="arithmatex">\(S-e\)</span> 中，<span class="arithmatex">\(V_1\)</span> 和 <span class="arithmatex">\(V_2\)</span> 并不是连通的。这就完成了证明。</p>
</details>
<p>设 <span class="arithmatex">\(T_{m-1}\)</span> 和 <span class="arithmatex">\(T_{m+1}\)</span> 是白边数量分别为 <span class="arithmatex">\(m-1\)</span> 和 <span class="arithmatex">\(m+1\)</span> 的最小生成树。设 <span class="arithmatex">\(e\)</span> 是 <span class="arithmatex">\(T_{m+1}\setminus T_{m-1}\)</span> 的一条白边，对它应用上述引理可知，存在边 <span class="arithmatex">\(f\in T_{m-1}\setminus T_{m+1}\)</span>，使得 <span class="arithmatex">\(T'=T_{m+1}-e+f\)</span> 和 <span class="arithmatex">\(T''=T_{m-1}+e-f\)</span> 都是生成树。因为只是交换了一对边，所以，树 <span class="arithmatex">\(T'\)</span> 和树 <span class="arithmatex">\(T''\)</span> 的边权和仍然是 <span class="arithmatex">\(v(m-1)+v(m+1)\)</span>。进而，分两种情形讨论：</p>
<ul>
<li>如果 <span class="arithmatex">\(f\)</span> 是一条黑边，那么，<span class="arithmatex">\(T'\)</span> 和 <span class="arithmatex">\(T''\)</span> 中的白边数量都是 <span class="arithmatex">\(m\)</span>。它们各自的边权和都不会小于 <span class="arithmatex">\(v(m)\)</span>。这就证明了 <span class="arithmatex">\(2v(m)\le v(m-1)+v(m+1)\)</span>，故而 <span class="arithmatex">\(v(m)\)</span> 关于 <span class="arithmatex">\(m\)</span> 是凸的。</li>
<li>如果 <span class="arithmatex">\(f\)</span> 是一条白边，那么，<span class="arithmatex">\(T'\)</span> 和 <span class="arithmatex">\(T''\)</span> 的白边数量分别是 <span class="arithmatex">\(m+1\)</span> 和 <span class="arithmatex">\(m-1\)</span>，所以它们的边权和分别不小于 <span class="arithmatex">\(v(m+1)\)</span> 和 <span class="arithmatex">\(v(m-1)\)</span>。但是，上面已经说明，它们的边权和加在一起就等于 <span class="arithmatex">\(v(m-1)+v(m+1)\)</span>。这说明，<span class="arithmatex">\(T'\)</span> 的边权和就等于 <span class="arithmatex">\(v(m+1)\)</span>。将 <span class="arithmatex">\(T'\)</span> 与 <span class="arithmatex">\(T_{m+1}\)</span> 比较可知，<span class="arithmatex">\(e\)</span> 和 <span class="arithmatex">\(f\)</span> 的边权必然相等。这与假设矛盾，所以该情形并不成立。</li>
</ul>
<p>这就证明了 <span class="arithmatex">\(v(m)\)</span> 是 <span class="arithmatex">\(m\)</span> 的凸函数。</p>
<p>建立了函数 <span class="arithmatex">\(v(m)\)</span> 的凸性后，就可以用 WQS 二分解决该问题。移除数量限制并将每条白边的权重都减去 <span class="arithmatex">\(k\)</span>，并求解最小生成树问题。为此，可以应用 <a href="../../../graph/mst/#kruskal-算法">Kruskal 算法</a>。利用并查集维护连通性，算法的复杂度就是 <span class="arithmatex">\(O(E\log E+E\alpha(V))\)</span>，其中，<span class="arithmatex">\(E\)</span> 和 <span class="arithmatex">\(V\)</span> 分别为边数和顶点数，<span class="arithmatex">\(\alpha(\cdot)\)</span> 为反 Ackerman 函数。复杂度的主要部分 <span class="arithmatex">\(O(E\log E)\)</span> 是给边排序的复杂度，在本题中可以进一步优化。虽然在 WQS 二分的过程中需要多次计算最小生成树，但是每次只有白边的边权会整体加减一个数。所以，可以在预处理时给白边、黑边分别排序，然后每次计算最小生成树时，只需要将调整完权重后的白边和黑边归并到一起就可以了。这样，整体复杂度就降低到了 <span class="arithmatex">\(O(E\log E+E\alpha(V)\log L)\)</span>，其中，<span class="arithmatex">\(L\)</span> 为边权的取值范围的长度。</p>
<p>参考实现如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">传统方法</label><label for="__tabbed_2_2">对偶方法</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
</details>
<h3 id="_15">区间分拆问题<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<details class="example" open="open">
<summary><a href="https://www.luogu.com.cn/problem/P6246">Luogu P6246 [IOI 2000] 邮局 加强版 加强版</a></summary>
<p>给定长度为 <span class="arithmatex">\(n\)</span> 且递增的正整数序列 <span class="arithmatex">\(\{a_i\}\)</span> 表示一条高速公路旁的 <span class="arithmatex">\(n\)</span> 个村庄的位置，需要修建 <span class="arithmatex">\(m\)</span> 个邮局。邮局位置的选择，需要最小化所有村庄与其最近邮局的距离之和。求这个最小值。</p>
</details>
<details class="note">
<summary>解答</summary>
<p>这是典型的 <a href="../quadrangle/#区间分拆问题">区间分拆问题</a>。二分队列的实现细节请参考该页面。</p>
<p>每个邮局服务离它最近的村庄，那么，这些村庄必然是高速公路旁连续的若干个村庄。所以，修建 <span class="arithmatex">\(m\)</span> 个邮局，就相当于将所有村庄划分为连续的 <span class="arithmatex">\(m\)</span> 段，并为每一段村庄修建一个成本最低的邮局。众所周知，邮局应当修建在村庄位置的中位数的位置。由此，可以写出区间 <span class="arithmatex">\([l,r]\)</span> 的成本函数为</p>
<div class="arithmatex">\[
w(l,r) = \sum_{i=l}^r|a_i-a_{\lfloor(l+r)/2\rfloor}|.
\]</div>
<p>它满足四边形不等式，因为它的二阶混合差分非正：</p>
<div class="arithmatex">\[
\Delta_l\Delta_r w(l,r)
= \Delta_l(a_{r+1} - a_{\lfloor(l+r+1)/2\rfloor})
= a_{\lfloor(l+r+1)/2\rfloor}-a_{\lfloor(l+r+2)/2\rfloor} \le 0.
\]</div>
<p>这说明，可以通过二分队列结合 WQS 二分的方法在 <span class="arithmatex">\(O(n\log n\log L)\)</span> 的复杂度内求解该问题。</p>
<p>参考实现如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">传统方法</label><label for="__tabbed_3_2">对偶方法</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
</details>
<h3 id="_16">二维的限制条件<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<details class="example" open="open">
<summary><a href="https://codeforces.com/problemset/problem/739/E">Codeforces 739 E. Gosha is hunting</a></summary>
<p>有 <span class="arithmatex">\(n\)</span> 只神奇宝贝，序列 <span class="arithmatex">\(\{p_i\}\)</span> 和 <span class="arithmatex">\(\{q_i\}\)</span> 分别表示用宝贝球和超级球抓到第 <span class="arithmatex">\(i\)</span> 只神奇宝贝的概率。可以向一个神奇宝贝扔一个宝贝球，或者扔一个超级球，或者两种球各扔一个，或者什么球都不扔。现有 <span class="arithmatex">\(m_1\)</span> 个宝贝球和 <span class="arithmatex">\(m_2\)</span> 个神奇球，需要合理分配，并同时扔出。求抓到的神奇宝贝的期望数量的最大值。单次抓捕成功与否，与其它抓捕的结果无关。</p>
<p>更一般地，可以抽象为如下问题：</p>
<p>给定长度为 <span class="arithmatex">\(n\)</span> 的三个正实数序列 <span class="arithmatex">\(\{A_i\},\{B_i\},\{C_i\}\)</span>，而且，对所有 <span class="arithmatex">\(i=1,\cdots,n\)</span> 都有 <span class="arithmatex">\(C_i\le A_i+B_i\)</span> 成立。求最优的下标集合 <span class="arithmatex">\(X\)</span> 和 <span class="arithmatex">\(Y\)</span> 满足 <span class="arithmatex">\(|X|=m_1\)</span> 和 <span class="arithmatex">\(|Y|=m_2\)</span> 且最大化</p>
<div class="arithmatex">\[
\sum_{i\in X\setminus Y}A_i + \sum_{i\in Y\setminus X}B_i + \sum_{i\in X\cap Y}C_i.
\]</div>
</details>
<details class="note">
<summary>解答</summary>
<p>原问题可以看作是这个更一般的问题在</p>
<div class="arithmatex">\[
A_i = p_i,~ B_i = q_i,~ C_i = p_i+q_i-p_iq_i
\]</div>
<p>时的特殊情形。因此，只需要讨论更一般的问题的解决方案就可以了。</p>
<p>用 <span class="arithmatex">\(v(m_1,m_2)\)</span> 表示该问题的价值函数，需要证明它是关于 <span class="arithmatex">\((m_1,m_2)\)</span> 的凹函数。考虑如下费用流模型：</p>
<ul>
<li>从源点 <span class="arithmatex">\(s\)</span> 出发，分别向结点 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 连一条边，容量分别为 <span class="arithmatex">\(m_1\)</span> 和 <span class="arithmatex">\(m_2\)</span>，费用均为 <span class="arithmatex">\(0\)</span>；</li>
<li>对于所有 <span class="arithmatex">\(i=1,\cdots,n\)</span>，分别从结点 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 向结点 <span class="arithmatex">\(i\)</span> 连一条边，容量均为 <span class="arithmatex">\(1\)</span>，费用分别为 <span class="arithmatex">\(A_i\)</span> 和 <span class="arithmatex">\(B_i\)</span>；</li>
<li>对于所有 <span class="arithmatex">\(i=1,\cdots,n\)</span>，从结点 <span class="arithmatex">\(i\)</span> 出发向汇点 <span class="arithmatex">\(t\)</span> 连两条边，容量均为 <span class="arithmatex">\(1\)</span>，费用分别为 <span class="arithmatex">\(0\)</span> 和 <span class="arithmatex">\(C_i-A_i-B_i\)</span>。</li>
</ul>
<p>问题的答案就是该费用流模型的最大费用最大流。条件 <span class="arithmatex">\(C_i-A_i-B_i\le 0\)</span> 保证了当流经结点 <span class="arithmatex">\(i\)</span> 的流量为 <span class="arithmatex">\(1\)</span> 时，会优先选择费用为 <span class="arithmatex">\(0\)</span> 的那条边流出。将这个费用流模型写成线性规划问题，那么，<span class="arithmatex">\(m_1\)</span> 和 <span class="arithmatex">\(m_2\)</span> 就会分别出现在表示边 <span class="arithmatex">\((s,x)\)</span> 和边 <span class="arithmatex">\((s,y)\)</span> 的流量限制的不等式中。因此，<span class="arithmatex">\(v(m_1,m_2)\)</span> 确实是 <span class="arithmatex">\((m_1,m_2)\)</span> 的凹函数。</p>
<p>为了应用 WQS 二分，需要考虑移除数量限制后的最优化问题。设 <span class="arithmatex">\(k_1\)</span> 和 <span class="arithmatex">\(k_2\)</span> 分别为将一个下标放入集合 <span class="arithmatex">\(X\)</span> 和 <span class="arithmatex">\(Y\)</span> 时获得的额外奖励。没有数量限制后，关于每个下标的决策都是独立的，因此，有</p>
<div class="arithmatex">\[
h(k_1,k_2) = \sum_{i=1}^n\max\{0,A_i+k_1,B_i+k_2,C_i+k_1+k_2\}.
\]</div>
<p>原问题的答案就由</p>
<div class="arithmatex">\[
v(m_1,m_2) = \min_{k_1,k_2} h(k_1,k_2) - k_1m_1 - k_2m_2
\]</div>
<p>给出。总的时间复杂度为 <span class="arithmatex">\(O(n\log^2L)\)</span>，其中，<span class="arithmatex">\(O(\log L)\)</span> 为对单个维度二分的次数。</p>
<p>抓捕神奇宝贝问题的参考实现如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>
</code></pre></div></td></tr></table></div>
</details>
<h3 id="_17">更广泛的限制条件<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<details class="example" open="open">
<summary><a href="https://codeforces.com/problemset/problem/1661/F">Codeforces 1661 F. Teleporters</a></summary>
<p>有 <span class="arithmatex">\(n\)</span> 条线段，它们的长度由序列 <span class="arithmatex">\(\{a_i\}\)</span> 给出。可以将它们任意切割为若干条整数长度的线段，目标是最小化所有线段长度平方的总和。求至少需要切割多少次，才能使这个平方和降到不超过 <span class="arithmatex">\(V\)</span>。</p>
</details>
<details class="note">
<summary>解答</summary>
<p>设将长度为 <span class="arithmatex">\(a\)</span> 的线段切割 <span class="arithmatex">\(m\)</span> 次能得到的最小平方和为 <span class="arithmatex">\(f(a,m)\)</span>。由于均值不等式，当两数之和一定时，两数之差越小，两数的平方和也越小。所以，切割之后得到的线段长度越均匀，总的长度平方和也就越小。但是由于整数约束的存在，最均匀的情形就是得到了 <span class="arithmatex">\(a\bmod (m+1)\)</span> 条长度为 <span class="arithmatex">\(\lceil a/(m+1)\rceil\)</span> 的线段和 <span class="arithmatex">\(m+1-(a\bmod (m+1))\)</span> 条长度为 <span class="arithmatex">\(\lfloor a/(m+1)\rfloor\)</span> 的线段。因此，有如下表达式：</p>
<div class="arithmatex">\[
\begin{aligned}
f(a,m) &amp;= (a\bmod (m+1))\left\lceil\dfrac{a}{m+1}\right\rceil^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2 \\
&amp;= (a\bmod (m+1))\left(\left\lfloor\dfrac{a}{m+1}\right\rfloor+1\right)^2 + (m+1-(a\bmod (m+1)))\left\lfloor\dfrac{a}{m+1}\right\rfloor^2.
\end{aligned}
\]</div>
<p>第二步的等号成立，是因为 <span class="arithmatex">\(\lceil a/(m+1)\rceil \neq \lfloor a/(m+1)\rfloor + 1\)</span> 当且仅当 <span class="arithmatex">\(a\bmod (m+1) = 0\)</span>。</p>
<p>可以证明，函数 <span class="arithmatex">\(f(a,m)\)</span> 是关于 <span class="arithmatex">\(m\)</span> 的凸函数。为此，需要将它延拓到 <span class="arithmatex">\(m\in\mathbf R_{+}\)</span> 的情形。当 <span class="arithmatex">\(\lfloor a/(m+1)\rfloor = q\)</span> 时，有</p>
<div class="arithmatex">\[
\begin{aligned}
f(a,m) &amp;= (a-(m+1)q)(q+1)^2 + ((m+1)(q+1)-a)q^2 \\
&amp;= a(2q+1) - q(q+1)(m+1).
\end{aligned}
\]</div>
<p>这是斜率为 <span class="arithmatex">\(-q(q+1)\)</span> 的直线。因此，<span class="arithmatex">\(f(a,m)\)</span> 是分段线性函数，且斜率随着 <span class="arithmatex">\(m\)</span> 的增加而增加。这就说明了 <span class="arithmatex">\(f(a,m)\)</span> 是凸函数，它限制在整点上当然也是凸函数<sup id="fnref:conv-int"><a class="footnote-ref" href="#fn:conv-int">5</a></sup>。</p>
<p>利用 <span class="arithmatex">\(f(\cdot,\cdot)\)</span>，可以将所有线段总共切割 <span class="arithmatex">\(m\)</span> 次得到的最小平方和写作如下最优化问题的价值函数：</p>
<div class="arithmatex">\[
v(m) = \min_{\{m_i\}}\sum_i f(a_i,m_i)\text{ subject to }\sum_i m_i=m,~m_i\in\mathbf N.
\]</div>
<p>这是若干个凸函数的 <a href="../slope-trick/#卷积下确界minkowski-和">卷积下确界</a>，所以也是凸函数。如果题目要求的是 <span class="arithmatex">\(v(m)\)</span>，那么，可以使用与之前的例题一致的方法求解，时间复杂度为 <span class="arithmatex">\(O(n\log^2L)\)</span>；但是，本题求的是满足 <span class="arithmatex">\(v(m)\le V\)</span> 的最小的 <span class="arithmatex">\(m\)</span>。利用 WQS 二分计算 <span class="arithmatex">\(v(m)\)</span> 再对 <span class="arithmatex">\(m\)</span> 二分的方法是行不通的，它的复杂度达到了 <span class="arithmatex">\(O(n\log^3L)\)</span>。就本题而言，有如下两种处理方法。</p>
<p><strong>方法一</strong>：仍然二分斜率 <span class="arithmatex">\(k\)</span>，但是二分的依据是对 <span class="arithmatex">\(v(m)\)</span> 上下界的估计。</p>
<p>传统的 WQS 二分的方法中，对于给定的斜率 <span class="arithmatex">\(k\)</span>，可以计算出相应的最优的 <span class="arithmatex">\(m\)</span> 的取值范围。因为这些 <span class="arithmatex">\((m,v(m))\)</span> 共线，所以这相当于确定了 <span class="arithmatex">\(v(m)\)</span> 的取值范围。因此，可以直接二分斜率 <span class="arithmatex">\(k\)</span>。得到斜率 <span class="arithmatex">\(k\)</span> 之后，可以利用直线方程</p>
<div class="arithmatex">\[
v(m) = h(k) + km
\]</div>
<p>计算出最小的 <span class="arithmatex">\(m\)</span>。整体复杂度为 <span class="arithmatex">\(O(n\log^2L)\)</span>。</p>
<p>为了确定 <span class="arithmatex">\(v(m)\)</span> 的取值范围，需要确定 <span class="arithmatex">\(m\)</span> 的取值范围。一种做法是，在计算 <span class="arithmatex">\(h(k)\)</span> 时记录相应的最大最优解，利用它可以计算相应的 <span class="arithmatex">\(v(m)\)</span> 的下界；另一种做法是，利用 <span class="arithmatex">\(h(k)-h(k-1)\)</span> 得到相应的 <span class="arithmatex">\(m\)</span> 的上界，进而得到相应的 <span class="arithmatex">\(v(m)\)</span> 的下界。参考实现中，采用的是第二种做法，它不依赖于问题的具体结构，无需特别处理。</p>
<p><strong>方法二</strong>：改写最优化问题，使得对偶问题的价值函数就是本问题的解。</p>
<p>本问题可以直接看作是如下最优化问题：</p>
<div class="arithmatex">\[
m(v) = \min_{\{m_i\}} \sum_i m_i \text{ subject to }\sum_i f(a_i,m_i) \le V.
\]</div>
<p>本文的分析仍然适用于这一问题。故而，可以利用它的对偶问题求解所要求的 <span class="arithmatex">\(m(v)\)</span>：</p>
<div class="arithmatex">\[
m(v) = \max_{k} \sum_i\min_{m_i}(m_i - \lambda f(a_i,m_i)) + \lambda V.
\]</div>
<p>整体算法复杂度仍然是 <span class="arithmatex">\(O(n\log^2L)\)</span> 的。</p>
<p>参考代码如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">方法一</label><label for="__tabbed_4_2">方法二</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>代码仅做示意，为通过原题数据范围，需要 128 位整数，并调整二分初始区间为 <span class="arithmatex">\([0,10^{60}]\)</span>。</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<p>代码仅做示意，由于浮点数精度问题无法通过原题数据范围。</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
</details>
<h2 id="_18">习题<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<p>最后，列举一些可以通过 WQS 二分解决的题目，以供练习：</p>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P1484">Luogu P1484 种树</a></li>
<li><a href="https://www.luogu.com.cn/problem/P1792">Luogu P1792 [国家集训队] 种树</a></li>
<li><a href="https://www.luogu.com.cn/problem/P2619">Luogu P2619 [国家集训队] Tree I</a></li>
<li><a href="https://www.luogu.com.cn/problem/P3620">Luogu P3620 [APIO/CTSC2007] 数据备份</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4072">Luogu P4072 [SDOI2016] 征途</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4383">Luogu P4383 [八省联考 2018] 林克卡特树</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4983">Luogu P4983 忘情</a></li>
<li><a href="https://www.luogu.com.cn/problem/P5308">Luogu P5308 [COCI 2018/2019 #4] Akvizna</a></li>
<li><a href="https://www.luogu.com.cn/problem/P5633">Luogu P5633 最小度限制生成树</a></li>
<li><a href="https://www.luogu.com.cn/problem/P5896">Luogu P5896 [IOI 2016] aliens</a></li>
<li><a href="https://www.luogu.com.cn/problem/P6246">Luogu P6246 [IOI 2000] 邮局 加强版 加强版</a></li>
<li><a href="https://atcoder.jp/contests/abc218/tasks/abc218_h">AtCoder Beginner Contest 218 H - Red and Blue Lamps</a></li>
<li><a href="https://atcoder.jp/contests/abc305/tasks/abc305_h">AtCoder Beginner Contest 305 Ex - Shojin</a></li>
<li><a href="https://atcoder.jp/contests/arc164/tasks/arc164_e">AtCoder Regular Contest 164 E - Segment-Tree Optimization</a></li>
<li><a href="https://codeforces.com/problemset/problem/125/E">Codeforces 125 E. MST Company</a></li>
<li><a href="https://codeforces.com/problemset/problem/321/E">Codeforces 321 E. Ciel and Gondolas</a></li>
<li><a href="https://codeforces.com/problemset/problem/739/E">Codeforces 739 E. Gosha is hunting</a></li>
<li><a href="https://codeforces.com/contest/802/problem/O">Codeforces 802 O. April Fools' Problem (hard)</a></li>
<li><a href="https://codeforces.com/problemset/problem/958/E2">Codeforces 958 E2. Guard Duty (medium)</a></li>
<li><a href="https://codeforces.com/problemset/problem/1279/F">Codeforces 1279 F. New Year and Handle Change</a></li>
<li><a href="https://codeforces.com/problemset/problem/1661/F">Codeforces 1661 F. Teleporters</a></li>
<li><a href="https://codeforces.com/problemset/problem/1799/F">Codeforces 1799 F. Halve or Subtract</a></li>
<li><a href="https://codeforces.com/gym/102331/problem/H">2019 Summer Petrozavodsk Camp H. Honorable Mention</a></li>
</ul>
<h2 id="_19">参考资料与注释<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.doc88.com/p-949564862405.html">王钦石《浅析一类二分方法》</a></li>
<li><a href="https://codeforces.com/blog/entry/98334">Theoretical grounds of lambda optimization by adamant - Codeforces blog</a></li>
<li><a href="https://www.luogu.com.cn/article/vsffwrc3">严谨的 WQS 二分方法 by YeahPotato - 洛谷博客</a></li>
<li><a href="https://blog.csdn.net/Emm_Titan/article/details/124035796">【学习笔记】WQS 二分详解及常见理解误区解释 by ikrvxt - CSDN 博客</a></li>
<li><a href="https://en.wikipedia.org/wiki/Convex_conjugate">Convex conjugate - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Fenchel%E2%80%93Moreau_theorem">Fenchel–Moreau theorem - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Subderivative">Subderivative - Wikipedia</a></li>
<li><a href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf">Boyd, Stephen P., and Lieven Vandenberghe. Convex optimization. Cambridge university press, 2004.</a></li>
<li>Papadimitriou, Christos H., and Kenneth Steiglitz. Combinatorial optimization: algorithms and complexity. Courier Corporation, 1998.</li>
<li>Conforti, Michele, Gérard Cornuéjols, and Giacomo Zambelli. Integer programming. Springer International Publishing, 2014.</li>
<li>Schrijver, Alexander. Combinatorial optimization: polyhedra and efficiency. Vol. 24, no. 2. Berlin: Springer, 2003.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:high-d-convex">
<p>实际问题中，<span class="arithmatex">\(y\)</span> 可能只能取到 <span class="arithmatex">\(\mathbf R^d\)</span> 中的有限多个格点。此处实际需要的条件是，原问题的解 <span class="arithmatex">\(v(y)\)</span> 可以延拓为 <span class="arithmatex">\(\mathbf R^d\)</span> 上的凸函数 <span class="arithmatex">\(\tilde v:\mathbf R^d\rightarrow \mathbf R\cup\{\pm\infty\}\)</span>，也就是说 <span class="arithmatex">\(v(y)\)</span> 是 <strong>可凸延拓的</strong>（convex-extensible）。为行文方便，正文中仍然用 <span class="arithmatex">\(v(y)\)</span> 表示延拓后的函数。几何直观上，这相当于说点集 <span class="arithmatex">\(\{(y,v(y))\}\)</span> 全部都位于它们的凸包的下凸壳上。对于一维的情形，这一条件利用代数语言 <a href="../slope-trick/#离散点集上的凸函数">很容易刻画</a>；但是，对于高维的情形，这稍微有些复杂，<a href="https://kzmurota.fpark.tmu.ac.jp/paper/HIMSummerSchool15Murota.pdf">这份讲义</a> 中提供了一些简单的充分条件。&#160;<a class="footnote-backref" href="#fnref:high-d-convex" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:other-conditions">
<p>定理中提供的条件看似比凸函数更强一些，但是，对于算法竞赛能够遇到的情形，特别是 <span class="arithmatex">\(X\)</span> 为有限集合时，仅强调凸函数就已经足够。由离散集合上的正常凸函数 <span class="arithmatex">\(v\)</span> 延拓而来的函数 <span class="arithmatex">\(\tilde v\)</span> 必然是下半连续的凸函数，因为有限多个点的凸包必然是闭凸包，而所谓下半连续的凸函数，就等价于它的上境图是闭凸包。至于正常凸函数中的「正常」一词，只要 <span class="arithmatex">\(v(y)\)</span> 在至少一个点处取得有限值且是凸函数，就可以保证。&#160;<a class="footnote-backref" href="#fnref:other-conditions" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:mst">
<p>最小生成树问题有两种常见的写成线性规划问题的 <a href="https://math.arizona.edu/~glickenstein/math443f14/golari.pdf">方法</a>：子回路消除模型（subtour-elimination formulation）和基于割集的模型（cut-based formulation）。只有前一种建模方式能够保证得到的线性规划问题和原问题是等价的。&#160;<a class="footnote-backref" href="#fnref:mst" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:edge-swap">
<p>这一引理对于一般的 <a href="../../../math/matroid/">拟阵</a> 也是成立的。它称为 <strong>对称基交换性质</strong>（symmetric base-exchange property），相关资料可以参考 <a href="https://en.wikipedia.org/wiki/Basis_of_a_matroid">Wikipedia 页面</a>。因此，本题关于凸性的结论可以推广到一般的拟阵上。&#160;<a class="footnote-backref" href="#fnref:edge-swap" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:conv-int">
<p>当然，<span class="arithmatex">\(f(a,m)\)</span> 和它限制在整点上得到的函数的凸包并不相同，因为 <span class="arithmatex">\(f(a,m)\)</span> 可能存在非整数位置处的极点。这说明，并不能将定义域为实数的 <span class="arithmatex">\(f(a,m)\)</span> 直接用于本题的最优化问题中。&#160;<a class="footnote-backref" href="#fnref:conv-int" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->


<!-- Source file information -->

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        此页面有帮助吗？
      </legend>
      <div class="md-feedback__inner">

        <!-- Feedback ratings -->
        <div class="md-feedback__list">
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page was helpful"
              data-md-value="1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page could be improved"
              data-md-value="0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>

        <!-- Feedback rating notes (shown after submission) -->
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              谢谢你的反馈！
            </div>
          
            <div data-md-value="0" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              Thanks for your feedback! Help us improve this page by using our <a href="https://marketingplatform.google.com/about/analytics/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Comment system -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <style>
  .md-footer {
      background-color: #f0f0f0;
  }
</style>


<!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; gzh
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
   
      <font color="#B9B9B9">
      <div class="footer-visit-count" style="display: flex; justify-content: center; align-items: center;color: #000;">
        本站访问量：<script async src="//finicounter.eu.org/finicounter.js"></script>
        <span id="finicount_views"></span>    &nbsp;|&nbsp;
        <footer>
          <a href="https://icp.gov.moe/?keyword=20230640" target="_blank">萌ICP备20230640号</a>
        </footer>
      </div>
      </font>

        <style>
          .footer-visit-count {
              height: fit-content;
              min-height: 55px; /* 根据实际情况调整此高度 */
              color: #000;
          }
          </style>
        
          <div class="md-social">
  
    
    
    
    
    <a href="https://cdn.jsdelivr.net/gh/Gongzihang6/Pictures@main/Medias/%E6%88%91%E7%9A%84%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81.png" target="_blank" rel="noopener" title="Wechat" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
    
    
    
    
    <a href="https://t.me/gongzihang" target="_blank" rel="noopener" title="telegram" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ZihangGong28792" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Gongzihang6" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<zihanggong24@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/688234000/lists" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
</div>
        
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>我们也使用cookies来识别您的重复访问和偏好来衡量我们文档的有效性以及用户是否找到他们要找的东西。 如果你同意,你可以帮助我们让我们的网站更好</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">同意</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">管理设定</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../../..", "features": ["announce.dismiss", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../../../../javascripts/extra.js"></script>
      
        <script src="../../../../../../../javascripts/config_mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../../../../javascripts/简历.js"></script>
      
    
  </body>
</html>