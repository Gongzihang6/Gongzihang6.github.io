
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录、分享">
      
      
        <meta name="author" content="gzh">
      
      
        <link rel="canonical" href="https://gongzihang6.github.io/blog/Computer%20Science/Algorithm/docs/math/number-theory/pell-equation/">
      
      
      
      
      <link rel="icon" href="https://s2.loli.net/2025/02/12/aE5ovtzAlNTd9Uh.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Pell equation - Blog of GZH</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/简历.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="../../../../../../../stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&display=swap">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
    <script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-40HC6RYSR1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-40HC6RYSR1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-40HC6RYSR1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../../../.." title="Blog of GZH" class="md-header__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Blog of GZH
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pell equation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭自动模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭自动模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 128c0-35.3 28.7-64 64-64h512c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64zm320 0v256h256V128zm-141.7 47.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4zM160 233.2l19 42.8h-38zM448 164c11 0 20 9 20 20v4h60c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5 0-28.3s20.5-7.8 28.3 0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45l-35.2.1h-72c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/ZH-TW/" hreflang="zh-TW" class="md-select__link">
              China(TW)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../.." class="md-tabs__link">
        
  
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../java%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
  
    
  
  Computer Science

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-tabs__link">
          
  
  
    
  
  MachineLearning

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-tabs__link">
          
  
  
    
  
  每日诗词

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E6%9C%8B%E5%8F%8B%E5%9C%88/" class="md-tabs__link">
          
  
  
    
  
  朋友圈

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../%E9%95%BF%E6%9C%9F%E4%B8%BB%E4%B9%89/fitness/" class="md-tabs__link">
          
  
  
    
  
  长期主义

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../../about/geren/" class="md-tabs__link">
          
  
  
    
  
  关于

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../.." title="Blog of GZH" class="md-nav__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    Blog of GZH
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    主页
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computer Science
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Java
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java面向对象基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../%E5%B8%B8%E7%94%A8API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java集合框架与常用API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../java%E6%8F%90%E9%AB%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java高级技术
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Algorithm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/%E5%B9%B6%E6%9F%A5%E9%9B%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并查集
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LeetCode热题100
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            LeetCode热题100
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode%E7%83%AD%E9%A2%98100/%E5%AD%97%E6%AF%8D%E5%BC%82%E4%BD%8D%E8%AF%8D%E5%88%86%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    字母异位词分组
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LeetCode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            LeetCode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%BA%A4%E6%98%93%E9%80%86%E5%BA%8F%E5%AF%B9%E7%9A%84%E6%80%BB%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    交易逆序对的总数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%8D%95%E8%AF%8D%E6%8E%A5%E9%BE%99/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    单词接龙
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%B2%9B%E5%B1%BF%E6%95%B0%E9%87%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    岛屿数量
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%88%86%E8%80%83%E5%9C%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分考场
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8B%89%E9%A9%AC%E8%BD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    拉马车
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%88%86%E5%B7%A7%E5%85%8B%E5%8A%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    分巧克力
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/k%E5%80%8D%E5%8C%BA%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K倍区间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    编辑距离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8E%A5%E9%9B%A8%E6%B0%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    接雨水
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BB%84%E5%90%88%E6%80%BB%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    组合总和
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%85%A8%E6%8E%92%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    全排列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    乘积最大子数组
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. 最长回文子串
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%89%8DK%E4%B8%AA%E9%AB%98%E9%A2%91%E5%85%83%E7%B4%A0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    前K个高频元素
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%9C%80%E5%B0%8F%E6%A0%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    最小栈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/Pow%28x%2Cn%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pow(x,n)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F%E6%97%B6%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    网络延迟时间
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E8%AE%A1%E7%AE%97%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    计算质数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E5%AF%B9%E8%A7%92%E7%BA%BF%E4%B8%8A%E7%9A%84%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    对角线上的质数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    零钱兑换
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/01%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    二分查找
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/%E6%8B%AC%E5%8F%B7%E5%8C%B9%E9%85%8D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    括号匹配
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/300%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    300最长递增子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/115%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    115不同的子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/712%E4%B8%A4%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%8FASCII%E5%88%A0%E9%99%A4%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    712两个字符串的最小ASCII删除和
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/516%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    516最长回文子序列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/139%E5%8D%95%E8%AF%8D%E6%8B%86%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    139单词拆分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/221%E6%9C%80%E5%A4%A7%E6%AD%A3%E6%96%B9%E5%BD%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    221最大正方形
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2845%E7%BB%9F%E8%AE%A1%E8%B6%A3%E5%91%B3%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2845统计趣味子数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2799%E7%BB%9F%E8%AE%A1%E5%AE%8C%E5%85%A8%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2799统计完全子数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/1399%E7%BB%9F%E8%AE%A1%E6%9C%80%E5%A4%A7%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1399统计最大组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2338%E7%BB%9F%E8%AE%A1%E7%90%86%E6%83%B3%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2338统计理想数组的数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2179%E7%BB%9F%E8%AE%A1%E6%95%B0%E7%BB%84%E4%B8%AD%E5%A5%BD%E4%B8%89%E5%85%83%E7%BB%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2179统计数组中好三元组数目
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2537%E7%BB%9F%E8%AE%A1%E5%A5%BD%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2537统计好子数组的数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2140%E8%A7%A3%E5%86%B3%E6%99%BA%E5%8A%9B%E9%97%AE%E9%A2%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2140解决智力问题
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../LeetCode/2278%E5%AD%97%E6%AF%8D%E5%9C%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E7%99%BE%E5%88%86%E6%AF%94/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2278字母在字符串中的百分比
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MachineLearning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            MachineLearning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K近邻学习与降维
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E5%A4%9A%E5%88%86%E7%B1%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    模型评估与多分类
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E5%85%AC%E5%BC%8F%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    公式测试
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E7%BB%8F%E5%85%B8%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    经典卷积神经网络
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../MachineLearning/%E7%90%86%E8%A7%A3YOLO%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    理解YOLO网络结构
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    每日诗词
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            每日诗词
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    虞美人·玉阑干外清江浦
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%8F%A9%E8%90%A8%E8%9B%AE%C2%B7%E5%9B%9E%E6%96%87%E5%A4%8F%E9%97%BA%E6%80%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    菩萨蛮·回文夏闺怨
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B8%85%E5%B9%B3%E4%B9%90%C2%B7%E5%85%AD%E7%9B%98%E5%B1%B1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    清平乐·六盘山
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B4%9E%E4%BB%99%E6%AD%8C%C2%B7%E5%92%8F%E6%9F%B3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    洞仙歌·咏柳
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E7%A7%8B%E5%85%B4%E5%85%AB%E9%A6%96%C2%B7%E5%85%B6%E4%B8%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    秋兴八首·其一
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%8E%E5%8F%B2%E9%83%8E%E4%B8%AD%E9%92%A6%E5%90%AC%E9%BB%84%E9%B9%A4%E6%A5%BC%E4%B8%8A%E5%90%B9%E7%AC%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    与史郎中钦听黄鹤楼上吹笛
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%A4%8F%E6%97%A5%E5%8D%97%E4%BA%AD%E6%80%80%E8%BE%9B%E5%A4%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    夏日南亭怀辛大
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%A1%8C%E9%A6%99%E5%AD%90%C2%B7%E7%A7%8B%E4%B8%8E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    行香子·秋与
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%87%AA%E9%A2%98%E9%87%91%E5%B1%B1%E7%94%BB%E5%83%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    自题金山画像
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    朋友圈
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            朋友圈
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E6%9C%8B%E5%8F%8B%E5%9C%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    朋友圈
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    长期主义
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            长期主义
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../%E9%95%BF%E6%9C%9F%E4%B8%BB%E4%B9%89/fitness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitness
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            关于
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/geren/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    作者个人简介
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/%E7%AE%80%E5%8E%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    个人简历
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/zcw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    支持作者
    
  </span>
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../about/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    功能测试
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      引入
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      解的结构
    </span>
  </a>
  
    <nav class="md-nav" aria-label="解的结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pell" class="md-nav__link">
    <span class="md-ellipsis">
      Pell 方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pell_1" class="md-nav__link">
    <span class="md-ellipsis">
      广义 Pell 方程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      求解方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="求解方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pqa" class="md-nav__link">
    <span class="md-ellipsis">
      PQa 算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pell_2" class="md-nav__link">
    <span class="md-ellipsis">
      Pell 方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pell_3" class="md-nav__link">
    <span class="md-ellipsis">
      负 Pell 方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      范数为 ±4 的情形
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      一般情形
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      习题
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      参考文献与注释
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Pell equation</h1>

<div class="admonition info">
<p class="admonition-title">💾 AI智能摘要 (Gemini)</p>
<p>本文探讨广义Pell方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的求解，重点分析 <span class="arithmatex">\(N=1\)</span> 时的Pell方程。文章阐述了Pell方程解的结构与二次整数环的关系，并利用Brahmagupta恒等式推导解的复合性质。通过寻找基本解，可以生成Pell方程的全部解。文章还讨论了广义Pell方程解集与Pell方程基本解的关系，为理解和求解此类不定方程提供了理论基础和方法。</p>
</div>
<div class="admonition info">
<p class="admonition-title">📖 阅读信息</p>
<p>阅读时间：<strong>7</strong> 分钟 | 中文字符：<strong>2948</strong></p>
</div>
<p>前置知识：<a href="../continued-fraction/">连分数</a>、<a href="../quadratic/">二次域</a></p>
<h2 id="_1">引入<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本文讨论（广义）Pell 方程的求解。广义 Pell 方程是指关于 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 的不定方程</p>
<div class="arithmatex">\[
x^2-Dy^2=N,
\]</div>
<p>其中，<span class="arithmatex">\(D\)</span> 是正整数且不是完全平方数<sup id="fnref:not-square"><a class="footnote-ref" href="#fn:not-square">1</a></sup>，<span class="arithmatex">\(N\)</span> 是非零整数。狭义的 Pell 方程特指 <span class="arithmatex">\(N=1\)</span> 或 <span class="arithmatex">\(N=\pm 1\)</span> 的特殊情形，有时也包括 <span class="arithmatex">\(N=\pm 4\)</span> 的情形。广义 Pell 方程与在实二次整数环内寻找范数为 <span class="arithmatex">\(N\)</span> 的二次整数紧密相关，而常常称作（狭义）Pell 方程的这些情形可以看作是寻找实二次整数环内的单位数。</p>
<p>当本文提及 Pell 方程时，特指 <span class="arithmatex">\(N=1\)</span> 的情形。相应地，<span class="arithmatex">\(N=-1\)</span> 的情形称为负 Pell 方程<sup id="fnref:neg-pell"><a class="footnote-ref" href="#fn:neg-pell">2</a></sup>（negative Pell's equation）。</p>
<h2 id="_2">解的结构<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>广义 Pell 方程的整数解 <span class="arithmatex">\((x,y)\)</span> 和二次整数 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 联系密切，因此文献中 Pell 方程的解常常写作 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 的形式。因为二次整数的范数</p>
<div class="arithmatex">\[
N(x+y\sqrt{D}) = x^2-Dy^2,
\]</div>
<p>所以，广义 Pell 方程大致相当于在求解范数为 <span class="arithmatex">\(N\)</span> 的二次整数。但是，两者确实有细微的区别。当 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 都是整数时，<span class="arithmatex">\(x+y\sqrt{D}\)</span> 一定是二次整数；反过来，二次整数未必要求 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 都是整数——在 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 的情形，<span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 还可以同时是半整数<sup id="fnref:half-int"><a class="footnote-ref" href="#fn:half-int">3</a></sup>。</p>
<p>这个区别在求解基本单位数时格外重要。因为二次整环中的单位数是指范数为 <span class="arithmatex">\(\pm 1\)</span> 的二次整数。对于 <span class="arithmatex">\(D\equiv 2,3\pmod 4\)</span>，要找到这样的单位数，只需要求解广义 Pell 方程在 <span class="arithmatex">\(N=\pm 1\)</span> 的情形即可；但是对于 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>，还需要考虑 <span class="arithmatex">\(N=\pm 4\)</span> 的情形。<a href="#范数为-4-的情形">下文</a> 会讨论单位数的求解方法。</p>
<p>要理解广义 Pell 方程解的结构，需要从 <a href="https://en.wikipedia.org/wiki/Brahmagupta%27s_identity">Brahmagupta 恒等式</a> 入手：</p>
<div class="arithmatex">\[
(x_1^2-Dy_1^2)(x_2^2-Dy_2^2)=(x_1x_2+Dy_1y_2)^2-D(x_1y_2+x_2y_1)^2.
\]</div>
<p>它相当于二次整数的范数保持乘法，即</p>
<div class="arithmatex">\[
\begin{aligned}
N\left(x_1+y_1\sqrt{D}\right)N\left(x_2+y_2\sqrt{D}\right) &amp;= N\left((x_1+y_1\sqrt{D})(x_2+y_2\sqrt{D})\right) \\
&amp;= N\left((x_1x_2+Dy_1y_2)+(x_1y_2+x_2y_1)\sqrt{D}\right).
\end{aligned}
\]</div>
<p>利用这一恒等式，可以利用方程 <span class="arithmatex">\(x^2-Dy^2=N_1\)</span> 和方程 <span class="arithmatex">\(x^2-Dy^2=N_2\)</span> 的整数解复合出方程 <span class="arithmatex">\(x^2-Dy^2=N_1N_2\)</span> 的整数解。当然，从二次整数的角度看，解的复合就是二次整数的乘法，这就体现了将 Pell 方程的解记作二次整数形式的方便之处。特别地，取 <span class="arithmatex">\(N_1=N\)</span> 和 <span class="arithmatex">\(N_2=1\)</span> 就可以发现，如果已知 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的一组解和相应的 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的全体解，就可以得到 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 更多的解。当然，这种方法未必能够生成全部的解。但是，这至少说明理解 Pell 方程的解的结构对理解广义 Pell 方程的解的结构有重要作用。</p>
<h3 id="pell">Pell 方程<a class="headerlink" href="#pell" title="Permanent link">&para;</a></h3>
<p>方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的几何意义是实轴在 <span class="arithmatex">\(x\)</span> 轴、虚轴在 <span class="arithmatex">\(y\)</span> 轴的双曲线。双曲线上的每个点都唯一对应了 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 的一个非零取值：双曲线的左支对应着 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 的负值，右支则对应正值。而且，在每一支上，双曲线自下而上对应的 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 的取值是严格递增的。二次整数的取值给 Pell 方程的解赋予了自然的顺序。</p>
<p>双曲线同时关于 <span class="arithmatex">\(x\)</span> 轴和 <span class="arithmatex">\(y\)</span> 轴对称，因此讨论 Pell 方程的解只需要考虑在第一象限内的那一段即可，其余解可以通过对称性获得。这相当于只考虑 <span class="arithmatex">\(x+y\sqrt{D}&gt;1\)</span> 的解。如果方程除了 <span class="arithmatex">\((\pm 1,0)\)</span> 之外还存在不平凡的解，那么一定在第一象限内存在 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 取值最小的解 <span class="arithmatex">\((x_1,y_1)\)</span>，这也是第一象限内（不含坐标轴）横纵坐标都最小的整点，它称为 Pell 方程的基本解（fundamental solution）<sup id="fnref:fundamental-solution"><a class="footnote-ref" href="#fn:fundamental-solution">4</a></sup>。根据前文的讨论，满足 <span class="arithmatex">\(x_k+y_k\sqrt{D}=(x_1+y_1\sqrt{D})^k\)</span> 的整数对 <span class="arithmatex">\((x_k,y_k)\)</span> 都是 Pell 方程的解，而且都在第一象限。反过来，这也的确是 Pell 方程在第一象限内的全部解。再利用对称性，就可以得到如下结论：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解是 <span class="arithmatex">\((x_1,y_1)\)</span>。那么，它的全部解就是</p>
<div class="arithmatex">\[
\{(x,y):x+y\sqrt{D}=\pm(x_1+y_1\sqrt{D})^k,k\in\mathbf Z\}.
\]</div>
</details>
<details class="note">
<summary>证明</summary>
<p>首先证明第一象限中不存在其他解。不妨设存在其他解 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 且对于某个 <span class="arithmatex">\(k\ge 0\)</span> 有</p>
<div class="arithmatex">\[
x_k+y_k\sqrt{D}&lt; x+y\sqrt{D}&lt; x_{k+1}+y_{k+1}\sqrt{D}.
\]</div>
<p>几何意义上，这相当于说整点 <span class="arithmatex">\((x,y)\)</span> 落入了双曲线上 <span class="arithmatex">\((x_k,y_k)\)</span> 和 <span class="arithmatex">\((x_{k+1},y_{k+1})\)</span> 之间（不含端点）。将不等式同时乘以 <span class="arithmatex">\(x_k-y_k\sqrt{D}=(x_k+y_k\sqrt{D})^{-1}\)</span> 就得到</p>
<div class="arithmatex">\[
1&lt; (x+y\sqrt{D})(x_k-y_k\sqrt{D})=(xx_k-Dyy_k)+(x_ky-xy_k)\sqrt{D} &lt; x_1+y_1\sqrt{D}.
\]</div>
<p>根据前文提到的单调性，这个不等式就说明 <span class="arithmatex">\((xx_k-Dyy_k,x_ky-xy_k)\)</span> 是位于 <span class="arithmatex">\((1,0)\)</span> 和 <span class="arithmatex">\((x_1,y_1)\)</span> 之间的整点。这与 <span class="arithmatex">\((x_1,y_1)\)</span> 的选取矛盾。</p>
<p>将第一象限的解扩展到整个平面时，指数 <span class="arithmatex">\(k\)</span> 取相反数（即整体取倒数）就是关于 <span class="arithmatex">\(x\)</span> 轴对称，整体取相反数则是关于原点对称。再加上 <span class="arithmatex">\(k=0\)</span> 时的平凡解，就得到 Pell 方程的全部解。</p>
</details>
<p>前文的讨论只是假设了基本解的存在。现在要说明的是，Pell 方程总是存在非平凡的解。</p>
<details class="note" open="open">
<summary>定理</summary>
<p>Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 总是存在除了 <span class="arithmatex">\((\pm 1,0)\)</span> 之外的整数解。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>首先，<a href="../continued-fraction/#用渐近分数逼近实数">Dirichlet 定理</a> 表明存在无数对正整数 <span class="arithmatex">\((x,y)\)</span> 使得</p>
<div class="arithmatex">\[
\left|\dfrac{x}{y}-\sqrt{D}\right| \le \dfrac{1}{y^2}
\]</div>
<p>成立，它们都满足不等式</p>
<div class="arithmatex">\[
|x^2-Dy^2|=y^2\left|\dfrac{x}{y}-\sqrt{D}\right|\left|\dfrac{x}{y}+\sqrt{D}\right| \le \dfrac{1}{y^2}+2\sqrt{D}&lt;1+2\sqrt{D}.
\]</div>
<p>因而，必然存在整数 <span class="arithmatex">\(m\in(-1-2\sqrt{D},1+2\sqrt{D})\)</span> 使得有无数对 <span class="arithmatex">\((x,y)\)</span> 都满足 <span class="arithmatex">\(x^2-Dy^2 = m\)</span>。将这些 <span class="arithmatex">\((x,y)\)</span> 根据对 <span class="arithmatex">\(m\)</span> 的余数分类，就知道对某一对整数 <span class="arithmatex">\((x_0,y_0)\)</span>，一定存在无数对 <span class="arithmatex">\((x,y)\)</span> 使得 <span class="arithmatex">\(x\equiv x_0\pmod m\)</span> 以及 <span class="arithmatex">\(y\equiv y_0\pmod m\)</span> 成立。任取满足这些条件的两对互异的 <span class="arithmatex">\((x_1,y_1)\)</span> 和 <span class="arithmatex">\((x_2,y_2)\)</span>，则</p>
<div class="arithmatex">\[
\dfrac{x_1+y_1\sqrt{D}}{x_2+y_2\sqrt{D}}=\dfrac{x_1x_2-Dy_1y_2}{m}+\dfrac{x_2y_1-x_1y_2}{m}\sqrt{D}.
\]</div>
<p>因为根据同余关系有</p>
<div class="arithmatex">\[
\begin{aligned}
x_1x_2-Dy_1y_2 &amp;\equiv x_0^2-Dy_0^2 = m \equiv 0 \pmod{|m|},\\
x_2y_1-x_1y_2 &amp;\equiv x_0y_0-x_0y_0 = 0 \pmod{|m|},
\end{aligned}
\]</div>
<p>这说明上式右侧得到的是整数解。而且，因为 <span class="arithmatex">\((x_1,y_1)\neq(x_2,y_2)\)</span>，它并不平凡。这就说明 Pell 方程的确存在非平凡解。</p>
</details>
<p>当然，本节提供的是非构造性的证明，在下文讨论 Pell 方程的解法时，会直接利用连分数的渐近分数构造出 Pell 方程的解，因而提供了 Pell 方程存在非平凡解的另一种证明。另外，尽管本节得到的 Pell 方程解的结构与实二次整数环的单位数的结构是一致的，但是对于 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 的情形，本节并没有完全解决相应的二次整数环的单位数的结构问题，下文将进一步讨论。</p>
<h3 id="pell_1">广义 Pell 方程<a class="headerlink" href="#pell_1" title="Permanent link">&para;</a></h3>
<p>广义 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的图像同样是平面上的双曲线，同样以 <span class="arithmatex">\(x\)</span> 轴和 <span class="arithmatex">\(y\)</span> 轴为对称轴。前文已经指出，方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的部分解可能只相差一个 Pell 方程解的因子，这意味着可以将方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的解划分为等价类。对于方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的两个解 <span class="arithmatex">\((x_1,y_1)\)</span> 和 <span class="arithmatex">\((x_2,y_2)\)</span>，如果存在 Pell 方程的解 <span class="arithmatex">\((u,v)\)</span> 使得 <span class="arithmatex">\(x_2+y_2\sqrt{D}=(x_1+y_1\sqrt{D})(u+v\sqrt{D})\)</span> 成立，那么称解 <span class="arithmatex">\((x_1,y_1)\)</span> 和 <span class="arithmatex">\((x_2,y_2)\)</span> 等价。两个解等价的充分必要条件是</p>
<div class="arithmatex">\[
N\mid (x_1x_2-Dy_1y_2),\ N\mid (x_2y_1-x_1y_2).
\]</div>
<p>因为 Pell 方程的解相对容易求出，一个自然的想法是在上述的每个等价类中各求出一个解。只要知道这些解，就可以利用相应的 Pell 方程的解得到所要求的广义 Pell 方程的全部解。在广义 Pell 方程的解的等价类中，由于对称性，每个等价类都存在纵坐标 <span class="arithmatex">\(y\)</span> 非负但是尽可能小的解：如果这样的解唯一，它就称为该等价类的基本解；否则，该等价类必然有两个 <span class="arithmatex">\(y\)</span> 非负且最小的解，而且它们关于 <span class="arithmatex">\(y\)</span> 轴对称，此时选择 <span class="arithmatex">\(x&gt;0\)</span> 的那个作为基本解。由此，求解广义 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span>，就相当于求解它的基本解集 <span class="arithmatex">\(U\)</span>。设它对应的 Pell 方程的基本解是 <span class="arithmatex">\((r,s)\)</span>，则广义 Pell 方程的全部解的集合是</p>
<div class="arithmatex">\[
\{(x,y):x+y\sqrt{D}=\pm(r+s\sqrt{D})^k(u+v\sqrt{D}),k\in\mathbf Z,u+v\sqrt{D}\in U\}.
\]</div>
<p>广义 Pell 方程的基本解必然是有限的。这是因为从上面的通解表达式可知，绝对值 <span class="arithmatex">\(|u+v\sqrt{D}|\)</span> 必然位于 <span class="arithmatex">\(r-s\sqrt{D}\)</span> 和 <span class="arithmatex">\(r+s\sqrt{D}\)</span> 之间。文末的参考文献中提供了关于基本解的坐标的范围的更严格的估计。当然，与 Pell 方程的情形不同，广义 Pell 方程可能没有解。</p>
<p>利用广义 Pell 方程的一个解 <span class="arithmatex">\((u,v)\)</span> 和 Pell 方程的基本解 <span class="arithmatex">\((r,s)\)</span> 得到同一个等价类中的全部解的方法，除了利用解的复合之外，还可以利用如下递推关系</p>
<div class="arithmatex">\[
x_{k} = 2rx_{k-1} - x_{k-2},\ y_{k} = 2ry_{k-1} - y_{k-2},
\]</div>
<p>其中，<span class="arithmatex">\(x_k+y_k\sqrt{D}=(r+s\sqrt{D})^k(u+v\sqrt{D})\)</span>。这是因为 <span class="arithmatex">\(x_n\)</span> 和 <span class="arithmatex">\(y_n\)</span> 都可以对某一对实数 <span class="arithmatex">\((A,B)\)</span> 写成 <span class="arithmatex">\(A(r+s\sqrt{D})^k+B(r-s\sqrt{D})^k\)</span> 的形式，而根据 Vieta 定理，<span class="arithmatex">\(r\pm s\sqrt{D}\)</span> 是方程 <span class="arithmatex">\(x^2-2rx+1=0\)</span> 的两个实根，进而 <span class="arithmatex">\(x_n\)</span> 和 <span class="arithmatex">\(y_n\)</span> 都满足上述的二阶常系数递推关系。相较于解的复合，该递推公式有更少的乘法次数。</p>
<h2 id="_3">求解方法<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>Pell 方程和广义 Pell 方程的求解都可以基于连分数进行。</p>
<h3 id="pqa">PQa 算法<a class="headerlink" href="#pqa" title="Permanent link">&para;</a></h3>
<p>本文讨论的算法都基于 PQa 算法，它可以用于求出特定的二次无理数的连分数展开。</p>
<p>设整数 <span class="arithmatex">\(P_0,Q_0,D\)</span> 满足 <span class="arithmatex">\(Q_0\neq 0\)</span>，<span class="arithmatex">\(D&gt;0\)</span> 且不是完全平方数，以及 <span class="arithmatex">\(P_0^2\equiv D\pmod{Q_0}\)</span>。那么，二次无理数</p>
<div class="arithmatex">\[
\omega=\dfrac{P_0+\sqrt{D}}{Q_0}
\]</div>
<p>的连分数展开 <span class="arithmatex">\([a_0,a_1,\cdots]\)</span> 可以通过如下 <a href="../continued-fraction/#二次无理数">递推公式</a> 求得：</p>
<div class="arithmatex">\[
a_k = \left\lfloor\dfrac{P_k+\sqrt{D}}{Q_k}\right\rfloor,\ P_{k+1} = a_kQ_k - P_k,\ Q_{k+1} = \dfrac{D-P_{k+1}^2}{Q_k}.
\]</div>
<p>进而，<span class="arithmatex">\(\omega\)</span> 的第 <span class="arithmatex">\(k\)</span> 个渐近分数的分子和分母 <span class="arithmatex">\(A_k\)</span> 和 <span class="arithmatex">\(B_k\)</span> 由如下 <a href="../continued-fraction/#递推关系">递推公式</a> 给出：</p>
<div class="arithmatex">\[
A_k = a_kA_{k-1} + A_{k-2},\ B_k = a_kB_{k-1} + B_{k-2}
\]</div>
<p>且 <span class="arithmatex">\(A_{-1} = 1\)</span>，<span class="arithmatex">\(A_{-2}=0\)</span>，<span class="arithmatex">\(B_{-1}=0\)</span>，<span class="arithmatex">\(B_{-2}=1\)</span>。</p>
<p>这些公式的正确性已经在连分数一文中得到证明。那里也说明了，因为二次无理数是 <a href="../continued-fraction/#二次无理数">循环连分数</a>，所以，三元组 <span class="arithmatex">\((P_k,Q_k,a_k)\)</span> 最终将进入循环，算法总可以在有限步内终止。不妨设循环节的最小长度是 <span class="arithmatex">\(\ell\)</span>，且循环的最早的起始位置是 <span class="arithmatex">\(k_0\)</span>，则二次无理数的连分数展开可以写作</p>
<div class="arithmatex">\[
\omega=[a_0,\cdots,a_{k_0-1},\overline{a_{k_0},\cdots,a_{k_0+\ell-1}}].
\]</div>
<p>利用 PQa 算法解决 Pell 方程，需要建立如下结论：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>继续上述记号。设 <span class="arithmatex">\(G_k=Q_0A_k-P_0B_k\)</span>，则整数对 <span class="arithmatex">\((G_{k-1},B_{k-1})\)</span> 满足关系式</p>
<div class="arithmatex">\[
G_{k-1}^2-DB_{k-1}^2=(-1)^{k}Q_0Q_{k},
\]</div>
<p>且它们的最大公因数 <span class="arithmatex">\(\gcd(G_{k-1},B_{k-1})\)</span> 整除 <span class="arithmatex">\(Q_{k}\)</span>。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>设 <span class="arithmatex">\(\omega\)</span> 的连分数展开中，第 <span class="arithmatex">\(k\)</span> 个余项（完全商）为 <span class="arithmatex">\(\omega_{k}\)</span>，即</p>
<div class="arithmatex">\[
\omega = [a_0,a_1,\cdots,a_{k-1},\omega_k] = \dfrac{\omega_k A_{k-1}+A_{k-2}}{\omega_k B_{k-1}+B_{k-2}}.
\]</div>
<p>将 <span class="arithmatex">\(\omega=(P_0+\sqrt{D})/Q_0\)</span> 和 <span class="arithmatex">\(\omega_k=(P_k+\sqrt{D})/Q_k\)</span> 代入上式，就得到</p>
<div class="arithmatex">\[
\dfrac{P_0+\sqrt{D}}{Q_0} = \dfrac{(P_k+\sqrt{D})A_{k-1}+Q_kA_{k-2}}{(P_k+\sqrt{D})B_{k-1}+Q_kB_{k-2}}.
\]</div>
<p>消去左右两侧的分母并比较有理部分和无理部分的系数，再代入 <span class="arithmatex">\(G_k\)</span> 的表达式，就得到如下等式：</p>
<div class="arithmatex">\[
\begin{aligned}
G_{k-1} &amp;= P_kB_{k-1} + Q_kB_{k-2},\\
DB_{k-1} &amp;= P_kG_{k-1} + Q_kG_{k-2}.
\end{aligned}
\]</div>
<p>因此，将一式乘以 <span class="arithmatex">\(G_{k-1}\)</span> 减去二式乘以 <span class="arithmatex">\(B_{k-1}\)</span>，就有</p>
<div class="arithmatex">\[
\begin{aligned}
G_{k-1}^2-DB_{k-1}^2 &amp;= (B_{k-2}G_{k-1}-B_{k-1}G_{k-2})Q_k \\
&amp;= (A_{k-1}B_{k-2}-B_{k-1}A_{k-2})Q_0Q_k \\
&amp;= (-1)^kQ_0Q_k.
\end{aligned}
\]</div>
<p>最后一步利用了渐近分数的 <a href="../continued-fraction/#误差估计">差分公式</a>。这就证明了第一个结论。</p>
<p>为了证明第二个结论，将 <span class="arithmatex">\(G_k\)</span> 的表达式代入第一个结论，有</p>
<div class="arithmatex">\[
(Q_0A_{k-1}-P_0B_{k-1})^2 - DB_{k-1}^2 = (-1)^kQ_0Q_k.
\]</div>
<p>所以，利用 <span class="arithmatex">\(Q_0\mid(P_0^2-D)\)</span> 有</p>
<div class="arithmatex">\[
Q_0A_{k-1}^2 +\left(\dfrac{P_0^2-D}{Q_0}B_{k-1}- 2P_0A_{k-1}\right)B_{k-1} = (-1)^kQ_k.
\]</div>
<p>故而，<span class="arithmatex">\(\gcd(G_{k-1},B_{k-1}) = \gcd(Q_0A_{k-1},B_{k-1})\)</span> 整除 <span class="arithmatex">\(Q_k\)</span>。</p>
</details>
<p>这个结论提供了一种寻找方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的解的方法。如果合理地选择 <span class="arithmatex">\(Q_0&gt;0\)</span> 并选择 <span class="arithmatex">\(P_0\)</span> 为同余方程 <span class="arithmatex">\(P_0^2\equiv D\pmod{Q_0}\)</span> 的解，那么通过对 <span class="arithmatex">\((P_0+\sqrt{D})/Q_0\)</span> 执行 PQa 算法，直到找到 <span class="arithmatex">\((-1)^kQ_0Q_{k}=N\)</span>，此时 <span class="arithmatex">\((G_{k-1},B_{k-1})\)</span> 就成为原方程的一组解。而且，如果 <span class="arithmatex">\(Q_k=\pm 1\)</span>，那么这样得到的解一定是本原解，也就是说 <span class="arithmatex">\(G_{k-1}\)</span> 和 <span class="arithmatex">\(B_{k-1}\)</span> 一定是互素的。</p>
<p>这个思想是解决 Pell 方程和广义 Pell 方程的核心。理解了这一思想后，下面就着手处理算法的一些细节，并证明所有的解都可以通过该方式得到。</p>
<h3 id="pell_2">Pell 方程<a class="headerlink" href="#pell_2" title="Permanent link">&para;</a></h3>
<p>要解决 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span>，只需要对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,D)\)</span> 运行 PQa 算法，直到出现 <span class="arithmatex">\((-1)^kQ_k=1\)</span>，此时 <span class="arithmatex">\((A_{k-1},B_{k-1})\)</span> 就是 Pell 方程的一组解（因为 <span class="arithmatex">\(G_{k-1}\)</span> 此时就是 <span class="arithmatex">\(A_{k-1}\)</span>)。当然，对于 Pell 方程，对该过程可以进行更精确的描述。</p>
<p>首先，解一定出现在循环节的末尾处。上述过程相当于对 <span class="arithmatex">\(\sqrt{D}\)</span> 做连分数展开。对此，已经有 <a href="../continued-fraction/#纯循环连分数">结论</a>：</p>
<div class="arithmatex">\[
\sqrt{D} = [\lfloor\sqrt{D}\rfloor,\overline{a_1,\cdots,a_{\ell-1},2\lfloor\sqrt{D}\rfloor}].
\]</div>
<p>此处，循环节长度为 <span class="arithmatex">\(\ell\)</span>，且起始位置是第 <span class="arithmatex">\(1\)</span> 项（下标从 <span class="arithmatex">\(0\)</span> 开始）。而且，它的第 <span class="arithmatex">\(\ell\)</span> 项余项等于 <span class="arithmatex">\(\lfloor\sqrt{D}\rfloor+\sqrt{D}\)</span>，这说明 <span class="arithmatex">\(Q_{\ell}=1\)</span>。因此，如果 <span class="arithmatex">\(\ell\)</span> 是偶数，那么 <span class="arithmatex">\((A_{\ell-1},B_{\ell-1})\)</span> 就是 Pell 方程的一组非平凡解；如果 <span class="arithmatex">\(\ell\)</span> 是奇数，那么 <span class="arithmatex">\((A_{2\ell-1},B_{2\ell-1})\)</span> 就是 Pell 方程的一组非平凡解。</p>
<p>接下来要说明，刚刚得到的这组解一定是基础解。这个结论基于两点理由：第一，Pell 方程的所有正整数解 <span class="arithmatex">\((x,y)\)</span> 对应的分数 <span class="arithmatex">\(x/y\)</span> 都出现在 <span class="arithmatex">\(\sqrt{D}\)</span> 的渐近分数中，这就保证了 <span class="arithmatex">\((x,y)\)</span> 必定是 PQa 算法过程中的某个 <span class="arithmatex">\((A_k,B_k)\)</span>；第二，除了循环节末尾，不会再出现其他位置有 <span class="arithmatex">\(Q_k=1\)</span>，因为 <span class="arithmatex">\(A_k\)</span> 和 <span class="arithmatex">\(B_k\)</span> 的递推关系保证了它们的大小随着下标增加而增加，所以最小的正整数解（即基础解）必然出现在刚刚指明的位置。这两点理由可以分别从如下的两条定理得出：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 有正整数解 <span class="arithmatex">\((x,y)\)</span>，如果 <span class="arithmatex">\(|N|&lt;\sqrt{D}\)</span>，那么 <span class="arithmatex">\(\dfrac{x}{y}\)</span> 一定等于 <span class="arithmatex">\(\sqrt{D}\)</span> 的渐近分数。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>当 <span class="arithmatex">\(N&gt;0\)</span> 时，因为 <span class="arithmatex">\(x^2-Dy^2&gt;0\)</span>，所以 <span class="arithmatex">\(x&gt;y\sqrt{D}\)</span>。故而，有</p>
<div class="arithmatex">\[
\left|\dfrac{x}{y}-\sqrt{D}\right| = \dfrac{N}{y(x+y\sqrt{D})}&lt;\dfrac{N}{2y^2\sqrt{D}}&lt;\dfrac{1}{2y^2}.
\]</div>
<p>根据 <a href="../continued-fraction/#渐近分数的判定">Legendre 判别法</a> 可知，<span class="arithmatex">\(\dfrac{x}{y}\)</span> 是 <span class="arithmatex">\(\sqrt{D}\)</span> 的渐近分数。</p>
<p>当 <span class="arithmatex">\(N&lt;0\)</span> 时，<span class="arithmatex">\(x&gt;y\sqrt{D}\)</span> 不再成立。所以，转而考虑方程 <span class="arithmatex">\(y^2-\dfrac{1}{D}x^2=-\dfrac{N}{D}\)</span> 的解。因为 <span class="arithmatex">\(\dfrac{|N|}{D}&lt;\sqrt{\dfrac{1}{D}}\)</span>，所以上面的论证依然成立。这说明 <span class="arithmatex">\(\dfrac{y}{x}\)</span> 是 <span class="arithmatex">\(\dfrac{1}{\sqrt{D}}\)</span> 的渐近分数。根据 <a href="../continued-fraction/#递推关系">倒数定理</a> 可知，<span class="arithmatex">\(\dfrac{x}{y}\)</span> 也是 <span class="arithmatex">\(\sqrt{D}\)</span> 的渐近分数。</p>
</details>
<details class="note" open="open">
<summary>定理</summary>
<p>在对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,D)\)</span> 运行上述 PQa 算法的过程中，<span class="arithmatex">\(Q_k=1\)</span> 必然推出 <span class="arithmatex">\(\ell\mid k\)</span>。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>在 <span class="arithmatex">\(\sqrt{D}\)</span> 的连分数展开中，除了第 <span class="arithmatex">\(0\)</span> 个余项，所有其他余项都是 <a href="../continued-fraction/#纯循环连分数">纯循环连分数</a>。设 <span class="arithmatex">\(Q_k=1\)</span>。根据 Galois 的结论，必然有余项 <span class="arithmatex">\(\omega_k=P_k+\sqrt{D}&gt;1\)</span>，且它的共轭 <span class="arithmatex">\(-1&lt;P_k-\sqrt{D}&lt;0\)</span>，这说明 <span class="arithmatex">\(P_k=\lfloor\sqrt{D}\rfloor\)</span>。因此，余项 <span class="arithmatex">\(\omega_k\)</span> 就等于 <span class="arithmatex">\(\omega_\ell\)</span>。但是，余项的重复意味着连分数的循环，如果 <span class="arithmatex">\(k\)</span> 不是 <span class="arithmatex">\(\ell\)</span> 的整数倍，就与 <span class="arithmatex">\(\ell\)</span> 是最小正周期相矛盾。所以，必然有 <span class="arithmatex">\(\ell\mid k\)</span>。</p>
</details>
<p>综合本节的讨论可知，只要对 <span class="arithmatex">\(\sqrt{D}\)</span> 做连分数展开，亦即以 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,D)\)</span> 为起点做 PQa 算法，当首次得到 <span class="arithmatex">\(Q_\ell=1\)</span> 时，就到达了第一个循环节的末尾。此时，如果 <span class="arithmatex">\(\ell\)</span> 是偶数，那么 <span class="arithmatex">\((A_{\ell-1},B_{\ell-1})\)</span> 就是 Pell 方程的基本解；否则，<span class="arithmatex">\((A_{2\ell-1},B_{2\ell-1})\)</span> 是 Pell 方程的基本解。对于循环节长度 <span class="arithmatex">\(\ell\)</span> 为奇数的情形，并不需要继续 PQa 算法到两倍的循环节处，马上就会说明 <span class="arithmatex">\(A_{2\ell-1}+B_{2\ell-1}\sqrt{D}=(A_{\ell-1}+B_{\ell-1}\sqrt{D})^2\)</span>，因而可以直接从 <span class="arithmatex">\((A_{\ell-1},B_{\ell-1})\)</span> 直接计算出 Pell 方程的基本解。Pell 方程所有其他解都可以通过 Pell 方程的基本解计算。</p>
<details class="example">
<summary>示例</summary>
<ol>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-14y^2=1\)</span>。</p>
<p>对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,14)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{1}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{2}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{1}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(15\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(15\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{6}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(101\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(27\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(101\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(116\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(31\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(116\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=4\)</span> 为偶数。方程的最小正整数解为 <span class="arithmatex">\((G_3,B_3)=(15,4)\)</span>。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-41y^2=1\)</span>。</p>
<p>对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,41)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{2}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{2}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(32\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(32\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{12}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(397\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(62\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(397\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(826\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(129\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(826\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2049\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(320\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2049\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(25414\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3969\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(25414\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(52877\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8258\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(52877\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=3\)</span> 为奇数。方程的最小正整数解为 <span class="arithmatex">\((G_5,B_5)=(2049,320)\)</span>。它也可以通过 <span class="arithmatex">\((G_2,B_2)=(32,5)\)</span> 计算得出：</p>
<div class="arithmatex">\[
(32+5\sqrt{41})^2=2049+320\sqrt{41}.
\]</div>
</li>
</ol>
</details>
<h3 id="pell_3">负 Pell 方程<a class="headerlink" href="#pell_3" title="Permanent link">&para;</a></h3>
<p>根据上一节的讨论可知，负 Pell 方程的解也必然对应于 <span class="arithmatex">\(\sqrt{D}\)</span> 的渐近分数，而且只能出现在 <span class="arithmatex">\((-1)^kQ_k=-1\)</span> 处。这只能出现在循环节的末尾。因此，负 Pell 方程有解，当且仅当循环节长度 <span class="arithmatex">\(\ell\)</span> 是奇数。当解存在时，<span class="arithmatex">\((A_{\ell-1},B_{\ell-1})\)</span> 就是负 Pell 方程的基本解。它的求解方法和上一节是一致的。</p>
<p>利用前文对于 Pell 方程解的结构的证明相仿的思路，可以证明如下结论：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解，且基本解是 <span class="arithmatex">\((x_1,y_1)\)</span>。那么，<span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的所有整数解都属于集合</p>
<div class="arithmatex">\[
\{(x,y):x+y\sqrt{D}=\pm(x_1+y_1\sqrt{D})^k,k\in\mathbf Z\}.
\]</div>
<p>特别地，满足 <span class="arithmatex">\(x_2+y_2\sqrt{D}=(x_1+y_1\sqrt{D})^2\)</span> 的整数解 <span class="arithmatex">\((x_2,y_2)\)</span> 正是 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>由于对称性，只需要考虑正整数解，即 <span class="arithmatex">\(x+y\sqrt{D}&gt;1\)</span> 的情形。但是由于 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 是两段双曲线，所以 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 无法和 <span class="arithmatex">\((x,y)\)</span> 建立一一对应。为了处理这种困难，首先证明上述的 <span class="arithmatex">\((x_2,y_2)\)</span> 是 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解。</p>
<p>显然，<span class="arithmatex">\((x_2,y_2)\)</span> 是 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的解。如果设 <span class="arithmatex">\((z,w)\)</span> 是 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解，那么必然有 <span class="arithmatex">\(1&lt;z+w\sqrt{D}\le x_2+y_2\sqrt{D}\)</span>。如果右侧的不等式不含有等号，那么将不等式同除以 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 就得到 <span class="arithmatex">\(-x_1+y_1\sqrt{D}&lt;(z+w\sqrt{D})(-x_1+y_1\sqrt{D})&lt;x_1+y_1\sqrt{D}\)</span>。将该不等式的中间项的表达式展开就能得到 <span class="arithmatex">\(x'+y'\sqrt{D}\)</span> 的形式，它的范数是 <span class="arithmatex">\(-1\)</span> 且 <span class="arithmatex">\((x',y')\)</span> 也是整数解。将该不等式取倒数，就发现 <span class="arithmatex">\(-x'+y'\sqrt{D}\)</span> 同样落入 <span class="arithmatex">\(-x_1+y_1\sqrt{D}\)</span> 和 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 之间。二次整数 <span class="arithmatex">\(\pm x'+y'\sqrt{D}\)</span> 互为倒数，必然有一个大于 <span class="arithmatex">\(1\)</span>。但是 <span class="arithmatex">\(1\)</span> 和 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 不应该再出现别的范数为 <span class="arithmatex">\(-1\)</span> 的二次整数，这与 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 的最小性矛盾。所以，必然成立 <span class="arithmatex">\(x_2+y_2\sqrt{D}=z+w\sqrt{D}\)</span>，即 <span class="arithmatex">\((x_2,y_2)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解。</p>
<p>基于此，如果出现方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的解 <span class="arithmatex">\((x,y)\)</span> 不对应某个 <span class="arithmatex">\((x_1+y_1\sqrt{D})^k\)</span>，那么必然存在 <span class="arithmatex">\(k\)</span> 使得 <span class="arithmatex">\((x_1+y_1\sqrt{D})^{2k}&lt;x+y\sqrt{D}&lt;(x_1+y_1\sqrt{D})^{2k+2}\)</span>，消去因子 <span class="arithmatex">\((x_1+y_1)^{2k+1}\)</span>，就说明存在位于 <span class="arithmatex">\(-x_1+y_1\sqrt{D}\)</span> 和 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 之间的范数为 <span class="arithmatex">\(\pm 1\)</span> 的二次整数 <span class="arithmatex">\(x'+y'\sqrt{D}\neq 1\)</span>。重复上一段利用倒数的论证可知，这与 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 的最小性矛盾。因而原命题得证。</p>
</details>
<p>因为 <span class="arithmatex">\((A_{\ell-1},B_{\ell-1})\)</span> 是负 Pell 方程的最小正整数解，而 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的所有正整数解都出现在集合</p>
<div class="arithmatex">\[
\{(x,y):x+y\sqrt{D}=(A_{\ell-1}+B_{\ell-1}\sqrt{D})^k,k\in\mathbf N_+\}
\]</div>
<p>中，又因为这些正整数解必然对应 <span class="arithmatex">\(\sqrt{D}\)</span> 的在循环节末尾（前一位）处的渐近分数，而且渐近分数的分子和分母是严格单调递增的，所以对所有 <span class="arithmatex">\(k\in\mathbf N_+\)</span> 总是有</p>
<div class="arithmatex">\[
(A_{\ell-1}+B_{\ell-1}\sqrt{D})^k = A_{k\ell-1}+B_{k\ell-1}\sqrt{D}.
\]</div>
<p>在所有这些正整数解中，<span class="arithmatex">\(k\)</span> 为奇数时就是负 Pell 方程的解，<span class="arithmatex">\(k\)</span> 为偶数时就是 Pell 方程的解，两者交替出现。</p>
<p>判断负 Pell 方程是否有解，需要计算 <span class="arithmatex">\(\sqrt{D}\)</span> 连分数展开的循环节的长度，这并不容易计算，因此希望能够找到更简单的判断方法。但是，目前并没有条件简明、容易计算的判断方法<sup id="fnref:solubility-neg-pell"><a class="footnote-ref" href="#fn:solubility-neg-pell">5</a></sup>。此处仅仅提供一个简单的结论。</p>
<details class="note" open="open">
<summary>定理</summary>
<p>方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解，则 <span class="arithmatex">\(4\)</span> 不能整除 <span class="arithmatex">\(D\)</span> 且 <span class="arithmatex">\(D\)</span> 不含有 <span class="arithmatex">\(4k+3\)</span> 型的素因子。反过来，如果 <span class="arithmatex">\(D=2\)</span> 或 <span class="arithmatex">\(D\)</span> 是 <span class="arithmatex">\(4k+1\)</span> 型的素数，那么方程必然有解。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>首先，负 Pell 方程有解，就意味着 <span class="arithmatex">\(-1\)</span> 是 <span class="arithmatex">\(D\)</span> 的二次剩余，因而 <span class="arithmatex">\(-1\)</span> 也是 <span class="arithmatex">\(D\)</span> 的任意一个因子 <span class="arithmatex">\(d\)</span> 的二次剩余，故而 <span class="arithmatex">\(d\neq 4\)</span> 且 <span class="arithmatex">\(d\)</span> 不是 <span class="arithmatex">\(4k+3\)</span> 型素数。反过来，方程 <span class="arithmatex">\(x^2-2y^2=-1\)</span> 的解有非平凡解 <span class="arithmatex">\((1,1)\)</span>。剩下的就是 <span class="arithmatex">\(D\)</span> 是 <span class="arithmatex">\(4k+1\)</span> 型素数的情形。</p>
<p>设 <span class="arithmatex">\(D\)</span> 是 <span class="arithmatex">\(4k+1\)</span> 型素数，要证明方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解。思路是通过 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基本解 <span class="arithmatex">\((u,v)\)</span> 入手，构造出 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 的解 <span class="arithmatex">\((\alpha,\beta)\)</span>。如果 <span class="arithmatex">\(u\)</span> 是偶数，将 <span class="arithmatex">\(u^2-Dv^2=1\)</span> 两侧对 <span class="arithmatex">\(4\)</span> 取模，就得到 <span class="arithmatex">\(v^2\equiv -1\pmod 4\)</span>，但是 <span class="arithmatex">\(-1\)</span> 并不是模 <span class="arithmatex">\(4\)</span> 的二次剩余。这个矛盾说明 <span class="arithmatex">\(u\)</span> 是奇数。考察等式 <span class="arithmatex">\(Dv^2=u^2-1=(u+1)(u-1)\)</span>。因为 <span class="arithmatex">\(u\)</span> 是奇数，所以 <span class="arithmatex">\(\gcd(u+1,u-1)=\gcd(u+1,2)=2\)</span>。根据这一事实，将 <span class="arithmatex">\(Dv^2\)</span> 的因子分给 <span class="arithmatex">\(u+1\)</span> 和 <span class="arithmatex">\(u-1\)</span>，必然一个是 <span class="arithmatex">\(2\alpha^2\)</span>，另一个是 <span class="arithmatex">\(2D\beta^2\)</span>，其中，<span class="arithmatex">\(\alpha\)</span> 和 <span class="arithmatex">\(\beta\)</span> 是互素的正整数而且 <span class="arithmatex">\(v=2\alpha\beta\)</span>。将 <span class="arithmatex">\(u=\alpha^2+D\beta^2\)</span> 和 <span class="arithmatex">\(v=2\alpha\beta\)</span> 代入 <span class="arithmatex">\(u^2-Dv^2=1\)</span> 就得到 <span class="arithmatex">\(\alpha^2-D\beta^2=\pm 1\)</span>。因为 <span class="arithmatex">\((u,v)\)</span> 是 Pell 方程的基本解而且 <span class="arithmatex">\((\alpha,\beta)\)</span> 是比 <span class="arithmatex">\((u,v)\)</span> 更小的正整数对，这个等式右侧不能是 <span class="arithmatex">\(+1\)</span>，故而只能是 <span class="arithmatex">\(-1\)</span>。这就证明 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 存在解 <span class="arithmatex">\((\alpha,\beta)\)</span>。</p>
</details>
<p>如果 <span class="arithmatex">\(D\)</span> 是合数，那么不含有 <span class="arithmatex">\(4k+3\)</span> 型素因子且没有平方因子也不能保证方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解，例如 <span class="arithmatex">\(x^2-34y^2=-1\)</span> 就没有解。</p>
<details class="example">
<summary>示例</summary>
<p>利用上面的示例中的计算结果可知，方程 <span class="arithmatex">\(x^2-14y^2=-1\)</span> 无解，且方程 <span class="arithmatex">\(x^2-41y^2=-1\)</span> 的最小正整数解为 <span class="arithmatex">\((G_2,B_2)=(32,5)\)</span>。</p>
</details>
<h3 id="4">范数为 ±4 的情形<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p>接下来讨论方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解。此时，解的性态取决于 <span class="arithmatex">\(D\bmod 4\)</span> 的大小。</p>
<p>有些情形是容易的。如果 <span class="arithmatex">\(D\equiv 0\pmod 4\)</span>，那么 <span class="arithmatex">\(x\)</span> 是偶数，因而 <span class="arithmatex">\((x/2,y)\)</span> 是方程 <span class="arithmatex">\(u^2-(D/4)v^2=\pm 1\)</span> 的解。其余的情形，必然有 <span class="arithmatex">\(x,y\)</span> 同时是奇数或者同时是偶数。如果 <span class="arithmatex">\(x,y\)</span> 同时是奇数，方程两侧对 <span class="arithmatex">\(4\)</span> 取模就得到 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>。所以，如果 <span class="arithmatex">\(D\equiv 2,3\pmod 4\)</span>，那么 <span class="arithmatex">\(x,y\)</span> 只能同时是偶数，因而 <span class="arithmatex">\((x/2,y/2)\)</span> 是方程 <span class="arithmatex">\(u^2-Dv^2=\pm 1\)</span> 的解。因此，除了 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 的情形，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解都可以通过相应的（负）Pell 方程的解得到。</p>
<p>现在讨论 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 的情形，它不能简单地转化为已经解决的情形。为了找到基本解，可以对 <span class="arithmatex">\((P_0,Q_0,D)=(1,2,D)\)</span> 应用 PQa 算法，当首次得到 <span class="arithmatex">\(Q_\ell=2\)</span> 时，就到达了第一个循环节的末尾。如果循环节长度 <span class="arithmatex">\(l\)</span> 是偶数，那么 <span class="arithmatex">\((G_{\ell-1},B_{\ell-1})\)</span> 就是方程 <span class="arithmatex">\(x^2-Dy^2=4\)</span> 的基本解；否则，<span class="arithmatex">\((G_{\ell-1},B_{\ell-1})\)</span> 就是方程 <span class="arithmatex">\(x^2-Dy^2=-4\)</span> 的基本解。从 <span class="arithmatex">\((G_{\ell-1},B_{\ell-1})\)</span> 出发，可以得到方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的所有解：</p>
<div class="arithmatex">\[
\left\{(x,y):\dfrac{x+y\sqrt{D}}{2}=\pm\left(\dfrac{G_{\ell-1}+B_{\ell-1}\sqrt{D}}{2}\right)^k,k\in\mathbf Z\right\}.
\]</div>
<p>如果循环节长度 <span class="arithmatex">\(\ell\)</span> 是偶数，所有这些都是方程 <span class="arithmatex">\(x^2-Dy^2=4\)</span> 的解；否则，当 <span class="arithmatex">\(k\)</span> 是奇数时，<span class="arithmatex">\((x,y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=-4\)</span> 的解，而当 <span class="arithmatex">\(k\)</span> 是偶数时，<span class="arithmatex">\((x,y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=4\)</span> 的解。</p>
<p>这个算法的正确性依赖于如下事实：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 有正整数解 <span class="arithmatex">\((x,y)\)</span>。如果 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>，那么，<span class="arithmatex">\(\dfrac{(x+y)/2}{y}\)</span> 一定是 <span class="arithmatex">\(\dfrac{1+\sqrt{D}}{2}\)</span> 的渐近分数。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>首先注意到，此时 <span class="arithmatex">\(x,y\)</span> 必然奇偶性相同，所以 <span class="arithmatex">\((x+y)/2\)</span> 是整数。如果 <span class="arithmatex">\((x,y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=4\)</span> 的解，那么 <span class="arithmatex">\(x&gt;y\sqrt{D}&gt;2y\)</span>，所以，</p>
<div class="arithmatex">\[
\left|\dfrac{(x+y)/2}{y}-\dfrac{1+\sqrt{D}}{2}\right| = \dfrac{2}{y(x+y\sqrt{D})}&lt;\dfrac{1}{2y^2}.
\]</div>
<p>根据 <a href="../continued-fraction/#渐近分数的判定">Legendre 判别法</a> 可知，<span class="arithmatex">\(\dfrac{(x+y)/2}{y}\)</span> 是 <span class="arithmatex">\(\dfrac{1+\sqrt{D}}{2}\)</span> 的渐近分数。</p>
<p>如果 <span class="arithmatex">\((x,y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=-4\)</span> 的解，那么要建立上述不等式，只需要证明 <span class="arithmatex">\(4y&lt;x+y\sqrt{D}\)</span>。这至少对于除了 <span class="arithmatex">\(D=5,13\)</span> 之外的情形都成立。对于 <span class="arithmatex">\(D=5,13\)</span> 的情形，将 <span class="arithmatex">\(x=\sqrt{Dy^2-4}\)</span> 代入该不等式可知，它等价于 <span class="arithmatex">\(2(\sqrt{D}-2)y^2&gt;1\)</span> 成立。除了 <span class="arithmatex">\((D,y)=(5,1)\)</span> 之外，该不等式对于所有 <span class="arithmatex">\(D=5,13\)</span> 和正整数 <span class="arithmatex">\(y\)</span> 都成立。剩下的就是验证 <span class="arithmatex">\((D,y)=(5,1)\)</span> 的情形，此时，方程 <span class="arithmatex">\(x^2-5y^2=-4\)</span> 的解是 <span class="arithmatex">\((x,y)=(1,1)\)</span>，需要验证的是 <span class="arithmatex">\(\dfrac{1}{1}\)</span> 是 <span class="arithmatex">\(\dfrac{1+\sqrt{5}}{2}=[\overline{1}]\)</span> 的渐近分数，而这是显然成立的。</p>
</details>
<details class="note" open="open">
<summary>定理</summary>
<p>设 <span class="arithmatex">\(D\)</span> 是正整数但不是完全平方数。二次无理数 <span class="arithmatex">\(\omega=\dfrac{1+\sqrt{D}}{2}\)</span> 的连分数展开具有形式</p>
<div class="arithmatex">\[
\omega = [\lfloor\omega\rfloor,\overline{a_1,\cdots,a_{\ell-1},2\lfloor\omega\rfloor-1}],
\]</div>
<p>其中，<span class="arithmatex">\(\ell\)</span> 为循环节长度，且 <span class="arithmatex">\(a_k=a_{\ell-k}\)</span> 对任何 <span class="arithmatex">\(1&lt;k&lt;\ell\)</span> 都成立。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>因为 <span class="arithmatex">\(\lfloor\omega\rfloor-1+\omega&gt;1\)</span>，而且它的共轭等于 <span class="arithmatex">\(\lfloor\omega\rfloor - \omega\)</span>，位于 <span class="arithmatex">\(-1\)</span> 和 <span class="arithmatex">\(0\)</span> 之间，所以根据 <a href="../continued-fraction/#纯循环连分数">Galois 的结论</a> 可知，<span class="arithmatex">\(\lfloor\omega\rfloor-1+\omega\)</span> 是纯循环连分数，可以写成</p>
<div class="arithmatex">\[
\lfloor\omega\rfloor-1+\omega = [\overline{2\lfloor\omega\rfloor-1,a_1,\cdots,a_{\ell-1}}].
\]</div>
<p>而 Galois 关于倒数负共轭的结论说明</p>
<div class="arithmatex">\[
\dfrac{1}{\omega-\lfloor\omega\rfloor} = [\overline{a_{\ell-1},\cdots,a_1,2\lfloor\omega\rfloor-1}].
\]</div>
<p>因此，根据连分数的定义，有</p>
<div class="arithmatex">\[
\lfloor\omega\rfloor-1+\omega = 2\lfloor\omega\rfloor-1 + \dfrac{1}{\dfrac{1}{\omega-\lfloor\omega\rfloor}} = [2\lfloor\omega\rfloor-1,\overline{a_{\ell-1},\cdots,a_1,2\lfloor\omega\rfloor-1}].
\]</div>
<p>连分数展开的唯一性就说明 <span class="arithmatex">\(a_k=a_{\ell-k}\)</span> 对所有 <span class="arithmatex">\(1&lt;k&lt;\ell\)</span> 都成立，因而要证明的展开式也成立。</p>
</details>
<details class="note" open="open">
<summary>定理</summary>
<p>设 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>。在对 <span class="arithmatex">\((P_0,Q_0,D)=(1,2,D)\)</span> 运行上述 PQa 算法的过程中，<span class="arithmatex">\(Q_k=2\)</span> 必然推出 <span class="arithmatex">\(\ell\mid k\)</span>。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>在 <span class="arithmatex">\(\dfrac{1+\sqrt{D}}{2}\)</span> 的连分数展开中，除了第 <span class="arithmatex">\(0\)</span> 个余项，所有其他余项都是 <a href="../continued-fraction/#纯循环连分数">纯循环连分数</a>。设 <span class="arithmatex">\(Q_k=2\)</span>。根据 Galois 的结论，必然有余项 <span class="arithmatex">\(\omega_k=\dfrac{P_k+\sqrt{D}}{2}\)</span> 的共轭 <span class="arithmatex">\(-1&lt;\dfrac{P_k-\sqrt{D}}{2}&lt;0\)</span>，亦即 <span class="arithmatex">\(\sqrt{D}-2&lt;P_k&lt;\sqrt{D}\)</span>。因为 PQa 算法中总有 <span class="arithmatex">\(Q_k\mid P_k^2-D\)</span>（见 <a href="../continued-fraction/#二次无理数">算法正确性证明</a>），所以 <span class="arithmatex">\(P_k\)</span> 一定是奇数，这就说明 <span class="arithmatex">\(P_k\)</span> 取值唯一，即 <span class="arithmatex">\(P_k=P_0+2(\lfloor\omega\rfloor-1)\)</span>，也就是说余项 <span class="arithmatex">\(\omega_k=\omega\ell\)</span>。但是，余项的重复意味着连分数的循环，如果 <span class="arithmatex">\(k\)</span> 不是 <span class="arithmatex">\(\ell\)</span> 的整数倍，就与 <span class="arithmatex">\(\ell\)</span> 是最小正周期相矛盾。所以，必然有 <span class="arithmatex">\(\ell\mid k\)</span>。</p>
</details>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的最小正整数解为 <span class="arithmatex">\((x_1,y_1)\)</span>。那么，它的全部解就是</p>
<div class="arithmatex">\[
\left\{(x,y):\dfrac{x+y\sqrt{D}}{2}=\pm\left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^k,k\in\mathbf Z\right\}.
\]</div>
</details>
<details class="note">
<summary>证明</summary>
<p>根据对称性，只需要考虑正整数解 <span class="arithmatex">\((x,y)\)</span> 即可。此处需要证明的只有集合中的实数对 <span class="arithmatex">\((x,y)\)</span> 确实是方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的整数解。剩下的事情只需要复述对方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的解的结构的证明即可。</p>
<p>实际上要证明的是，对于方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的任何整数解 <span class="arithmatex">\((x_1,y_1)\)</span> 和 <span class="arithmatex">\((x_2,y_2)\)</span>，如下定义的正实数对 <span class="arithmatex">\((x_3,y_3)\)</span> 仍然是整数解：</p>
<div class="arithmatex">\[
\dfrac{x_3+y_3\sqrt{D}}{2} = \dfrac{x_1+y_1\sqrt{D}}{2}\dfrac{x_2+y_2\sqrt{D}}{2}.
\]</div>
<p>展开右侧，比较有理项和无理项的系数可知</p>
<div class="arithmatex">\[
x_3=\dfrac{x_1x_2+Dy_1y_2}{2},\ y_3=\dfrac{x_1y_2+x_2y_1}{2}.
\]</div>
<p>因为对 <span class="arithmatex">\(i=1,2\)</span> 有 <span class="arithmatex">\(x_i\equiv x_i^2\equiv Dy_i^2\equiv Dy_i\pmod 2\)</span>，所以</p>
<div class="arithmatex">\[
\begin{aligned}
2x_3 &amp;= x_1x_2+Dy_1y_2 \equiv D^2y_1y_2+Dy_1y_2=D(D+1)y_1y_2 \equiv 0 \pmod 2,\\
2y_3 &amp;= x_1y_2+x_2y_1 \equiv Dy_1y_2+Dy_2y_1 = 2Dy_1y_2 \equiv 0 \pmod 2.
\end{aligned}
\]</div>
<p>这说明 <span class="arithmatex">\(x_3\)</span> 和 <span class="arithmatex">\(y_3\)</span> 都是整数。再利用范数保持乘法的性质可知，<span class="arithmatex">\((x_3,y_3)\)</span> 是 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解。</p>
</details>
<p>综合这些事实，重复前文几节的论述，就可以说明用于解决方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的上述算法的正确性。这些结果说明，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 具有和方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 类似的简单的解的结构：它的所有解都可以通过其最小正整数解表示出来，而无需求解其它方程。</p>
<p>其实，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的所有解都可以在方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解中找到，因而从这个角度看，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 更为基础。显然，<span class="arithmatex">\((x,y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的解，当且仅当 <span class="arithmatex">\((2x,2y)\)</span> 是方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解。前文的分析指出，当 <span class="arithmatex">\(D\equiv 2,3\pmod 4\)</span> 时，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的所有解都一定同为偶数，因而对应于 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的解。</p>
<p>当 <span class="arithmatex">\(D\equiv 0\pmod 4\)</span> 时，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解 <span class="arithmatex">\((x,y)\)</span> 中，<span class="arithmatex">\(x\)</span> 一定是偶数，但是 <span class="arithmatex">\(y\)</span> 可能是奇数。如果在方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的最小正整数解 <span class="arithmatex">\((x_1,y_1)\)</span> 中，<span class="arithmatex">\(y_1\)</span> 是偶数，那么在所有解中 <span class="arithmatex">\(y\)</span> 也一定是偶数，此时这些整数解和方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的整数解一一对应；但是，如果在最小整数解 <span class="arithmatex">\((x_1,y_1)\)</span> 中，<span class="arithmatex">\(y_1\)</span> 是奇数，那么 <span class="arithmatex">\(y_k\)</span> 的奇偶性将和 <span class="arithmatex">\(k\)</span> 一致，交替变化，因而只有当 <span class="arithmatex">\(k\)</span> 是偶数时，才对应于方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的解。如果 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的最小正整数解中 <span class="arithmatex">\(y_1\)</span> 是奇数而且 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span> 的范数是 <span class="arithmatex">\(-4\)</span>，那么，对于这样的 <span class="arithmatex">\(D\)</span>，<span class="arithmatex">\(x^2-Dy^2=-4\)</span> 有解，但是 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 无解。</p>
<p>当 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 时，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的解 <span class="arithmatex">\((x,y)\)</span> 可能同时是奇数，也可能同时是偶数。如果最小正整数解 <span class="arithmatex">\((x_1,y_1)\)</span> 已经同时是偶数，那么它的所有整数解也一定同时是偶数，所以总是对应于方程 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的整数解。如果最小正整数解 <span class="arithmatex">\((x_1,y_1)\)</span> 同时是奇数，那么有如下结论：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的最小正整数解是 <span class="arithmatex">\((x_1,y_1)\)</span>。如果 <span class="arithmatex">\(x_1\)</span> 和 <span class="arithmatex">\(y_1\)</span> 同时是奇数，那么，<span class="arithmatex">\(D\equiv 5\pmod 8\)</span>，且该方程的整数解 <span class="arithmatex">\((x,y)\)</span> 同时是偶数，当且仅当</p>
<div class="arithmatex">\[
\dfrac{x+y\sqrt{D}}{2} = \pm\left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^{3k},k\in\mathbf Z.
\]</div>
</details>
<details class="note">
<summary>证明</summary>
<p>等式 <span class="arithmatex">\(x_1^2-Dy_1^2=\pm 4\)</span> 的两边同时对 <span class="arithmatex">\(8\)</span> 取模，得到 <span class="arithmatex">\(D\equiv 5\pmod 8\)</span>。要证明第二个结论，首先证明 <span class="arithmatex">\((x_3,y_3)\)</span> 都是偶数，因为</p>
<div class="arithmatex">\[
\dfrac{x_3+y_3\sqrt{D}}{2} = \left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^{3} = \dfrac{x_1^3+3Dxy_1^2}{8}+\dfrac{3x_1^2y_1+Dy_1^3}{8}\sqrt{D},
\]</div>
<p>所以，只需要证明右侧是整数。因为奇数的平方模 <span class="arithmatex">\(8\)</span> 余 <span class="arithmatex">\(1\)</span>，所以，有</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;x_1^3+3Dxy_1 = x_1(x_1^2+3Dy_1) \equiv x_1(1+3\times 5\times 1) = 16x_1 = 0 \pmod 8,\\
&amp;3x_1^2y_1+Dy_1^3 = y_1(3x_1^2+Dy_1^2) \equiv y_1(3\times 1+5\times 1) = 8y_1 = 0 \pmod 8.
\end{aligned}
\]</div>
<p>这就说明了 <span class="arithmatex">\(x_3,y_3\)</span> 都是偶数。进而，对于所有 <span class="arithmatex">\(k\in\mathbf Z\)</span>，都有</p>
<div class="arithmatex">\[
\dfrac{x+y\sqrt{D}}{2} = \pm\left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^{3k} = \pm\left(\dfrac{x_3+y_3\sqrt{D}}{2}\right)^k \in \mathbf Z,
\]</div>
<p>所以此时的 <span class="arithmatex">\((x,y)\)</span> 都是偶数。反过来，对于 <span class="arithmatex">\(r=1,2\)</span>，总有</p>
<div class="arithmatex">\[
\pm\left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^{3k+r} = \pm\left(\dfrac{x_3+y_3\sqrt{D}}{2}\right)^k\left(\dfrac{x_r+y_r\sqrt{D}}{2}\right).
\]</div>
<p>要证明相应的 <span class="arithmatex">\((x,y)\)</span> 不是整数，只需要证明该式不是整数，也就是右侧的乘积中第二项不是整数。这在 <span class="arithmatex">\(r=1\)</span> 时，就是已知条件；在 <span class="arithmatex">\(r=2\)</span> 时，因为</p>
<div class="arithmatex">\[
\dfrac{x_2+y_2\sqrt{D}}{2} = \left(\dfrac{x_1+y_1\sqrt{D}}{2}\right)^2 = \dfrac{x_1^2+Dy_1^2}{4} + \dfrac{x_1y_1}{2}\sqrt{D},
\]</div>
<p>而且 <span class="arithmatex">\(x_1^2+Dy_1^2\equiv 1+1\times 1=2\pmod 4\)</span>，<span class="arithmatex">\(x_1y_1\equiv 1\pmod 2\)</span>，所以该式也不是整数。这就证明了，只有幂次是 <span class="arithmatex">\(3\)</span> 的倍数的时候，相应的解才都属偶数。</p>
</details>
<p>也就是说，方程 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的每三个解中就有一个同时是偶数，它对应着 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的整数解。这也说明，对于 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>，方程 <span class="arithmatex">\(x^2-Dy^2=-4\)</span> 有解，当且仅当方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解。</p>
<p>到目前为止的讨论，已经足够计算实二次整数环的基本单位数。设 <span class="arithmatex">\(D\)</span> 是正整数且不含平方因子。对于 <span class="arithmatex">\(D\equiv 2,3\pmod 4\)</span> 的情形，只需要求出 <span class="arithmatex">\(x^2-Dy^2=\pm 1\)</span> 的最小正整数解；而对于 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span> 的情形，只需要求出 <span class="arithmatex">\(x^2-Dy^2=\pm 4\)</span> 的最小正整数解。当得到最小正整数解 <span class="arithmatex">\((x,y)\)</span> 时，对于 <span class="arithmatex">\(D\equiv 2,3\pmod 4\)</span>，基本单位数就是 <span class="arithmatex">\(\pm x\pm y\sqrt{D}\)</span>；对于 <span class="arithmatex">\(D\equiv 1\pmod 4\)</span>，基本单位数就是 <span class="arithmatex">\(\dfrac{\pm x\pm y\sqrt{D}}{2}\)</span>。</p>
<details class="example">
<summary>示例</summary>
<ol>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-14y^2=\pm 4\)</span>。</p>
<p>利用前文的示例中的计算可知，方程 <span class="arithmatex">\(x^2-14y^2=4\)</span> 的最小正整数解为 <span class="arithmatex">\((30,8)\)</span>，方程 <span class="arithmatex">\(x^2-14y^2=-4\)</span> 无解。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-41y^2=\pm 4\)</span>。</p>
<p>对 <span class="arithmatex">\((P_0,Q_0,D)=(1,2,41)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-16\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{1}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{2}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-8\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{2}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(26\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(45\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(16\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{1}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(37\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(64\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{5}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(211\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(57\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(365\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(16\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(248\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(67\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(429\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-8\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(707\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(191\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1223\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1662\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(449\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2875\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-16\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2369\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(640\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4098\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13507\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3649\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(23365\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-16\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(15876\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4289\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(27463\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=5\)</span> 为奇数。方程 <span class="arithmatex">\(x^2-41y^2=-4\)</span> 的最小正整数解为 <span class="arithmatex">\((G_4,B_4)=(64,10)\)</span>，方程 <span class="arithmatex">\(x^2-41y^2=4\)</span> 的最小正整数解为 <span class="arithmatex">\((G_9,B_9)=(4098,640)\)</span>。它们之间有如下关系：</p>
<div class="arithmatex">\[
\dfrac{4098+640\sqrt{41}}{2} = \left(\dfrac{64+10\sqrt{41}}{2}\right)^2.
\]</div>
<p>当然，因为 <span class="arithmatex">\(D\equiv 1\pmod 8\)</span>，根据前文结论，此时方程 <span class="arithmatex">\(x^2-41y^2=\pm 4\)</span> 的最小正整数解一定都是偶数，且总是方程 <span class="arithmatex">\(x^2-41y^2=\pm 1\)</span> 的最小正整数解的 <span class="arithmatex">\(2\)</span> 倍，所以也可以直接利用前文的示例得出。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-13y^2=\pm 4\)</span>。</p>
<p>对 <span class="arithmatex">\((P_0,Q_0,D)=(1,2,13)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{3}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(23\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(36\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(74\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(33\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(119\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=1\)</span> 为奇数。方程 <span class="arithmatex">\(x^2-13y^2=-4\)</span> 的最小正整数解为 <span class="arithmatex">\((G_0,B_0)=(3,1)\)</span>，方程 <span class="arithmatex">\(x^2-13y^2=4\)</span> 的最小正整数解为 <span class="arithmatex">\((G_1,B_1)=(11,3)\)</span>。</p>
<p>因为该方程的最小正整数解都是奇数，所以可以利用第三个循环节末尾处的数对 <span class="arithmatex">\((G_2,B_2)=(36,10)\)</span> 得到相应的（负）Pell 方程 <span class="arithmatex">\(x^2-13y^2=\pm 1\)</span> 的最小正整数解 <span class="arithmatex">\((18,5)\)</span>。它也可以通过直接计算得到：</p>
<div class="arithmatex">\[
\dfrac{36+10\sqrt{13}}{2}=\left(\dfrac{3+\sqrt{13}}{2}\right)^3.
\]</div>
<p>而且，这是负 Pell 方程的解。相应的 Pell 方程的最小正整数解是 <span class="arithmatex">\((649,180)\)</span>。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-52y^2=\pm 4\)</span>。</p>
<p>因为方程 <span class="arithmatex">\(x^2-13y^2=\pm 1\)</span> 的最小正整数解分别是 <span class="arithmatex">\((18,5)\)</span> 和 <span class="arithmatex">\((649,180)\)</span>，所以方程 <span class="arithmatex">\(x^2-52y^2=\pm 4\)</span> 的最小正整数解分别是 <span class="arithmatex">\((36,10)\)</span> 和 <span class="arithmatex">\((1298,360)\)</span>。</p>
</li>
</ol>
</details>
<h3 id="_4">一般情形<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>最后，讨论广义 Pell 方程的解法。</p>
<p>对于 <span class="arithmatex">\(|N|&lt;\sqrt{D}\)</span> 的情形有一个简单的解法。前文的结论说明方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的解 <span class="arithmatex">\((x,y)\)</span> 一定满足 <span class="arithmatex">\(\dfrac{x}{y}\)</span> 等于 <span class="arithmatex">\(\sqrt{D}\)</span> 的某个渐近分数。而且，根据前文讨论的解的结构可知，每个基础解 <span class="arithmatex">\((x,y)\)</span> 都满足 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 小于等于相应的 Pell 方程 <span class="arithmatex">\(x^2-Dy^2=1\)</span> 的基础解 <span class="arithmatex">\(x_1+y_1\sqrt{D}\)</span>。利用 PQa 算法中分母序列 <span class="arithmatex">\(B_k\)</span> 的单调性可知，广义 Pell 方程的这些基础解一定出现在相应的 Pell 方程的基础解出现之前。由此，只需要对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,D)\)</span> 运行 PQa 算法，直到 <span class="arithmatex">\(Q_{\ell'}=1\)</span> 且 <span class="arithmatex">\(\ell'\)</span> 为偶数时为止，过程中对出现的每个 <span class="arithmatex">\((A_k,B_k)\)</span> 检验是否存在整数 <span class="arithmatex">\(f\)</span> 使得</p>
<div class="arithmatex">\[
A_k^2-DB_k^2 = (-1)^{k+1}Q_{k+1} = N/f^2
\]</div>
<p>成立，如果成立，则记录 <span class="arithmatex">\((fA_{k},fB_{k})\)</span> 是一个最小正整数解。这个过程记录的所有 <span class="arithmatex">\((fA_k,fB_k)\)</span> 就是方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的全部最小正整数解。利用 <span class="arithmatex">\((A_{\ell'-1},B_{\ell'-1})\)</span>，即相应的 Pell 方程的基本解，就可以根据求出的这些最小正整数解，生成广义 Pell 方程的所有解。注意，取决于循环节长度 <span class="arithmatex">\(\ell\)</span> 是偶数还是奇数，上述的 <span class="arithmatex">\(\ell'\)</span> 可能是 <span class="arithmatex">\(\ell\)</span> 或是 <span class="arithmatex">\(2\ell\)</span>。</p>
<p>对于更为一般的 <span class="arithmatex">\(N\)</span> 的情形，上述方法不再适用。首先，枚举 <span class="arithmatex">\(N\)</span> 的所有平方因子 <span class="arithmatex">\(f^2\)</span>，设 <span class="arithmatex">\(m=N/f^2\)</span>，并枚举同余方程 <span class="arithmatex">\(z^2\equiv D\pmod{|m|}\)</span> 的所有满足 <span class="arithmatex">\(-|m|/2&lt;z \le |m|/2\)</span> 的解 <span class="arithmatex">\(z\)</span>。然后，对 <span class="arithmatex">\((P_0,Q_0,D)=(z,|m|,D)\)</span> 运行 PQa 算法，直到 <span class="arithmatex">\(Q_k=\pm 1\)</span> 或已经结束了一个循环节。在第二种情形，那么与该组 <span class="arithmatex">\((f,z)\)</span> 相关的方程的解并不存在。在第一种情形，需要进一步判断 <span class="arithmatex">\((-1)^kQ_k=N/|N|\)</span> 与否。如果符号一致，那么 <span class="arithmatex">\((fG_{k-1},fB_{k-1})\)</span> 就是方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的解。否则，它是方程 <span class="arithmatex">\(x^2-Dy^2=-N\)</span> 的解，而且当且仅当相应的负 Pell 方程的解存在时，才可以通过复合它与相应的负 Pell 方程的基本解来得到方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 的解。当完成对所有组 <span class="arithmatex">\((f,z)\)</span> 的遍历之后，就可以得到方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 在每个解的等价类中各恰好一个解，且该解为该等价类中的基本解或最小正整数解。利用它们和相应的 Pell 方程的基本解，可以生成该方程的所有整数解。这一算法称为 <strong>Lagrange–Matthews–Mollin 算法</strong>。</p>
<p>该算法的正确性由如下定理保证：</p>
<details class="note" open="open">
<summary>定理</summary>
<p>设方程 <span class="arithmatex">\(x^2-Dy^2=N\)</span> 有整数解 <span class="arithmatex">\((x,y)\)</span> 且 <span class="arithmatex">\(x\ge 0, y&gt;0,\gcd(x,y)=1\)</span>。令 <span class="arithmatex">\(Q_0=|N|\)</span>，则 <span class="arithmatex">\(\gcd(Q_0,y)=1\)</span>。设 <span class="arithmatex">\(P_0\)</span> 是同余方程 <span class="arithmatex">\(x\equiv -P_0y\pmod{Q_0}\)</span> 的解且 <span class="arithmatex">\(-Q_0/2&lt;P_0\le Q_0/2\)</span>，并设整数 <span class="arithmatex">\(X\)</span> 使得 <span class="arithmatex">\(x=Q_0X-P_0y\)</span> 成立。那么，<span class="arithmatex">\(P_0^2\equiv D\pmod{Q_0}\)</span>，<span class="arithmatex">\(\dfrac{X}{y}\)</span> 是 <span class="arithmatex">\(\omega=\dfrac{P_0+\sqrt{D}}{Q_0}\)</span> 的一个渐近分数 <span class="arithmatex">\(\dfrac{A_{k-1}}{B_{k-1}}\)</span>，且 <span class="arithmatex">\(Q_k=(-1)^k\dfrac{N}{|N|}\)</span>。</p>
</details>
<details class="note">
<summary>证明</summary>
<p>利用 <span class="arithmatex">\(x\equiv -P_0y\pmod{Q_0}\)</span> 和 <span class="arithmatex">\(x^2-Dy^2=N\equiv 0\pmod{Q_0}\)</span>，显然有 <span class="arithmatex">\(P_0^2\equiv D\pmod{Q_0}\)</span>。因而，</p>
<div class="arithmatex">\[
P_0x+Dy\equiv -P_0^2y+Dy = (D-P_0^2)y\equiv 0\pmod{Q_0}.
\]</div>
<p>由此，可以考察整系数矩阵</p>
<div class="arithmatex">\[
\begin{pmatrix}P &amp; R \\ Q &amp; S\end{pmatrix}
=
\begin{pmatrix}X &amp; \dfrac{P_0x+Dy}{Q_0} \\ y &amp; x\end{pmatrix}.
\]</div>
<p>它的行列式</p>
<div class="arithmatex">\[
PS-QR = \dfrac{x(x+P_0y)-y(P_0x+Dy)}{Q_0} = \dfrac{x^2-Dy^2}{Q_0} = \pm 1.
\]</div>
<p>而且，设 <span class="arithmatex">\(\zeta =\sqrt{D} &gt; 1\)</span>，就有</p>
<div class="arithmatex">\[
\dfrac{P\zeta+R}{Q\zeta+S} = \dfrac{(x+P_0y)\sqrt{D}+(P_0x+Dy)}{(x+y\sqrt{D})Q_0} = \dfrac{P_0+\sqrt{D}}{Q_0} = \omega.
\]</div>
<p>下面要证明 <span class="arithmatex">\(\dfrac{P}{Q}\)</span> 是 <span class="arithmatex">\(\omega\)</span> 的一个渐近分数。不妨设 <span class="arithmatex">\(\dfrac{P}{Q}\)</span> 有 <a href="../continued-fraction/#简单连分数">连分数展开</a></p>
<div class="arithmatex">\[
\dfrac{P}{Q} = [a_0,a_1,\cdots,a_k]
\]</div>
<p>且 <span class="arithmatex">\(PS-QR = (-1)^{k-1}\)</span>。如果设 <span class="arithmatex">\(\dfrac{p_k}{q_k}\)</span> 是它的第 <span class="arithmatex">\(k\)</span> 个渐近分数，那么 <span class="arithmatex">\((p_k,q_k)=(P,Q)\)</span>，且根据 <a href="../continued-fraction/#误差估计">渐近分数的差分公式</a> 可知，<span class="arithmatex">\(p_kq_{k-1}-q_kp_{k-1}=(-1)^{k-1}\)</span>。这说明</p>
<div class="arithmatex">\[
p_k(S-q_{k-1}) = q_k(R-p_{k-1}).
\]</div>
<p>分情况讨论：</p>
<ul>
<li>如果 <span class="arithmatex">\(S=0\)</span>，那么容易验证 <span class="arithmatex">\(Q=R=1\)</span>，因而 <span class="arithmatex">\(\omega=P+\zeta^{-1}=[P,\zeta]\)</span>，故而 <span class="arithmatex">\(\dfrac{P}{Q}=P\)</span> 是 <span class="arithmatex">\(\omega\)</span> 的第 <span class="arithmatex">\(0\)</span> 个渐近分数；</li>
<li>如果 <span class="arithmatex">\(Q=S&gt;0\)</span>，那么 <span class="arithmatex">\(Q=S=1\)</span> 且 <span class="arithmatex">\(P-R=\pm 1\)</span>。此时，<ul>
<li>如果 <span class="arithmatex">\(P=R+1\)</span>，那么 <span class="arithmatex">\(\omega=R+\dfrac{1}{1+\zeta^{-1}}=[R,1,\zeta]\)</span>，故而 <span class="arithmatex">\(\dfrac{P}{Q}=\dfrac{R+1}{1}=[R,1]\)</span> 是 <span class="arithmatex">\(\omega\)</span> 的第 <span class="arithmatex">\(1\)</span> 个渐近分数；</li>
<li>如果 <span class="arithmatex">\(P=R-1\)</span>，那么 <span class="arithmatex">\(\omega=R-1+\dfrac{1}{1+\zeta}=[R-1,\zeta-1]\)</span>，故而 <span class="arithmatex">\(\dfrac{P}{Q}=R-1\)</span> 是 <span class="arithmatex">\(\omega\)</span> 的第 <span class="arithmatex">\(0\)</span> 个渐近分数；</li>
</ul>
</li>
<li>如果 <span class="arithmatex">\(Q\neq S&gt;0\)</span>，那么由于 <span class="arithmatex">\(Q=q_k\mid(S-q_{k-1})\)</span>，总存在整数 <span class="arithmatex">\(\kappa\)</span> 使得 <span class="arithmatex">\(S=\kappa q_k+q_{k-1}\)</span> 和 <span class="arithmatex">\(R=\kappa p_k+p_{k-1}\)</span> 成立。因为 <span class="arithmatex">\(q_k\ge q_{k-1}\)</span> 且 <span class="arithmatex">\(S&gt;0\)</span>，所以 <span class="arithmatex">\(\kappa\ge 0\)</span>。因而，<span class="arithmatex">\(\omega=\dfrac{(\kappa+\zeta)p_k+p_{k-1}}{(\kappa+\zeta)q_k+q_{k-1}}=[a_0,a_1,\cdots,a_k,\kappa+\zeta]\)</span>，故而 <span class="arithmatex">\(\dfrac{P}{Q}\)</span> 是它的第 <span class="arithmatex">\(k\)</span> 个渐近分数。</li>
</ul>
<p>综上所述，总有 <span class="arithmatex">\(\dfrac{X}{y}\)</span> 是 <span class="arithmatex">\(\omega=\dfrac{P_0+\sqrt{D}}{Q_0}\)</span> 的渐近分数，并按照 PQa 算法中的记号记作 <span class="arithmatex">\(\dfrac{A_{k-1}}{B_{k-1}}\)</span>。因为 <span class="arithmatex">\(A_{k-1}^2-DB_{k-1}^2=(-1)^kQ_0Q_k\)</span>，所以 <span class="arithmatex">\(Q_k=(-1)^k\dfrac{N}{|N|}\)</span>。</p>
</details>
<p>该定理保证了方程的所有正解都存在于相应的二次无理数的渐近分数中。因为利用 PQa 算法计算渐近分数时，只要进入循环节，就一定能保证渐近分数总是正的。所以，只要枚举所有定理条件所允许的二次无理数，计算它的渐近分数直到一个循环节内，就能够找到一个解。因为在同一个二次无理数的渐近分数中出现的两个解，一定是等价的，所以只要得到第一个满足 <span class="arithmatex">\((-1)^kQ_k=N/|N|\)</span> 的解，就可以停止继续后面的计算。与前面的所有算法都不同的是，此处满足条件的 <span class="arithmatex">\(k\)</span> 可能出现在尚未进入循环节时。</p>
<details class="example">
<summary>示例</summary>
<ol>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-157y^2=12\)</span>。</p>
<p>因为 <span class="arithmatex">\(12^2&lt;157\)</span>，所以对 <span class="arithmatex">\((P_0,Q_0,D)=(0,1,157)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-13\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(25\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(25\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-3\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(188\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(15\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(188\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(213\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(17\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(213\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1253\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(100\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1253\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2719\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(217\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2719\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3972\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(317\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3972\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6691\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(534\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6691\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-11\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(851\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(17354\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1385\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(17354\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-9\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(45371\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3621\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(45371\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(244209\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19490\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(244209\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-19\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(289580\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(23111\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(289580\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(14\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2271269\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(181267\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2271269\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(15\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2560849\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(204378\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2560849\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(16\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4832118\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(385645\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4832118\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(17\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}{24}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(118531681\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9459858\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(118531681\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(18\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(123363799\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9845503\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(123363799\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(241895480\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19305361\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(241895480\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(20\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1816632159\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(144983030\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1816632159\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-19\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(21\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2058527639\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(164288391\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2058527639\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(22\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12109270354\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(966424985\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12109270354\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-9\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(23\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(26277068347\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2097138361\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(26277068347\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(24\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(38386338701\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3063563346\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(38386338701\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-11\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(25\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(64663407048\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5160701707\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(64663407048\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(26\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(103049745749\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8224265053\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(103049745749\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(27\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(167713152797\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13384966760\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(167713152797\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(28\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(438476051343\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(34994198573\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(438476051343\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-4\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(29\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2360093409512\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(188355959625\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2360093409512\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(30\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2798569460855\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(223350158198\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2798569460855\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-3\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(31\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(21950079635497\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1751807067011\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(21950079635497\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(32\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(11\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(24748649096352\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1975157225209\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(24748649096352\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-13\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(33\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46698728731849\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3726964292220\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46698728731849\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(34\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(24\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1145518138660728\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(91422300238489\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1145518138660728\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-13\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(35\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1192216867392577\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(95149264530709\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1192216867392577\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=17\)</span> 为奇数，所以需要考察两个循环节内 <span class="arithmatex">\(G_{k-1}^2-157B_{k-1}^2\)</span> 与 <span class="arithmatex">\(12\)</span> 相差一个平方因子的情形，即 <span class="arithmatex">\(k=1,9,13,19,23,31\)</span> 的情形。它们对应的解就是下表中的 <span class="arithmatex">\((fG,fB)\)</span>：</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(f\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(fG_{k-1}\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(fB_{k-1}\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(x\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(y\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(851\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(851\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(579160\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46222\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(579160\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46222\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(19\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(483790960\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(38610722\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-579160\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46222\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(23\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(26277068347\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2097138361\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(851\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(31\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(21950079635497\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1751807067011\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
</tbody>
</table>
<p>全体 <span class="arithmatex">\((fG,fB)\)</span> 就是方程 <span class="arithmatex">\(x^2-157y^2=12\)</span> 的解集的所有等价类中的最小正整数解。要通过这些解得到全部解，可以利用相应的 Pell 方程的基本解 <span class="arithmatex">\((46698728731849,3726964292220)\)</span>。比如说，可以将它们转化为该等价类中的基本解 <span class="arithmatex">\((x,y)\)</span>，相应的解也一并列于上表中。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-157y^2=12\)</span>。</p>
<p>这次利用 Lagrange–Matthews–Mollin 算法求解。首先，枚举 <span class="arithmatex">\(N=12\)</span> 的平方因子：</p>
<ul>
<li><span class="arithmatex">\(f^2=1^2\)</span> 时，有 <span class="arithmatex">\(m=12\)</span>，同余方程 <span class="arithmatex">\(P^2\equiv 157\pmod{12}\)</span> 有解 <span class="arithmatex">\(z=\pm 1,\pm 5\)</span>；</li>
<li><span class="arithmatex">\(f^2=2^2\)</span> 时，有 <span class="arithmatex">\(m=3\)</span>，同余方程 <span class="arithmatex">\(P^2\equiv 157\pmod{3}\)</span> 有解 <span class="arithmatex">\(z=\pm 1\)</span>。</li>
</ul>
<p>对于所有可能的 <span class="arithmatex">\((f,z)\)</span> 组合运行初始参数为 <span class="arithmatex">\((P_0,Q_0,D)=(z,|m|,D)\)</span> 的 PQa 算法，并找到首个 <span class="arithmatex">\((-1)^kQ_k=1\)</span> 的位置，对应的 <span class="arithmatex">\((fG_{k-1},fB_{k-1})\)</span> 就是一组解。结果如下表所示：</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(f\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(z\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(m\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(fG_{k-1}\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(fB_{k-1}\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(32\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(21950079635497\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1751807067011\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(24\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(26277068347\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2097138361\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10663\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(851\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(20\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(483790960\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(38610722\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(14\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(579160\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(46222\)</span></td>
</tr>
</tbody>
</table>
<p>这就是前文列举的所有等价类中的最小正整数解，可以利用 Pell 方程的基本解将它们转化为基本解。</p>
</li>
<li>
<p>求解方程 <span class="arithmatex">\(x^2-79y^2=\pm 101\)</span>。</p>
<p>仍然使用 Lagrange–Matthews–Mollin 算法求解。因为 <span class="arithmatex">\(N=101\)</span> 是素数，所以一定有 <span class="arithmatex">\(f=1\)</span>。此时，<span class="arithmatex">\(m=101\)</span>，相应的同余方程 <span class="arithmatex">\(P^2\equiv 79\pmod{101}\)</span> 有解 <span class="arithmatex">\(P=\pm 33\)</span>。</p>
<p>对 <span class="arithmatex">\((P_0,Q_0,D)=(33,101,79)\)</span> 运行 PQa 算法结果如下：（标红部分为第一个循环节）</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(k\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(P\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(Q\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(a\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(A\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(B\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(G^2-DB^2\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(33\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(101\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(0\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-33\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1010\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-33\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(35\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(909\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(13\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(37\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-606\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(12\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(109\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(505\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(17\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(41\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(364\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-303\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(90\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(217\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1929\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1010\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(10\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(107\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(258\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2293\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-707\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(3\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(7\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(197\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(475\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4222\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(909\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(8\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(4\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(\color{red}1\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(304\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(733\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6515\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(-606\)</span></td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(9\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(5\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(6\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(2\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(805\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(1941\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(17252\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(505\)</span></td>
</tr>
</tbody>
</table>
<p>循环节长度 <span class="arithmatex">\(\ell=6\)</span> 为偶数。直到一个循环节结束，都不存在 <span class="arithmatex">\(Q_k=\pm 1\)</span>，因而，该情形无解。相应地，对于 <span class="arithmatex">\((P_0,Q_0,D)=(-33,101,79)\)</span> 运行 PQa 算法也可以观察到类似的情况。因此，该方程无解。</p>
</li>
</ol>
</details>
<h2 id="_5">习题<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://loj.ac/p/6687">LOJ 6687.「Project Euler 66」解方程</a></li>
<li><a href="https://www.spoj.com/problems/EQU2/">SPOJ EQU2 - Yet Another Equation</a></li>
<li><a href="https://www.spoj.com/problems/PELL2/">SPOJ PELL2 - Pell (Mid pelling)</a></li>
<li><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=862&amp;page=show_problem&amp;problem=4774">UVa 12909. Numeric Center</a></li>
<li><a href="https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=14&amp;page=show_problem&amp;problem=1182">UVa 10241. Semi-triangular and also Square</a></li>
</ul>
<h2 id="_6">参考文献与注释<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Pell%27s_equation">Pell's equation - Wikipedia</a></li>
<li><a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=5ac34a344ee346855184ff949eeaed18685b155c">John P. Robertson - Solving the generalized Pell equation <span class="arithmatex">\(x^2-Dy^2=N\)</span></a></li>
<li><a href="http://www.numbertheory.org/PDFS/patz5.pdf">Keith Matthews - The Diophantine Equation <span class="arithmatex">\(x^2-Dy^2=N\)</span>,<span class="arithmatex">\(D&gt;0\)</span></a></li>
<li><a href="https://surya-teja.com/2011/01/11/existence-of-solution-to-pells-equation/">Existence of Solution to Pell’s Equation - Suryateja Gavva's Blog</a></li>
<li><a href="http://www.numbertheory.org/php/surd.html">Calculating the simple continued fraction of a quadratic irrational - Number Theory Web</a>（PQa 算法）</li>
<li><a href="http://www.numbertheory.org/php/patz.html">Solving the diophantine equation x2–Dy2 = N, D &gt; 0 and not a perfect square, N ≠ 0 - Number Theory Web</a>（Lagrange–Matthews–Mollin 算法）</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:not-square">
<p>当 <span class="arithmatex">\(D\)</span> 是完全平方数时，直接做因式分解可知，<span class="arithmatex">\((x+y\sqrt{D})(x-y\sqrt{D})=N\)</span>，因此所有解可以通过遍历 <span class="arithmatex">\(N\)</span> 的因数得知。特别地，当 <span class="arithmatex">\(N=1\)</span> 时，方程只有解 <span class="arithmatex">\((\pm 1,0)\)</span>；当 <span class="arithmatex">\(N=-1\)</span> 且 <span class="arithmatex">\(D\neq 1\)</span> 时，方程没有解。&#160;<a class="footnote-backref" href="#fnref:not-square" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:neg-pell">
<p>有些中文文献也称它为第二型 Pell 方程。&#160;<a class="footnote-backref" href="#fnref:neg-pell" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:half-int">
<p>即形如 <span class="arithmatex">\(n+\dfrac12\)</span> 且 <span class="arithmatex">\(n\in\mathbf Z\)</span> 的有理数。&#160;<a class="footnote-backref" href="#fnref:half-int" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:fundamental-solution">
<p>注意，Pell 方程中基本解的定义与实二次整数环中的基本单位数的定义并不一致。首先，部分实二次整数环中的基本单位数 <span class="arithmatex">\(x+y\sqrt{D}\)</span> 中的 <span class="arithmatex">\(x,y\)</span> 是半整数，因而并非 Pell 方程的解。其次，同一个实二次整数环的基本单位数有四个，但是基本解只有一个，因为基本解要求 <span class="arithmatex">\(x,y\)</span> 都是正数。&#160;<a class="footnote-backref" href="#fnref:fundamental-solution" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:solubility-neg-pell">
<p>一个较为实用的判断方法和工具在 <a href="http://www.numbertheory.org/php/hardy_williams.html">这里</a> 及其参考文献。使得方程 <span class="arithmatex">\(x^2-Dy^2=-1\)</span> 有解的正整数 <span class="arithmatex">\(D\)</span> 的列表是 <a href="https://oeis.org/A031396">OEIS A031396</a>。&#160;<a class="footnote-backref" href="#fnref:solubility-neg-pell" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->


<!-- Source file information -->

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        此页面有帮助吗？
      </legend>
      <div class="md-feedback__inner">

        <!-- Feedback ratings -->
        <div class="md-feedback__list">
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page was helpful"
              data-md-value="1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page could be improved"
              data-md-value="0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>

        <!-- Feedback rating notes (shown after submission) -->
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              谢谢你的反馈！
            </div>
          
            <div data-md-value="0" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              Thanks for your feedback! Help us improve this page by using our <a href="https://marketingplatform.google.com/about/analytics/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Comment system -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <style>
  .md-footer {
      background-color: #f0f0f0;
  }
</style>


<!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; gzh
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
   
      <font color="#B9B9B9">
      <div class="footer-visit-count" style="display: flex; justify-content: center; align-items: center;color: #000;">
        本站访问量：<script async src="//finicounter.eu.org/finicounter.js"></script>
        <span id="finicount_views"></span>    &nbsp;|&nbsp;
        <footer>
          <a href="https://icp.gov.moe/?keyword=20230640" target="_blank">萌ICP备20230640号</a>
        </footer>
      </div>
      </font>

        <style>
          .footer-visit-count {
              height: fit-content;
              min-height: 55px; /* 根据实际情况调整此高度 */
              color: #000;
          }
          </style>
        
          <div class="md-social">
  
    
    
    
    
    <a href="https://cdn.jsdelivr.net/gh/Gongzihang6/Pictures@main/Medias/%E6%88%91%E7%9A%84%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81.png" target="_blank" rel="noopener" title="Wechat" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
    
    
    
    
    <a href="https://t.me/gongzihang" target="_blank" rel="noopener" title="telegram" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ZihangGong28792" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Gongzihang6" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<zihanggong24@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/688234000/lists" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
</div>
        
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>我们也使用cookies来识别您的重复访问和偏好来衡量我们文档的有效性以及用户是否找到他们要找的东西。 如果你同意,你可以帮助我们让我们的网站更好</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">同意</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">管理设定</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../../..", "features": ["announce.dismiss", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../../../../javascripts/extra.js"></script>
      
        <script src="../../../../../../../javascripts/config_mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../../../../javascripts/简历.js"></script>
      
    
  </body>
</html>