
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="记录、分享">
      
      
        <meta name="author" content="gzh">
      
      
        <link rel="canonical" href="https://gongzihang6.github.io/blog/%E9%9A%8F%E7%AC%94/%E7%A7%91%E7%A0%94/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/swin3d/">
      
      
        <link rel="prev" href="../PointMamba/">
      
      
        <link rel="next" href="../../../%E4%BC%98%E5%8C%96/Levenberg-Marquardt%E7%AE%97%E6%B3%95/">
      
      
        
          <link rel="alternate" href="/" hreflang="zh">
        
          <link rel="alternate" href="/Mkdocs-Wcowin/en/" hreflang="en">
        
          <link rel="alternate" href="/Mkdocs-Wcowin/ZH-TW/" hreflang="zh-TW">
        
      
      
      <link rel="icon" href="https://s2.loli.net/2025/02/12/aE5ovtzAlNTd9Uh.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Swin3d - Blog of GZH</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/简历.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/link.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/customize.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Klee+One&family=LXGW+WenKai+TC&display=swap">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600&display=swap">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/light.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/material.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/shift-away.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/scale.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/backdrop.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/tippy/tippy.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/core/core.css">
    
      <link rel="stylesheet" href="../../../../../assets/document_dates/user.config.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-40HC6RYSR1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-40HC6RYSR1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-40HC6RYSR1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#swin3d-a-pretrained-transformer-backbone" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="Blog of GZH" class="md-header__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Blog of GZH
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Swin3d
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭自动模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭自动模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M160 0c17.7 0 32 14.3 32 32v32h128c17.7 0 32 14.3 32 32s-14.3 32-32 32h-9.6l-8.4 23.1c-16.4 45.2-41.1 86.5-72.2 122 14.2 8.8 29 16.6 44.4 23.5l50.4 22.4 62.2-140c5.1-11.6 16.6-19 29.2-19s24.1 7.4 29.2 19l128 288c7.2 16.2-.1 35.1-16.2 42.2s-35.1-.1-42.2-16.2l-20-45H337.3l-20 45c-7.2 16.2-26.1 23.4-42.2 16.2s-23.4-26.1-16.2-42.2l39.8-89.5-50.4-22.4c-23-10.2-45-22.4-65.8-36.4-21.3 17.2-44.6 32.2-69.5 44.7l-34.7 17.2c-15.8 7.9-35 1.5-42.9-14.3s-1.5-35 14.3-42.9l34.5-17.3c16.3-8.2 31.8-17.7 46.4-28.3-13.8-12.7-26.8-26.4-38.9-40.9l-10.1-12.2c-11.3-13.6-9.5-33.8 4.1-45.1s33.8-9.5 45.1 4.1l10.2 12.2c11.5 13.9 24.1 26.8 37.4 38.7 27.5-30.4 49.2-66.1 63.5-105.4l.5-1.2H32.1C14.3 128 0 113.7 0 96s14.3-32 32-32h96V32c0-17.7 14.3-32 32-32m256 270.8L365.7 384h100.6z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Mkdocs-Wcowin/ZH-TW/" hreflang="zh-TW" class="md-select__link">
              China(TW)
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Computer%20Science/java%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
  
    
  
  Computer Science

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-tabs__link">
          
  
  
    
  
  MachineLearning

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../%E6%91%84%E5%83%8F%E6%9C%BA%E6%88%90%E5%83%8F%E6%A8%A1%E5%9E%8B/" class="md-tabs__link">
          
  
  
    
  
  随笔

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-tabs__link">
          
  
  
    
  
  每日诗词

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E5%8F%91%E7%96%AF/" class="md-tabs__link">
          
  
  
    
  
  发疯

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../about/fitness/" class="md-tabs__link">
          
  
  
    
  
  长期主义

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../about/geren/" class="md-tabs__link">
          
  
  
    
  
  关于

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Blog of GZH" class="md-nav__button md-logo" aria-label="Blog of GZH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    Blog of GZH
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Gongzihang6" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Gongzihang6
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    主页
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Computer Science
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Computer Science
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Java
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Java
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/java%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Java面向对象基础
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/%E5%B8%B8%E7%94%A8API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Java集合框架与常用API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/java%E6%8F%90%E9%AB%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Java提高
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/JavaStream%E6%B5%81%E5%BC%8F%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JavaStream流式处理方法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Algorithm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Algorithm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    并查集
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    并查集
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/Algorithm/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/ds/%E5%B9%B6%E6%9F%A5%E9%9B%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    并查集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/Algorithm/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/ds/dsu-complexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dsu complexity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    排序和查找
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LeetCode周赛系列
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    LeetCode周赛系列
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E5%91%A8%E8%B5%9B%E7%B3%BB%E5%88%97/%E7%AC%AC467%E5%9C%BA%E5%91%A8%E8%B5%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第467场周赛
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E5%91%A8%E8%B5%9B%E7%B3%BB%E5%88%97/%E7%AC%AC468%E5%9C%BA%E5%91%A8%E8%B5%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第468场周赛
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LeetCode热题100
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    LeetCode热题100
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E5%AD%97%E6%AF%8D%E5%BC%82%E4%BD%8D%E8%AF%8D%E5%88%86%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    字母异位词分组
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E6%9C%80%E9%95%BF%E8%BF%9E%E7%BB%AD%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最长连续序列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E7%A7%BB%E5%8A%A8%E9%9B%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    移动零
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E7%9B%9B%E6%B0%B4%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%B9%E5%99%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    盛水最多的容器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    三数之和
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    无重复字符的最长子串
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E5%92%8C%E4%B8%BAK%E7%9A%84%E5%AD%90%E6%95%B0%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    和为K的子数组
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E5%90%88%E5%B9%B6%E5%8C%BA%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    合并区间
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E7%9F%A9%E9%98%B5%E7%BD%AE%E9%9B%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    矩阵置零
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    螺旋矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode%E7%83%AD%E9%A2%98100/%E6%97%8B%E8%BD%AC%E5%9B%BE%E5%83%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    旋转图像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LeetCode
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    LeetCode
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E4%BA%A4%E6%98%93%E9%80%86%E5%BA%8F%E5%AF%B9%E7%9A%84%E6%80%BB%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    交易逆序对的总数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%8D%95%E8%AF%8D%E6%8E%A5%E9%BE%99/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    单词接龙
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%B2%9B%E5%B1%BF%E6%95%B0%E9%87%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    岛屿数量
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%88%86%E8%80%83%E5%9C%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    分考场
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E6%8B%89%E9%A9%AC%E8%BD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    拉马车
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%88%86%E5%B7%A7%E5%85%8B%E5%8A%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    分巧克力
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/k%E5%80%8D%E5%8C%BA%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K倍区间
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    编辑距离
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E6%8E%A5%E9%9B%A8%E6%B0%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    接雨水
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E7%BB%84%E5%90%88%E6%80%BB%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    组合总和
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%85%A8%E6%8E%92%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    全排列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    乘积最大子数组
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最长回文子串
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%89%8DK%E4%B8%AA%E9%AB%98%E9%A2%91%E5%85%83%E7%B4%A0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    前K个高频元素
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E6%9C%80%E5%B0%8F%E6%A0%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    最小栈
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/Pow%28x%2Cn%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pow(x,n)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F%E6%97%B6%E9%97%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    网络延迟时间
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E8%AE%A1%E7%AE%97%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    计算质数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E5%AF%B9%E8%A7%92%E7%BA%BF%E4%B8%8A%E7%9A%84%E8%B4%A8%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    对角线上的质数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    零钱兑换
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/01%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    01矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    二分查找
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/%E6%8B%AC%E5%8F%B7%E5%8C%B9%E9%85%8D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    括号匹配
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/300%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    300最长递增子序列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/115%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    115不同的子序列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/712%E4%B8%A4%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%8FASCII%E5%88%A0%E9%99%A4%E5%92%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    712两个字符串的最小ASCII删除和
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/516%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    516最长回文子序列
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/139%E5%8D%95%E8%AF%8D%E6%8B%86%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    139单词拆分
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/221%E6%9C%80%E5%A4%A7%E6%AD%A3%E6%96%B9%E5%BD%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    221最大正方形
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2845%E7%BB%9F%E8%AE%A1%E8%B6%A3%E5%91%B3%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2845统计趣味子数组的数目
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2799%E7%BB%9F%E8%AE%A1%E5%AE%8C%E5%85%A8%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2799统计完全子数组的数目
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/1399%E7%BB%9F%E8%AE%A1%E6%9C%80%E5%A4%A7%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1399统计最大组的数目
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2338%E7%BB%9F%E8%AE%A1%E7%90%86%E6%83%B3%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2338统计理想数组的数目
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2179%E7%BB%9F%E8%AE%A1%E6%95%B0%E7%BB%84%E4%B8%AD%E5%A5%BD%E4%B8%89%E5%85%83%E7%BB%84%E6%95%B0%E7%9B%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2179统计数组中好三元组数目
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2537%E7%BB%9F%E8%AE%A1%E5%A5%BD%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2537统计好子数组的数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2140%E8%A7%A3%E5%86%B3%E6%99%BA%E5%8A%9B%E9%97%AE%E9%A2%98/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2140解决智力问题
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Computer%20Science/LeetCode/2278%E5%AD%97%E6%AF%8D%E5%9C%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E7%99%BE%E5%88%86%E6%AF%94/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2278字母在字符串中的百分比
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MachineLearning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    MachineLearning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/K%E8%BF%91%E9%82%BB%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%99%8D%E7%BB%B4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K近邻学习与降维
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E5%A4%9A%E5%88%86%E7%B1%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模型评估与多分类
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/%E5%85%AC%E5%BC%8F%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    公式测试
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/%E7%BB%8F%E5%85%B8%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    经典卷积神经网络
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/%E7%90%86%E8%A7%A3YOLO%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    理解YOLO网络结构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/关联分析.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/支持向量机SVM.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../MachineLearning/聚类算法.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    随笔
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    随笔
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    科研
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    科研
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%91%84%E5%83%8F%E6%9C%BA%E6%88%90%E5%83%8F%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    摄像机成像模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%B1%82%E8%A7%A3%E4%B8%A4%E4%B8%AA%E5%9D%90%E6%A0%87%E7%B3%BB%E7%9A%84%E7%9B%B8%E5%AF%B9%E6%97%8B%E8%BD%AC%E5%92%8C%E5%B9%B3%E7%A7%BB%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    求解两个坐标系的相对旋转和平移矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%9A%E7%9B%B8%E6%9C%BA%E5%90%8C%E6%AD%A5%E9%87%87%E9%9B%86%E6%95%B0%E6%8D%AE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    多相机同步采集数据
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PCL%E5%BA%93%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PCL库总结
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    文献阅读
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    文献阅读
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PointMamba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PointMamba
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Swin3d
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    优化
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    优化
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%BC%98%E5%8C%96/Levenberg-Marquardt%E7%AE%97%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Levenberg Marquardt算法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../latex%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Latex入门学习
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Matlab%E5%9F%BA%E7%A1%80%E9%80%9F%E6%88%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Matlab基础速成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Matlab%E8%BF%9B%E9%98%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Matlab进阶
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Py-Markdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Py Markdown
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ssh_gitlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ssh gitlab
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../2024%E5%B9%B4%E7%A7%8B%E6%8B%9B-%E5%B0%8F%E7%B1%B3%E9%9B%86%E5%9B%A2-%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%B2%97-%E7%AC%AC%E4%B8%80%E6%89%B9%E7%AC%94%E8%AF%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024年秋招 小米集团 软件开发岗 第一批笔试
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../随笔/cmd_powershell_bash.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../随笔/正则表达式.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%AF%B9%E6%B3%A8%E8%A7%A3Autowired%E7%9A%84%E7%90%86%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    对注解Autowired的理解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../http%E7%8A%B6%E6%80%81%E7%A0%81%E5%90%AB%E4%B9%89%E4%BB%A5%E5%8F%8A%E5%AF%B9%E5%BA%94%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Http状态码含义以及对应解决方案
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../element-plus%E7%BB%84%E4%BB%B6%E7%90%86%E8%A7%A3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Element plus组件理解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SpringBoot%E6%B3%A8%E8%A7%A3%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpringBoot注解总结
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HTTP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HTTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA%E6%8A%80%E6%9C%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    会话跟踪技术
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Spring-Security%E7%99%BB%E5%BD%95%E6%A0%A1%E9%AA%8C%E6%9C%BA%E5%88%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spring Security登录校验机制
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SQL%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E4%B8%8E%E8%BF%9E%E6%8E%A5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL外键约束与连接
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Element-Plus%E7%BB%84%E4%BB%B6%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Element Plus组件详细介绍
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SpringAOP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpringAOP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mermaid%E7%BB%98%E5%9B%BE%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mermaid绘图语法总结
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SpringBoot%E5%8E%9F%E7%90%86%E7%AF%87/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpringBoot原理篇
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../JavaHttpServeletRequest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JavaHttpServeletRequest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    正则表达式
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    每日诗词
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    每日诗词
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E7%8E%89%E9%98%91%E5%B9%B2%E5%A4%96%E6%B8%85%E6%B1%9F%E6%B5%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    虞美人·玉阑干外清江浦
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%8F%A9%E8%90%A8%E8%9B%AE%C2%B7%E5%9B%9E%E6%96%87%E5%A4%8F%E9%97%BA%E6%80%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    菩萨蛮·回文夏闺怨
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B8%85%E5%B9%B3%E4%B9%90%C2%B7%E5%85%AD%E7%9B%98%E5%B1%B1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    清平乐·六盘山
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B4%9E%E4%BB%99%E6%AD%8C%C2%B7%E5%92%8F%E6%9F%B3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    洞仙歌·咏柳
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E7%A7%8B%E5%85%B4%E5%85%AB%E9%A6%96%C2%B7%E5%85%B6%E4%B8%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    秋兴八首·其一
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%8E%E5%8F%B2%E9%83%8E%E4%B8%AD%E9%92%A6%E5%90%AC%E9%BB%84%E9%B9%A4%E6%A5%BC%E4%B8%8A%E5%90%B9%E7%AC%9B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    与史郎中钦听黄鹤楼上吹笛
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%A4%8F%E6%97%A5%E5%8D%97%E4%BA%AD%E6%80%80%E8%BE%9B%E5%A4%A7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    夏日南亭怀辛大
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%A1%8C%E9%A6%99%E5%AD%90%C2%B7%E7%A7%8B%E4%B8%8E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    行香子·秋与
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%87%AA%E9%A2%98%E9%87%91%E5%B1%B1%E7%94%BB%E5%83%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    自题金山画像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%80%E5%89%AA%E6%A2%85%C2%B7%E7%BA%A2%E8%97%95%E9%A6%99%E6%AE%8B%E7%8E%89%E7%B0%9F%E7%A7%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    一剪梅·红藕香残玉簟秋
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%88%9D%E5%88%B0%E9%BB%84%E5%B7%9E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    初到黄州
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E9%9B%A8%E9%9C%96%E9%93%83%C2%B7%E5%AF%92%E8%9D%89%E5%87%84%E5%88%87/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    雨霖铃·寒蝉凄切
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E7%A0%B4%E9%98%B5%E5%AD%90%C2%B7%E5%9B%9B%E5%8D%81%E5%B9%B4%E6%9D%A5%E5%AE%B6%E5%9B%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    破阵子·四十年来家国
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%98%A5%E6%97%A5%E9%86%89%E8%B5%B7%E8%A8%80%E5%BF%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    春日醉起言志
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%B3%A8%E7%9C%89%E5%B1%B1%E6%9C%88%E6%AD%8C%E9%80%81%E8%9C%80%E5%83%A7%E6%99%8F%E5%85%A5%E4%B8%AD%E4%BA%AC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    峨眉山月歌送蜀僧晏入中京
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%89%E4%BA%94%E4%B8%83%E8%A8%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    三五七言
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%9C%A8%E5%85%B0%E8%8A%B1%C2%B7%E6%8B%9F%E5%8F%A4%E5%86%B3%E7%BB%9D%E8%AF%8D%E6%9F%AC%E5%8F%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    木兰花·拟古决绝词柬友
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%A1%83%E8%8A%B1%E5%BA%B5%E6%AD%8C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    桃花庵歌
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B8%94%E5%AE%B6%E5%82%B2%C2%B7%E5%8F%8D%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%A4%A7%E5%9B%B4%E5%89%BF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    渔家傲·反第一次大围剿
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E9%9D%92%E7%8E%89%E6%A1%88%C2%B7%E5%85%83%E5%A4%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    青玉案·元夕
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B5%A3%E6%BA%AA%E6%B2%99%C2%B7%E8%B0%81%E5%BF%B5%E8%A5%BF%E9%A3%8E%E7%8B%AC%E8%87%AA%E5%87%89/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    浣溪沙·谁念西风独自凉
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%A3%B0%E5%A3%B0%E6%85%A2%C2%B7%E5%AF%BB%E5%AF%BB%E8%A7%85%E8%A7%85/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    声声慢·寻寻觅觅
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%99%9E%E7%BE%8E%E4%BA%BA%C2%B7%E5%90%AC%E9%9B%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    虞美人·听雨
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E9%9D%92%E7%8E%89%E6%A1%88%C2%B7%E5%87%8C%E6%B3%A2%E4%B8%8D%E8%BF%87%E6%A8%AA%E5%A1%98%E8%B7%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    青玉案·凌波不过横塘路
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E7%9B%B8%E8%A7%81%E6%AC%A2%C2%B7%E6%9E%97%E8%8A%B1%E8%B0%A2%E4%BA%86%E6%98%A5%E7%BA%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    相见欢·林花谢了春红
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%B4%E6%B1%9F%E4%BB%99%C2%B7%E6%A2%A6%E5%90%8E%E6%A5%BC%E5%8F%B0%E9%AB%98%E9%94%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    临江仙·梦后楼台高锁
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E9%A2%98%E9%83%BD%E5%9F%8E%E5%8D%97%E5%BA%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    题都城南庄
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B5%AA%E6%B7%98%E6%B2%99%E4%BB%A4%C2%B7%E5%B8%98%E5%A4%96%E9%9B%A8%E6%BD%BA%E6%BD%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    浪淘沙令·帘外雨潺潺
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E9%B9%A7%E9%B8%AA%E5%A4%A9%C2%B7%E4%BB%A3%E4%BA%BA%E8%B5%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    鹧鸪天·代人赋
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B0%B4%E4%BB%99%E5%AD%90%C2%B7%E5%A4%9C%E9%9B%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    水仙子·夜雨
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%94%90%E5%A4%9A%E4%BB%A4%C2%B7%E6%83%9C%E5%88%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    唐多令·惜别
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%B5%AA%E6%B7%98%E6%B2%99%C2%B7%E6%8A%8A%E9%85%92%E7%A5%9D%E4%B8%9C%E9%A3%8E/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    浪淘沙·把酒祝东风
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E4%B8%B4%E5%AE%89%E6%98%A5%E9%9B%A8%E5%88%9D%E9%9C%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    临安春雨初霁
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E8%9D%B6%E6%81%8B%E8%8A%B1%C2%B7%E6%98%A5%E6%99%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    蝶恋花·春景
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E5%96%9C%E8%BF%81%E8%8E%BA%C2%B7%E6%A2%85%E9%9B%A8%E9%9C%81/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    喜迁莺·梅雨霁
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E6%AF%8F%E6%97%A5%E8%AF%97%E8%AF%8D/%E6%A2%85%E8%8A%B1%E5%BC%95%C2%B7%E8%8D%86%E6%BA%AA%E9%98%BB%E9%9B%AA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    梅花引·荆溪阻雪
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    发疯
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    发疯
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../%E5%8F%91%E7%96%AF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    发疯
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    长期主义
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    长期主义
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/fitness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    长期主义
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    关于
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    关于
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/geren/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    作者个人简介
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/%E7%AE%80%E5%8E%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    个人简历
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/zcw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    支持作者
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--new"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../about/test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    功能测试
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="admonition tip">
<p class="admonition-title">📝 自动摘要</p>
<p>本文围绕Swin3D: A Pretrained Transformer Backbone展开讨论，介绍了相关的技术概念、应用场景和实践方法。</p>
</div>
<div class="admonition info">
<p class="admonition-title">📖 阅读信息</p>
<p>阅读时间：<strong>6</strong> 分钟 | 中文字符：<strong>2443</strong> | 有效代码行数：<strong>770</strong></p>
</div>
<h1 id="swin3d-a-pretrained-transformer-backbone">Swin3D: A Pretrained Transformer Backbone<a class="headerlink" href="#swin3d-a-pretrained-transformer-backbone" title="Permanent link">&para;</a></h1>
<h1 id="for-3d-indoor-scene-understanding">for 3D Indoor Scene Understanding<a class="headerlink" href="#for-3d-indoor-scene-understanding" title="Permanent link">&para;</a></h1>
<p>论文核心是提出了一个应用在 3D 点云领域的预训练 Backbone，将原先应用在 2D 图像领域的 Swin Transformer 适配到了 3D 点云，但是直接扩展会有内存耗费大，效果并不够好的问题，论文中通过优化注意力的内存占用到线性复杂度，以及点云位置的不确定性，点可能在其占据的体素内的任意位置都有可能；</p>
<p>Swin3D 的核心仍然是窗口注意力，借鉴了 2D Swin Transformer 的设计理念，通过分层结构和移动窗口注意力机制来高效处理 3D 点云数据</p>
<p>Swin3D 的整体架构分为 5 个阶段（Stages），形成了一个层级式的特征提取器。</p>
<ul>
<li>输入数据：原始 3D 点云，包含点的位置 P 和其他信号（如 RGB 颜色、法向量等），表示为 <span class="arithmatex">\(s_p \in \mathbb{R}^m\)</span>；对于颜色、法向量等成分，都要归一化到 <span class="arithmatex">\([-1,1]\)</span>，常用设置为 m = 6，包含 3D 点坐标和 RGB 颜色分量；</li>
<li>核心流程：<code>Voxelization</code> <span class="arithmatex">\(\to\)</span> <code>Stage-1</code> <span class="arithmatex">\(\to\)</span> <code>Downsample</code> <span class="arithmatex">\(\to\)</span> <code>Stage-2</code> ... <span class="arithmatex">\(\to\)</span> <code>Stage-5</code>。</li>
<li>输出：<strong>多尺度</strong> 的体素特征，可用于下游的分割或检测任务 。</li>
</ul>
<p><img alt="Swin3D 整体网络架构图" src="https://cdn.jsdelivr.net/gh/Gongzihang6/Pictures@main/Medias/2025%5C12%5Cimage-20251206140819429.png" /></p>
<h3 id="voxelization">Voxelization<a class="headerlink" href="#voxelization" title="Permanent link">&para;</a></h3>
<p>体素化模块，论文中使用稀疏体素来表示点，如图 1 所示，根据输入点云，创建了 5 个不同层级的稀疏化体素网格，默认情况下，对于室内场景，划分最细的网格是 2cm，然后每提高一级，网格尺寸增加一倍；</p>
<p>点信息以从最精细的级别到最粗略级别的如下方式存储在体素中</p>
<ul>
<li>对于最精细的体素网格 <span class="arithmatex">\(v\)</span>，论文从这个体素网格中随机挑选一个点代表这个体素，记为 <span class="arithmatex">\(r_v\)</span>；</li>
<li>后续层级（l+1）中，后续层级体素都比最精细的体素网格要大，一个体素相当于之前四个体素，这时从子体素的代表点中选择最接近几何中心的点；</li>
<li>这一步将无序的点云转化为结构化的稀疏体素，同时保留了点的原始信号 <span class="arithmatex">\(s_v\)</span> 。</li>
</ul>
<h3 id="initial-feature-embedding">Initial Feature Embedding<a class="headerlink" href="#initial-feature-embedding" title="Permanent link">&para;</a></h3>
<p>论文中提到，参考 <a href="https://arxiv.org/abs/2203.14508">Stratified transformer for 3D point cloud segmentation</a>.发现的，直接使用线性层或 MLP 将原始特征投影到高维空间对于 Swin 系列的 transformer 架构无法产生比较好的效果，因此论文中提出使用一个 <code>3*3*3</code> 的卷积核对输入数据进行稀疏卷积（通过哈希表存储非空体素索引，避免大量空体素的无效计算），以及 BN 批量归一化和 ReLU 激活层，将输入体素特征变换到 <span class="arithmatex">\(\mathbb{R}^{C_1}\)</span></p>
<p>输入特征由体素 <span class="arithmatex">\(v\)</span> 的代表点坐标和体素中心坐标之差（<span class="arithmatex">\(r_v-c_v\)</span>）和其他代表点特征（如 RGB、法向量等），相较于 <a href="https://arxiv.org/abs/2203.14508">Stratified transformer for 3D point cloud segmentation</a> 中使用的 KPConv，论文中提出的 initial feature embedding 更轻量；</p>
<p>整理如下：</p>
<ul>
<li><strong>输入</strong>：体素 <span class="arithmatex">\(v\)</span> 的原始特征。这里的输入特征是由“位置偏移量”（<span class="arithmatex">\(r_v - c_v\)</span>，即代表点坐标减去体素中心坐标）和其他信号（如颜色）拼接而成。</li>
<li><strong>操作</strong>：使用一层 <span class="arithmatex">\(3 \times 3 \times 3\)</span> 的 <strong>稀疏卷积 (Sparse Convolution)</strong>，通过 Batch Normalization (BN) 和 ReLU 激活函数。</li>
<li><strong>目的</strong>：将低维的原始信号投影到高维特征空间 <span class="arithmatex">\(\mathbb{R}^{C_1}\)</span>。</li>
</ul>
<h3 id="contextual-relative-signal-encodingcrse">Contextual relative signal encoding（cRSE）<a class="headerlink" href="#contextual-relative-signal-encodingcrse" title="Permanent link">&para;</a></h3>
<p>上下文相对信号编码，本质是对 Swin Transformer 中的相对位置编码的一种广义化增强</p>
<h4 id="1-crse">1、为什么要有 cRSE？<a class="headerlink" href="#1-crse" title="Permanent link">&para;</a></h4>
<p>在标准的 2D Swin Transformer 中，像素是排列在规则网格上的，相对位置是固定的。但在 3D 点云中，Swin3D 面临两个特殊挑战：</p>
<ol>
<li><strong>位置不规则 (Spatial Irregularity)</strong>：点在体素内可以是任意位置，不仅仅是网格中心 1。</li>
<li><strong>信号不规则 (Signal Irregularity)</strong>：除了位置，点云还包含颜色（RGB）、法向量（Normal）等信号。在一个窗口内，这些信号的相对变化（例如两个点颜色差异很大）对于理解场景非常重要 2222。</li>
</ol>
<p>原理解释：传统的相对位置编码只告诉注意力机制：“点 A 和点 B 在空间上距离是多少”。cRSE (Contextual Relative Signal Encoding) 则试图告诉注意力机制：“点 A 和点 B 不仅空间距离是 <span class="arithmatex">\(X\)</span>，而且它们的颜色差异是 <span class="arithmatex">\(Y\)</span>，法向量差异是 <span class="arithmatex">\(Z\)</span>。”</p>
<p>这种编码被称为“Contextual（上下文的）”，是因为它不仅仅加一个静态的偏置值，而是让这个偏置值与当前的 Query 和 Key 进行交互，使得注意力机制能动态地根据信号差异来调整关注度 。</p>
<h4 id="2-crse">2. 计算过程：cRSE 是如何运作的？<a class="headerlink" href="#2-crse" title="Permanent link">&para;</a></h4>
<p>cRSE 的计算过程可以分为三个步骤：<strong>信号差分</strong>、<strong>量化与查表</strong>、<strong>融入注意力机制</strong>。</p>
<h5 id="delta-s_ij">第一步：计算信号差异 (<span class="arithmatex">\(\Delta s_{ij}\)</span>)<a class="headerlink" href="#delta-s_ij" title="Permanent link">&para;</a></h5>
<p>对于窗口内的任意两个体素 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span>，首先计算它们原始信号的差异。
$$
\Delta s_{ij} = s_{v_i} - s_{v_j}
$$
这里的信号 <span class="arithmatex">\(s\)</span> 是一个复合向量，通常包含：</p>
<ul>
<li><strong>位置</strong>：<span class="arithmatex">\(x, y, z\)</span></li>
<li><strong>颜色</strong>：<span class="arithmatex">\(r, g, b\)</span></li>
<li>法向量：<span class="arithmatex">\(n_x, n_y, n_z\)</span>，这意味着 cRSE 不仅编码位置差，也编码颜色差和法向量差。</li>
</ul>
<h5 id="quantization-look-up-table">第二步：量化与查表 (Quantization &amp; Look-up Table)<a class="headerlink" href="#quantization-look-up-table" title="Permanent link">&para;</a></h5>
<p>由于 <span class="arithmatex">\(\Delta s_{ij}\)</span> 是连续的浮点数，无法直接作为索引去查找参数。因此需要将其 <strong>量化</strong> 为整数索引，然后去一个可学习的 <strong>查找表 (Look-up Table, LUT)</strong> 中取值。</p>
<ol>
<li>
<p>量化公式 ：对于信号的第 <span class="arithmatex">\(l\)</span> 个分量（例如红色分量 R），计算索引 <span class="arithmatex">\(I_l\)</span>：
    $$
    I_l(\Delta) = \left\lfloor \frac{(\Delta [l] - \text{min_val}) \times L}{\text{range}} \right\rfloor
    $$</p>
<ul>
<li><span class="arithmatex">\(\text{min\_val}\)</span> 和 <span class="arithmatex">\(\text{range}\)</span> 是预定义的范围（例如 RGB 颜色范围是 <span class="arithmatex">\([-1, 1]\)</span>）6。</li>
<li><span class="arithmatex">\(L\)</span> 是表的大小（例如颜色和法向量设为 16，位置设为 4）7。</li>
</ul>
</li>
<li>
<p>查表映射 ：通过索引 <span class="arithmatex">\(I_l\)</span>，从可学习的表 <span class="arithmatex">\(t^Q, t^K, t^V\)</span> 中取出对应的向量。
    $$
    t_{Q, h}(\Delta) = \sum_{l = 1}^{m} t_{l, h}^Q [I_l(\Delta)]
    $$
    这意味着将位置差、颜色差、法向量差对应的特征向量相加，得到一个综合的信号差异编码。</p>
</li>
</ol>
<h5 id="integration">第三步：融入注意力计算 (Integration)<a class="headerlink" href="#integration" title="Permanent link">&para;</a></h5>
<p>这是最关键的一步。cRSE 不仅仅是给 Attention Score 加一个标量 <span class="arithmatex">\(b\)</span>，它是将信号差异编码投影后，分别与 Query 和 Key 进行交互。</p>
<ol>
<li>修改 Attention Score (<span class="arithmatex">\(e_{ij}\)</span>)，原始 Attention 是 <span class="arithmatex">\((Q \cdot K^T) / \sqrt{d}\)</span>。加入 cRSE 后，公式变为：</li>
</ol>
<div class="arithmatex">\[
e_{ij, h} = \frac{(f_i W_{Q, h})(f_j W_{K, h})^T + b_{ij, h}}{\sqrt{d}}
\]</div>
<p>其中 <span class="arithmatex">\(b_{ij,h}\)</span> 是上下文偏差项：
$$
b_{ij, h} = \underbrace{(f_i W_{Q, h}) \cdot t_{Q, h}(\Delta s_{ij})}<em K_="K," h="h">{\text{Query 与信号差的交互}} + \underbrace{(f_j W</em>
$$}) \cdot t_{K, h}(\Delta s_{ij})}_{\text{Key 与信号差的交互}</p>
<ul>
<li><strong>直观理解</strong>：这使得注意力分数不仅取决于 <span class="arithmatex">\(Q\)</span> 和 <span class="arithmatex">\(K\)</span> 的相似度，还取决于 <span class="arithmatex">\(Q\)</span> 对“信号差异”的敏感度以及 <span class="arithmatex">\(K\)</span> 对“信号差异”的敏感度。</li>
<li>修改 Output Value (<span class="arithmatex">\(f^*\)</span>)</li>
</ul>
<p>cRSE 不仅影响权重的计算，还直接把信号差异信息加到了 Value (<span class="arithmatex">\(V\)</span>) 上 10：
$$
f_{i, h}^* = \frac{\sum_{j} \exp(e_{ij, h}) (f_j W_{V, h} + t_{V, h}(\Delta s_{ij}))}{\sum_{j} \exp(e_{ij, h})}
$$</p>
<ul>
<li>这里 <span class="arithmatex">\(t_{V,h}(\Delta s_{ij})\)</span> 被直接加到了 <span class="arithmatex">\(V\)</span> 特征上。这意味着如果两个点的颜色差异很大，这个差异本身也会被作为特征传递到下一层。</li>
</ul>
<h3 id="_1">总结<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p><strong>cRSE 的本质</strong> 是将 <strong>[位置差, 颜色差, 法向量差]</strong> 这一物理世界的先验知识，通过 <strong>量化查表</strong> 的方式变成可学习的向量，并强行注入到 Transformer 的 <strong>Query-Key 匹配过程</strong> 以及 <strong>Value 聚合过程</strong> 中。</p>
<p>这使得 Swin3D 能够理解：“虽然这个点在空间上很近，但颜色完全不同（可能是边界），所以我应该减少对它的注意力（降低 <span class="arithmatex">\(e_{ij}\)</span>）”。</p>
<h3 id="w-msa3d-and-sw-msa3d">W-MSA3D and SW-MSA3D<a class="headerlink" href="#w-msa3d-and-sw-msa3d" title="Permanent link">&para;</a></h3>
<p>Swin3D 中的 Transformer Block，S-MSA3D 用于规则窗口，SW-MSA3D 用于偏移窗口，</p>
<p>S-MSA3D (规则窗口)：</p>
<ul>
<li>切分方式：规则窗口从从坐标原点 <span class="arithmatex">\((0,0,0)\)</span> 开始，按照固定的窗口大小 <span class="arithmatex">\(M \times M \times M\)</span> 把整个点云体素网格切成整齐的小方块 ；</li>
<li>局限性：自注意力计算被限制在每个 <span class="arithmatex">\(M \times M \times M\)</span> 的小方块内部。<strong>不同方块之间的体素无法进行交互</strong>。如果没有后续步骤，整个网络就会变成一个个孤立的“孤岛”，丢失全局信息。</li>
</ul>
<p>SW-MSA3D (移位窗口)</p>
<ul>
<li><strong>切分方式</strong>：在 S-MSA3D 的基础上，将切分网格向右、下、后方移动。</li>
<li><strong>移动偏移量</strong>：偏移量通常是窗口大小的一半，即 <span class="arithmatex">\((\lfloor \frac{M}{2} \rfloor, \lfloor \frac{M}{2} \rfloor, \lfloor \frac{M}{2} \rfloor)\)</span> 6。</li>
<li><strong>目的</strong>：<strong>打破“孤岛”</strong>。通过移动窗口，原来的边界变成了新窗口的中心。这样，原本在 S-MSA3D 中属于两个不同窗口的相邻体素，在 SW-MSA3D 中就会被包含在同一个窗口内进行交互。</li>
</ul>
<h3 id="downsample">Downsample<a class="headerlink" href="#downsample" title="Permanent link">&para;</a></h3>
<p><span class="arithmatex">\(l\)</span> 层的体素如何通过下采样变成 <span class="arithmatex">\(l+1\)</span> 层的体素呢？<span class="arithmatex">\(l+1\)</span> 层是在原始点云中采用 <span class="arithmatex">\(l\)</span> 层双倍的网格大小划分的体素，<span class="arithmatex">\(l\)</span> 层体素中每个体素的特诊表示经过 <code>LayerNorm+Linear Layer</code>，将特征维度从 <span class="arithmatex">\(C_l\)</span> 提升到 <span class="arithmatex">\(C_{l+1}\)</span>，这是在 l 层的体素数量是操作的；然后是 KNNPooling，这是针对稀疏数据的特殊池化。对于下一层（<span class="arithmatex">\(l+1\)</span> 层）的每个体素，在上一层（<span class="arithmatex">\(l\)</span> 层）中找到其 <strong>K 个最近邻 (K-Nearest Neighbors)</strong> 体素，然后执行 <strong>最大池化 (Max Pooling)</strong> 21。默认 <span class="arithmatex">\(k=16\)</span>。</p>
<h2 id="pointcept">在pointcept中复现教程<a class="headerlink" href="#pointcept" title="Permanent link">&para;</a></h2>
<h3 id="1">1、创建自己的数据集读取器<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>在<code>pointcept/datasets</code>下新建一个<code>keypoint_dataset.py</code>，在里面创建一个pytorch风格的数据加载器，具体代码如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">  1</a></span>
<span class="normal"><a href="#__codelineno-0-2">  2</a></span>
<span class="normal"><a href="#__codelineno-0-3">  3</a></span>
<span class="normal"><a href="#__codelineno-0-4">  4</a></span>
<span class="normal"><a href="#__codelineno-0-5">  5</a></span>
<span class="normal"><a href="#__codelineno-0-6">  6</a></span>
<span class="normal"><a href="#__codelineno-0-7">  7</a></span>
<span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.builder</span><span class="w"> </span><span class="kn">import</span> <span class="n">DATASETS</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">Compose</span><span class="p">,</span> <span class="n">TRANSFORMS</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="nd">@DATASETS</span><span class="o">.</span><span class="n">register_module</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeypointDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>                 <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>                 <span class="n">data_root</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>                 <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>                 <span class="n">test_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                 <span class="n">loop</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_root</span> <span class="o">=</span> <span class="n">data_root</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">split</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="c1"># 加载转换流水线 (GridSample, ToTensor 等)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span> <span class="o">=</span> <span class="n">test_mode</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loop</span> <span class="o">=</span> <span class="n">loop</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">test_mode</span> <span class="k">else</span> <span class="mi">1</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="c1"># 扫描文件</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_list</span><span class="p">()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="si">}</span><span class="s2">] Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_file_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">split_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">split</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">split_path</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data path does not exist: </span><span class="si">{</span><span class="n">split_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="c1"># 匹配特征文件: *d_pc_clipped.npy</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">feature_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split_path</span><span class="p">,</span> <span class="s2">&quot;*_d_pc_clipped.npy&quot;</span><span class="p">))</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="k">for</span> <span class="n">feat_path</span> <span class="ow">in</span> <span class="n">feature_files</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">feat_path</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="c1"># 解析文件名: dev_2_005J_20251102_110034_430_d_pc_clipped.npy</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="c1"># parts: [&#39;dev&#39;, &#39;2&#39;, &#39;005J&#39;, &#39;20251102&#39;, &#39;110034&#39;, &#39;430&#39;, ...]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="n">parts</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="c1"># 提取时间戳 (根据你的示例是第3,4,5个部分)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="c1"># 请根据实际文件名调整这里的索引</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                <span class="n">timestamp</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping invalid filename: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="k">continue</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="n">label_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;关键点坐标_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.npy&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="n">label_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split_path</span><span class="p">,</span> <span class="n">label_filename</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">label_path</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                    <span class="s2">&quot;feat_path&quot;</span><span class="p">:</span> <span class="n">feat_path</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                    <span class="s2">&quot;label_path&quot;</span><span class="p">:</span> <span class="n">label_path</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">filename</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="p">})</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="k">return</span> <span class="n">data_list</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">loop</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="c1"># 1. 加载数据</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;feat_path&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">coord</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">feat</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;label_path&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="c1"># 提取给 Swin3D 做位置编码辅助的特征 (coord_feat)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="c1"># Swin3D 需要这个键。既然没有 RGB，就用 &quot;法向量&quot; (第3,4,5列) 代替</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="c1"># 维度: (N, 3)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">coord_feat</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="c1"># ================= [新增] 数据安全检查 =================</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="c1"># 检查是否有 NaN 或 Inf</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Warning: Found NaN/Inf in </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, replacing with 0.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="c1"># 将 NaN 替换为 0</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️ Warning: Found NaN/Inf in target of </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, replacing with 0.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="c1"># =====================================================</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="c1"># 2. 去中心化</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">coord</span> <span class="o">-=</span> <span class="n">centroid</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">target</span> <span class="o">-=</span> <span class="n">centroid</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="c1"># 3. 归一化</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="c1"># 增加 eps 防止除以 0 的隐患</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coord</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">m</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> 
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="c1"># coord = coord / m  &lt;-- 原代码</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="c1"># target = target / m &lt;-- 原代码</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="c1"># [修改建议] 防止 m 为 0 (虽然你前面处理了，但双重保险更好)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> 
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">coord</span> <span class="o">=</span> <span class="n">coord</span> <span class="o">/</span> <span class="n">scale</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">target</span> <span class="o">=</span> <span class="n">target</span> <span class="o">/</span> <span class="n">scale</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="c1"># 构造数据字典</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">coord</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">feat</span><span class="o">=</span><span class="n">feat</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> 
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">coord_feat</span><span class="o">=</span><span class="n">coord_feat</span><span class="p">,</span>  <span class="c1"># [新增] Swin3D 位置编码辅助特征</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">name</span><span class="o">=</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">centroid</span><span class="o">=</span><span class="n">centroid</span><span class="p">,</span> 
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">scale</span><span class="o">=</span><span class="n">scale</span>  <span class="c1"># [重点] 这里传入 numpy 数组，方便 DataLoader 自动堆叠</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="c1"># 4. 应用变换 (GridSample 等)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">return</span> <span class="n">data_dict</span>
</code></pre></div></td></tr></table></div>
<p>主要作用是从数据集路径下读取数据集，根据时间戳来匹配样本特征和标签，并进行预处理，包括去中心化、归一化，以及根据模型架构特点，是否进行网格化还是下采样等等，然后由统一的数据生成器打包为batch，供后面使用。</p>
<p>然后在同级目录下的<code>__init__.py</code>中注册我们自己创建的自己的数据集加载类，在文件末尾添加一行：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># keypoint</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.keypoint_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeypointDataset</span>
</code></pre></div></td></tr></table></div>
<h3 id="2">2、创建模型配置文件<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>在<code>configs</code>下新建一个文件夹<code>my_dataset</code>，然后新建一个<code>keypoint_swin3d.py</code>，<code>pointcept</code>中通过py文件配置模型参数，包括训练结果、日志等的保存路径，模型网络结构超参数，数据集路径，数据预处理方式，以及优化器、学习率调度器、钩子函数等等；</p>
<p><code>keypoint_swin3d.py</code>文件内容如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">  1</a></span>
<span class="normal"><a href="#__codelineno-2-2">  2</a></span>
<span class="normal"><a href="#__codelineno-2-3">  3</a></span>
<span class="normal"><a href="#__codelineno-2-4">  4</a></span>
<span class="normal"><a href="#__codelineno-2-5">  5</a></span>
<span class="normal"><a href="#__codelineno-2-6">  6</a></span>
<span class="normal"><a href="#__codelineno-2-7">  7</a></span>
<span class="normal"><a href="#__codelineno-2-8">  8</a></span>
<span class="normal"><a href="#__codelineno-2-9">  9</a></span>
<span class="normal"><a href="#__codelineno-2-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-2-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-2-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-2-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-2-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-2-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-2-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-2-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-2-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-2-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-2-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-2-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-2-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-2-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-2-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-2-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-2-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-2-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-2-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-2-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-2-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-2-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-2-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-2-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-2-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-2-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-2-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-2-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-2-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-2-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-2-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-2-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-2-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-2-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-2-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-2-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-2-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-2-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-2-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-2-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-2-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-2-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-2-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-2-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-2-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-2-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-2-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-2-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-2-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-2-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-2-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-2-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-2-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-2-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-2-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-2-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-2-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-2-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-2-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-2-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-2-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-2-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-2-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-2-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-2-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-2-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-2-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-2-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-2-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-2-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-2-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-2-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-2-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-2-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-2-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-2-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-2-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-2-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-2-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-2-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-2-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-2-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-2-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-2-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-2-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-2-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-2-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-2-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-2-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-2-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-2-100">100</a></span>
<span class="normal"><a href="#__codelineno-2-101">101</a></span>
<span class="normal"><a href="#__codelineno-2-102">102</a></span>
<span class="normal"><a href="#__codelineno-2-103">103</a></span>
<span class="normal"><a href="#__codelineno-2-104">104</a></span>
<span class="normal"><a href="#__codelineno-2-105">105</a></span>
<span class="normal"><a href="#__codelineno-2-106">106</a></span>
<span class="normal"><a href="#__codelineno-2-107">107</a></span>
<span class="normal"><a href="#__codelineno-2-108">108</a></span>
<span class="normal"><a href="#__codelineno-2-109">109</a></span>
<span class="normal"><a href="#__codelineno-2-110">110</a></span>
<span class="normal"><a href="#__codelineno-2-111">111</a></span>
<span class="normal"><a href="#__codelineno-2-112">112</a></span>
<span class="normal"><a href="#__codelineno-2-113">113</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">_base_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../_base_/default_runtime.py&quot;</span><span class="p">]</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="c1"># Global Settings</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="n">epoch</span> <span class="o">=</span> <span class="mi">100</span> 
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;exp/keypoint_swin3d&quot;</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="c1"># Model Settings (Swin3D)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="n">model</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;KeypointSwin3D&quot;</span><span class="p">,</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="n">num_keypoints</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>    <span class="n">backbone_conf</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Swin3D-v1m1&quot;</span><span class="p">,</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="n">in_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="c1"># 或 4，取决于你的 coord_feat 逻辑</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>        <span class="n">num_classes</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>        <span class="n">base_grid_size</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>        <span class="n">quant_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>       <span class="c1"># 必须是整数</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>        <span class="n">num_layers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>        <span class="c1"># 必须显式指定为 4</span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a>        <span class="n">depths</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>        <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>        <span class="c1"># [核心修改] 必须全为偶数！</span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>        <span class="c1"># 原来是 [3, 6, 12, 24] -&gt; 改为 [6, 12, 24, 48] 或者 [4, 8, 16, 32]</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a>        <span class="n">num_heads</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> 
<a id="__codelineno-2-29" name="__codelineno-2-29"></a>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a>        <span class="n">window_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a>        <span class="n">up_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a>        <span class="n">drop_path_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a>        <span class="n">stem_transformer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a>        <span class="n">down_stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-2-35" name="__codelineno-2-35"></a>        <span class="n">upsample</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a>        <span class="n">knn_down</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a>        <span class="n">cRSE</span><span class="o">=</span><span class="s2">&quot;XYZ_RGB&quot;</span><span class="p">,</span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a>        <span class="n">fp16_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
<a id="__codelineno-2-39" name="__codelineno-2-39"></a>    <span class="p">),</span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a>
<a id="__codelineno-2-41" name="__codelineno-2-41"></a>    <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
<a id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="p">)</span>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-45" name="__codelineno-2-45"></a><span class="c1"># Data Settings</span>
<a id="__codelineno-2-46" name="__codelineno-2-46"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="n">num_worker</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-2-48" name="__codelineno-2-48"></a><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<a id="__codelineno-2-49" name="__codelineno-2-49"></a><span class="n">data_root</span> <span class="o">=</span> <span class="s2">&quot;/home/gzh/point/DataSets&quot;</span>
<a id="__codelineno-2-50" name="__codelineno-2-50"></a><span class="n">grid_size_val</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># 这里的 grid_size 必须与模型的 quant_size/base_grid_size 匹配</span>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a>
<a id="__codelineno-2-52" name="__codelineno-2-52"></a><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-53" name="__codelineno-2-53"></a>    <span class="n">train</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-54" name="__codelineno-2-54"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;KeypointDataset&quot;</span><span class="p">,</span>
<a id="__codelineno-2-55" name="__codelineno-2-55"></a>        <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span>
<a id="__codelineno-2-56" name="__codelineno-2-56"></a>        <span class="n">data_root</span><span class="o">=</span><span class="n">data_root</span><span class="p">,</span>
<a id="__codelineno-2-57" name="__codelineno-2-57"></a>        <span class="n">transform</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-2-58" name="__codelineno-2-58"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">index_valid_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;coord_feat&quot;</span><span class="p">],</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">)),</span>
<a id="__codelineno-2-59" name="__codelineno-2-59"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;GridSample&quot;</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">,</span> <span class="n">hash_type</span><span class="o">=</span><span class="s2">&quot;fnv&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_grid_coord</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ToTensor&quot;</span><span class="p">),</span>
<a id="__codelineno-2-61" name="__codelineno-2-61"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Collect&quot;</span><span class="p">,</span> 
<a id="__codelineno-2-62" name="__codelineno-2-62"></a>                 <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">,</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_size&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-63" name="__codelineno-2-63"></a>                 <span class="n">offset_keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="s2">&quot;coord&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-64" name="__codelineno-2-64"></a>                 <span class="n">feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;feat&quot;</span><span class="p">,),</span>
<a id="__codelineno-2-65" name="__codelineno-2-65"></a>                 <span class="n">coord_feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">,))</span>
<a id="__codelineno-2-66" name="__codelineno-2-66"></a>        <span class="p">],</span>
<a id="__codelineno-2-67" name="__codelineno-2-67"></a>        <span class="n">loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-2-68" name="__codelineno-2-68"></a>    <span class="p">),</span>
<a id="__codelineno-2-69" name="__codelineno-2-69"></a>    <span class="n">val</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-70" name="__codelineno-2-70"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;KeypointDataset&quot;</span><span class="p">,</span>
<a id="__codelineno-2-71" name="__codelineno-2-71"></a>        <span class="n">split</span><span class="o">=</span><span class="s2">&quot;val&quot;</span><span class="p">,</span>
<a id="__codelineno-2-72" name="__codelineno-2-72"></a>        <span class="n">data_root</span><span class="o">=</span><span class="n">data_root</span><span class="p">,</span>
<a id="__codelineno-2-73" name="__codelineno-2-73"></a>        <span class="n">transform</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-2-74" name="__codelineno-2-74"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">index_valid_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;coord_feat&quot;</span><span class="p">],</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">)),</span>
<a id="__codelineno-2-75" name="__codelineno-2-75"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;GridSample&quot;</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">,</span> <span class="n">hash_type</span><span class="o">=</span><span class="s2">&quot;fnv&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_grid_coord</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-2-76" name="__codelineno-2-76"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ToTensor&quot;</span><span class="p">),</span>
<a id="__codelineno-2-77" name="__codelineno-2-77"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Collect&quot;</span><span class="p">,</span> 
<a id="__codelineno-2-78" name="__codelineno-2-78"></a>                 <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="s2">&quot;coord_feat&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_size&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-79" name="__codelineno-2-79"></a>                 <span class="n">offset_keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="s2">&quot;coord&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-80" name="__codelineno-2-80"></a>                 <span class="n">feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;feat&quot;</span><span class="p">,),</span>
<a id="__codelineno-2-81" name="__codelineno-2-81"></a>                 <span class="n">coord_feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">,))</span>
<a id="__codelineno-2-82" name="__codelineno-2-82"></a>        <span class="p">],</span>
<a id="__codelineno-2-83" name="__codelineno-2-83"></a>    <span class="p">),</span>
<a id="__codelineno-2-84" name="__codelineno-2-84"></a>    <span class="n">test</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-2-85" name="__codelineno-2-85"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;KeypointDataset&quot;</span><span class="p">,</span>
<a id="__codelineno-2-86" name="__codelineno-2-86"></a>        <span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
<a id="__codelineno-2-87" name="__codelineno-2-87"></a>        <span class="n">data_root</span><span class="o">=</span><span class="n">data_root</span><span class="p">,</span>
<a id="__codelineno-2-88" name="__codelineno-2-88"></a>        <span class="n">transform</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-2-89" name="__codelineno-2-89"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">index_valid_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;coord_feat&quot;</span><span class="p">],</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">)),</span>
<a id="__codelineno-2-90" name="__codelineno-2-90"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;GridSample&quot;</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="n">grid_size_val</span><span class="p">,</span> <span class="n">hash_type</span><span class="o">=</span><span class="s2">&quot;fnv&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">return_grid_coord</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-2-91" name="__codelineno-2-91"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ToTensor&quot;</span><span class="p">),</span>
<a id="__codelineno-2-92" name="__codelineno-2-92"></a>            <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Collect&quot;</span><span class="p">,</span> 
<a id="__codelineno-2-93" name="__codelineno-2-93"></a>                 <span class="n">keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_coord&quot;</span><span class="p">,</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="s2">&quot;coord_feat&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_size&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-94" name="__codelineno-2-94"></a>                 <span class="n">offset_keys_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="s2">&quot;coord&quot;</span><span class="p">),</span> 
<a id="__codelineno-2-95" name="__codelineno-2-95"></a>                 <span class="n">feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;feat&quot;</span><span class="p">,),</span>
<a id="__codelineno-2-96" name="__codelineno-2-96"></a>                 <span class="n">coord_feat_keys</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">,))</span>
<a id="__codelineno-2-97" name="__codelineno-2-97"></a>        <span class="p">],</span>
<a id="__codelineno-2-98" name="__codelineno-2-98"></a>    <span class="p">),</span>
<a id="__codelineno-2-99" name="__codelineno-2-99"></a><span class="p">)</span>
<a id="__codelineno-2-100" name="__codelineno-2-100"></a>
<a id="__codelineno-2-101" name="__codelineno-2-101"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-102" name="__codelineno-2-102"></a><span class="c1"># Training Settings</span>
<a id="__codelineno-2-103" name="__codelineno-2-103"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-2-104" name="__codelineno-2-104"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;AdamW&quot;</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<a id="__codelineno-2-105" name="__codelineno-2-105"></a><span class="n">scheduler</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;CosineAnnealingLR&quot;</span><span class="p">,</span> <span class="n">eta_min</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span> 
<a id="__codelineno-2-106" name="__codelineno-2-106"></a>
<a id="__codelineno-2-107" name="__codelineno-2-107"></a><span class="n">hooks</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-2-108" name="__codelineno-2-108"></a>    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;CheckpointLoader&quot;</span><span class="p">),</span>
<a id="__codelineno-2-109" name="__codelineno-2-109"></a>    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;IterationTimer&quot;</span><span class="p">,</span> <span class="n">warmup_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-2-110" name="__codelineno-2-110"></a>    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;InformationWriter&quot;</span><span class="p">),</span>
<a id="__codelineno-2-111" name="__codelineno-2-111"></a>    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;KeypointEvaluator&quot;</span><span class="p">),</span>
<a id="__codelineno-2-112" name="__codelineno-2-112"></a>    <span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;CheckpointSaver&quot;</span><span class="p">,</span> <span class="n">save_freq</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-2-113" name="__codelineno-2-113"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="3">3、创建具体网络模型结构<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>由于<code>pointcept</code>中现有的网络结构基本都是基于点云分类和点云的语义分割的，没有直接可用于点云关键点预测或者回归的，所以我们需要仿照<code>pointcept/models</code>路径下，已有的各种模型的网络结构，来修改分类头或者分割头，改为我们的关键点回归头；对于<code>swin3d</code>而言，我们在<code>pointcept/models</code>文件夹下创建我们的基于<code>swin3d</code>的关键点回归头的网络结构文件<code>keypoint_swin3d.py</code>，具体代码如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">  1</a></span>
<span class="normal"><a href="#__codelineno-3-2">  2</a></span>
<span class="normal"><a href="#__codelineno-3-3">  3</a></span>
<span class="normal"><a href="#__codelineno-3-4">  4</a></span>
<span class="normal"><a href="#__codelineno-3-5">  5</a></span>
<span class="normal"><a href="#__codelineno-3-6">  6</a></span>
<span class="normal"><a href="#__codelineno-3-7">  7</a></span>
<span class="normal"><a href="#__codelineno-3-8">  8</a></span>
<span class="normal"><a href="#__codelineno-3-9">  9</a></span>
<span class="normal"><a href="#__codelineno-3-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-3-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-3-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-3-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-3-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-3-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-3-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-3-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-3-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-3-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-3-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-3-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-3-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-3-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-3-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-3-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-3-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-3-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-3-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-3-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-3-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-3-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-3-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-3-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-3-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-3-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-3-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-3-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-3-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-3-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-3-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-3-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-3-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-3-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-3-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-3-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-3-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-3-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-3-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-3-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-3-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-3-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-3-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-3-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-3-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-3-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-3-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-3-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-3-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-3-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-3-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-3-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-3-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-3-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-3-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-3-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-3-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-3-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-3-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-3-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-3-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-3-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-3-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-3-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-3-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-3-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-3-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-3-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-3-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-3-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-3-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-3-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-3-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-3-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-3-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-3-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-3-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-3-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-3-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-3-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-3-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-3-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-3-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-3-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-3-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-3-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-3-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-3-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-3-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-3-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-3-100">100</a></span>
<span class="normal"><a href="#__codelineno-3-101">101</a></span>
<span class="normal"><a href="#__codelineno-3-102">102</a></span>
<span class="normal"><a href="#__codelineno-3-103">103</a></span>
<span class="normal"><a href="#__codelineno-3-104">104</a></span>
<span class="normal"><a href="#__codelineno-3-105">105</a></span>
<span class="normal"><a href="#__codelineno-3-106">106</a></span>
<span class="normal"><a href="#__codelineno-3-107">107</a></span>
<span class="normal"><a href="#__codelineno-3-108">108</a></span>
<span class="normal"><a href="#__codelineno-3-109">109</a></span>
<span class="normal"><a href="#__codelineno-3-110">110</a></span>
<span class="normal"><a href="#__codelineno-3-111">111</a></span>
<span class="normal"><a href="#__codelineno-3-112">112</a></span>
<span class="normal"><a href="#__codelineno-3-113">113</a></span>
<span class="normal"><a href="#__codelineno-3-114">114</a></span>
<span class="normal"><a href="#__codelineno-3-115">115</a></span>
<span class="normal"><a href="#__codelineno-3-116">116</a></span>
<span class="normal"><a href="#__codelineno-3-117">117</a></span>
<span class="normal"><a href="#__codelineno-3-118">118</a></span>
<span class="normal"><a href="#__codelineno-3-119">119</a></span>
<span class="normal"><a href="#__codelineno-3-120">120</a></span>
<span class="normal"><a href="#__codelineno-3-121">121</a></span>
<span class="normal"><a href="#__codelineno-3-122">122</a></span>
<span class="normal"><a href="#__codelineno-3-123">123</a></span>
<span class="normal"><a href="#__codelineno-3-124">124</a></span>
<span class="normal"><a href="#__codelineno-3-125">125</a></span>
<span class="normal"><a href="#__codelineno-3-126">126</a></span>
<span class="normal"><a href="#__codelineno-3-127">127</a></span>
<span class="normal"><a href="#__codelineno-3-128">128</a></span>
<span class="normal"><a href="#__codelineno-3-129">129</a></span>
<span class="normal"><a href="#__codelineno-3-130">130</a></span>
<span class="normal"><a href="#__codelineno-3-131">131</a></span>
<span class="normal"><a href="#__codelineno-3-132">132</a></span>
<span class="normal"><a href="#__codelineno-3-133">133</a></span>
<span class="normal"><a href="#__codelineno-3-134">134</a></span>
<span class="normal"><a href="#__codelineno-3-135">135</a></span>
<span class="normal"><a href="#__codelineno-3-136">136</a></span>
<span class="normal"><a href="#__codelineno-3-137">137</a></span>
<span class="normal"><a href="#__codelineno-3-138">138</a></span>
<span class="normal"><a href="#__codelineno-3-139">139</a></span>
<span class="normal"><a href="#__codelineno-3-140">140</a></span>
<span class="normal"><a href="#__codelineno-3-141">141</a></span>
<span class="normal"><a href="#__codelineno-3-142">142</a></span>
<span class="normal"><a href="#__codelineno-3-143">143</a></span>
<span class="normal"><a href="#__codelineno-3-144">144</a></span>
<span class="normal"><a href="#__codelineno-3-145">145</a></span>
<span class="normal"><a href="#__codelineno-3-146">146</a></span>
<span class="normal"><a href="#__codelineno-3-147">147</a></span>
<span class="normal"><a href="#__codelineno-3-148">148</a></span>
<span class="normal"><a href="#__codelineno-3-149">149</a></span>
<span class="normal"><a href="#__codelineno-3-150">150</a></span>
<span class="normal"><a href="#__codelineno-3-151">151</a></span>
<span class="normal"><a href="#__codelineno-3-152">152</a></span>
<span class="normal"><a href="#__codelineno-3-153">153</a></span>
<span class="normal"><a href="#__codelineno-3-154">154</a></span>
<span class="normal"><a href="#__codelineno-3-155">155</a></span>
<span class="normal"><a href="#__codelineno-3-156">156</a></span>
<span class="normal"><a href="#__codelineno-3-157">157</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1"># pointcept/models/keypoint_swin3d.py</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="c1"># 代码作用：Swin3D 关键点检测模型架构 </span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1"># ==============================================================================</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.models.builder</span><span class="w"> </span><span class="kn">import</span> <span class="n">MODELS</span><span class="p">,</span> <span class="n">build_model</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="nd">@MODELS</span><span class="o">.</span><span class="n">register_module</span><span class="p">(</span><span class="s2">&quot;KeypointSwin3D&quot;</span><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeypointSwin3D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>                 <span class="n">backbone_conf</span><span class="p">,</span> 
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>                 <span class="n">num_keypoints</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> 
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>                 <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">):</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a>        <span class="c1"># 1. 构建骨干网络 (Swin3D)</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">backbone_conf</span><span class="p">)</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a>        <span class="c1"># 2. 自动获取骨干输出通道数</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a>        <span class="c1"># Swin3D 的 channels 参数通常是一个列表 [C1, C2, C3, C4]</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a>        <span class="k">if</span> <span class="s1">&#39;channels&#39;</span> <span class="ow">in</span> <span class="n">backbone_conf</span><span class="p">:</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a>            <span class="n">in_channels</span> <span class="o">=</span> <span class="n">backbone_conf</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a>            <span class="n">in_channels</span> <span class="o">=</span> <span class="mi">96</span> <span class="c1"># 默认备用值</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a>        <span class="c1"># 3. 回归头 (Regression Head)</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_keypoints</span> <span class="o">=</span> <span class="n">num_keypoints</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a>        <span class="n">output_dim</span> <span class="o">=</span> <span class="n">num_keypoints</span> <span class="o">*</span> <span class="mi">3</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reg_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">),</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">)</span>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a>        <span class="p">)</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a>        <span class="c1"># 4. 损失函数</span>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a>        <span class="c1"># === [核心修复] 构造 Swin3D 必须的 coord_feat ===</span>
<a id="__codelineno-3-46" name="__codelineno-3-46"></a>        <span class="k">if</span> <span class="s2">&quot;coord_feat&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a>            <span class="n">coord</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">]</span>
<a id="__codelineno-3-48" name="__codelineno-3-48"></a>            <span class="n">feat</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;feat&quot;</span><span class="p">]</span>
<a id="__codelineno-3-49" name="__codelineno-3-49"></a>
<a id="__codelineno-3-50" name="__codelineno-3-50"></a>            <span class="c1"># 获取 Stem Layer (第一层卷积) 期望的输入通道数</span>
<a id="__codelineno-3-51" name="__codelineno-3-51"></a>            <span class="c1"># 修正：根据 mink_layers.py，MinkConvBNRelu 使用 conv_layers (Sequential)</span>
<a id="__codelineno-3-52" name="__codelineno-3-52"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-3-53" name="__codelineno-3-53"></a>                <span class="n">stem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="o">.</span><span class="n">stem_layer</span>
<a id="__codelineno-3-54" name="__codelineno-3-54"></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">stem</span><span class="p">,</span> <span class="s2">&quot;conv_layers&quot;</span><span class="p">):</span> 
<a id="__codelineno-3-55" name="__codelineno-3-55"></a>                    <span class="c1"># 访问 Sequential 的第一个模块 (MinkowskiConvolution)</span>
<a id="__codelineno-3-56" name="__codelineno-3-56"></a>                    <span class="n">expected_channels</span> <span class="o">=</span> <span class="n">stem</span><span class="o">.</span><span class="n">conv_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">in_channels</span>
<a id="__codelineno-3-57" name="__codelineno-3-57"></a>                <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">stem</span><span class="p">,</span> <span class="s2">&quot;conv&quot;</span><span class="p">):</span>
<a id="__codelineno-3-58" name="__codelineno-3-58"></a>                    <span class="n">expected_channels</span> <span class="o">=</span> <span class="n">stem</span><span class="o">.</span><span class="n">conv</span><span class="o">.</span><span class="n">in_channels</span>
<a id="__codelineno-3-59" name="__codelineno-3-59"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-60" name="__codelineno-3-60"></a>                    <span class="c1"># 如果无法推断，默认使用配置中的 feat 维度</span>
<a id="__codelineno-3-61" name="__codelineno-3-61"></a>                    <span class="n">expected_channels</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-3-62" name="__codelineno-3-62"></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-3-63" name="__codelineno-3-63"></a>                <span class="n">expected_channels</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-3-64" name="__codelineno-3-64"></a>
<a id="__codelineno-3-65" name="__codelineno-3-65"></a>            <span class="c1"># 根据模型期望决定是否拼接坐标</span>
<a id="__codelineno-3-66" name="__codelineno-3-66"></a>            <span class="k">if</span> <span class="n">expected_channels</span> <span class="o">==</span> <span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-3-67" name="__codelineno-3-67"></a>                <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">coord</span><span class="p">,</span> <span class="n">feat</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-3-68" name="__codelineno-3-68"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-69" name="__codelineno-3-69"></a>                <span class="c1"># 默认只使用特征 (如果是 4 通道)</span>
<a id="__codelineno-3-70" name="__codelineno-3-70"></a>                <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;coord_feat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feat</span>
<a id="__codelineno-3-71" name="__codelineno-3-71"></a>
<a id="__codelineno-3-72" name="__codelineno-3-72"></a>        <span class="c1"># === 1. 特征提取 (Backbone) ===</span>
<a id="__codelineno-3-73" name="__codelineno-3-73"></a>        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<a id="__codelineno-3-74" name="__codelineno-3-74"></a>
<a id="__codelineno-3-75" name="__codelineno-3-75"></a>        <span class="c1"># 兼容性处理：Swin3D 可能直接返回 Tensor，也可能返回 SparseTensor</span>
<a id="__codelineno-3-76" name="__codelineno-3-76"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">):</span> 
<a id="__codelineno-3-77" name="__codelineno-3-77"></a>            <span class="n">feat</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">F</span>
<a id="__codelineno-3-78" name="__codelineno-3-78"></a>        <span class="k">else</span><span class="p">:</span> 
<a id="__codelineno-3-79" name="__codelineno-3-79"></a>            <span class="n">feat</span> <span class="o">=</span> <span class="n">output</span>
<a id="__codelineno-3-80" name="__codelineno-3-80"></a>
<a id="__codelineno-3-81" name="__codelineno-3-81"></a>        <span class="c1"># === 2. 全局池化 (Global Pooling) ===</span>
<a id="__codelineno-3-82" name="__codelineno-3-82"></a>        <span class="c1"># 使用 offset 将 batch 中每个样本的点特征聚合</span>
<a id="__codelineno-3-83" name="__codelineno-3-83"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">int</span><span class="p">()</span>
<a id="__codelineno-3-84" name="__codelineno-3-84"></a>        <span class="n">batch_feats</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-3-85" name="__codelineno-3-85"></a>        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-3-86" name="__codelineno-3-86"></a>
<a id="__codelineno-3-87" name="__codelineno-3-87"></a>        <span class="c1"># 注意：如果 Swin3D 使用了体素化导致点数变化，必须使用 offset2batch 等方式重新计算</span>
<a id="__codelineno-3-88" name="__codelineno-3-88"></a>        <span class="c1"># 但 Pointcept 的 Swin3DUNet 在分割模式下通常会插值回原始点数，或者保持一一对应</span>
<a id="__codelineno-3-89" name="__codelineno-3-89"></a>        <span class="c1"># 为了安全，这里做一个长度检查</span>
<a id="__codelineno-3-90" name="__codelineno-3-90"></a>        <span class="k">if</span> <span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">offset</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">():</span>
<a id="__codelineno-3-91" name="__codelineno-3-91"></a>            <span class="c1"># 如果特征点数与原始 offset 不一致 (说明被体素化下采样了)</span>
<a id="__codelineno-3-92" name="__codelineno-3-92"></a>            <span class="c1"># 我们需要重新计算一个 batch 索引</span>
<a id="__codelineno-3-93" name="__codelineno-3-93"></a>            <span class="n">batch_idx</span> <span class="o">=</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-3-94" name="__codelineno-3-94"></a>            <span class="k">if</span> <span class="n">batch_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-3-95" name="__codelineno-3-95"></a>                <span class="c1"># 如果没有 batch 索引，尝试用 coordinates 推断 (SparseTensor 的 coordinates 第一列是 batch_idx)</span>
<a id="__codelineno-3-96" name="__codelineno-3-96"></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">):</span>
<a id="__codelineno-3-97" name="__codelineno-3-97"></a>                    <span class="n">batch_idx</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">C</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-3-98" name="__codelineno-3-98"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-99" name="__codelineno-3-99"></a>                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Output feature size mismatch and cannot infer batch index.&quot;</span><span class="p">)</span>
<a id="__codelineno-3-100" name="__codelineno-3-100"></a>
<a id="__codelineno-3-101" name="__codelineno-3-101"></a>            <span class="c1"># 使用 scatter_mean 或简单的循环进行池化</span>
<a id="__codelineno-3-102" name="__codelineno-3-102"></a>            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset</span><span class="p">)):</span>
<a id="__codelineno-3-103" name="__codelineno-3-103"></a>                <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">batch_idx</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span>
<a id="__codelineno-3-104" name="__codelineno-3-104"></a>                <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-3-105" name="__codelineno-3-105"></a>                    <span class="n">sample_feat</span> <span class="o">=</span> <span class="n">feat</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-106" name="__codelineno-3-106"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-107" name="__codelineno-3-107"></a>                    <span class="n">sample_feat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-3-108" name="__codelineno-3-108"></a>                <span class="n">batch_feats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_feat</span><span class="p">)</span>
<a id="__codelineno-3-109" name="__codelineno-3-109"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-110" name="__codelineno-3-110"></a>            <span class="c1"># 正常情况：点数一一对应</span>
<a id="__codelineno-3-111" name="__codelineno-3-111"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">offset</span><span class="p">)):</span>
<a id="__codelineno-3-112" name="__codelineno-3-112"></a>                <span class="n">end</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-3-113" name="__codelineno-3-113"></a>                <span class="n">sample_feat</span> <span class="o">=</span> <span class="n">feat</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<a id="__codelineno-3-114" name="__codelineno-3-114"></a>                <span class="n">batch_feats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample_feat</span><span class="p">)</span>
<a id="__codelineno-3-115" name="__codelineno-3-115"></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
<a id="__codelineno-3-116" name="__codelineno-3-116"></a>
<a id="__codelineno-3-117" name="__codelineno-3-117"></a>        <span class="n">global_feat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">batch_feats</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># (B, C)</span>
<a id="__codelineno-3-118" name="__codelineno-3-118"></a>
<a id="__codelineno-3-119" name="__codelineno-3-119"></a>        <span class="c1"># === 3. 关键点回归 ===</span>
<a id="__codelineno-3-120" name="__codelineno-3-120"></a>        <span class="n">pred_flat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_head</span><span class="p">(</span><span class="n">global_feat</span><span class="p">)</span>
<a id="__codelineno-3-121" name="__codelineno-3-121"></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">pred_flat</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_keypoints</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-122" name="__codelineno-3-122"></a>
<a id="__codelineno-3-123" name="__codelineno-3-123"></a>        <span class="n">result_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-3-124" name="__codelineno-3-124"></a>
<a id="__codelineno-3-125" name="__codelineno-3-125"></a>        <span class="c1"># === 4. Loss 与 监控 ===</span>
<a id="__codelineno-3-126" name="__codelineno-3-126"></a>        <span class="k">if</span> <span class="s2">&quot;target&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-3-127" name="__codelineno-3-127"></a>            <span class="n">target</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
<a id="__codelineno-3-128" name="__codelineno-3-128"></a>
<a id="__codelineno-3-129" name="__codelineno-3-129"></a>            <span class="n">pred_for_loss</span> <span class="o">=</span> <span class="n">pred</span> <span class="k">if</span> <span class="n">pred</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">target</span><span class="o">.</span><span class="n">shape</span> <span class="k">else</span> <span class="n">pred</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-130" name="__codelineno-3-130"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">pred_for_loss</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<a id="__codelineno-3-131" name="__codelineno-3-131"></a>            <span class="k">if</span> <span class="n">loss</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-3-132" name="__codelineno-3-132"></a>            <span class="n">result_dict</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loss</span>
<a id="__codelineno-3-133" name="__codelineno-3-133"></a>
<a id="__codelineno-3-134" name="__codelineno-3-134"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">:</span>
<a id="__codelineno-3-135" name="__codelineno-3-135"></a>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-3-136" name="__codelineno-3-136"></a>                    <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_keypoints</span>
<a id="__codelineno-3-137" name="__codelineno-3-137"></a>                    <span class="n">pred_metric</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-138" name="__codelineno-3-138"></a>                    <span class="n">target_metric</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-3-139" name="__codelineno-3-139"></a>
<a id="__codelineno-3-140" name="__codelineno-3-140"></a>                    <span class="n">dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pred_metric</span> <span class="o">-</span> <span class="n">target_metric</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-3-141" name="__codelineno-3-141"></a>
<a id="__codelineno-3-142" name="__codelineno-3-142"></a>                    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-3-143" name="__codelineno-3-143"></a>                        <span class="n">scale</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
<a id="__codelineno-3-144" name="__codelineno-3-144"></a>                        <span class="k">if</span> <span class="n">scale</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-3-145" name="__codelineno-3-145"></a>                        <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">*</span> <span class="n">scale</span>
<a id="__codelineno-3-146" name="__codelineno-3-146"></a>
<a id="__codelineno-3-147" name="__codelineno-3-147"></a>                    <span class="n">result_dict</span><span class="p">[</span><span class="s2">&quot;train/mean_dist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-3-148" name="__codelineno-3-148"></a>
<a id="__codelineno-3-149" name="__codelineno-3-149"></a>                    <span class="n">kp_dist_mean</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-150" name="__codelineno-3-150"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<a id="__codelineno-3-151" name="__codelineno-3-151"></a>                        <span class="n">result_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;train/kp</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_dist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kp_dist_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-3-152" name="__codelineno-3-152"></a>
<a id="__codelineno-3-153" name="__codelineno-3-153"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">:</span>
<a id="__codelineno-3-154" name="__codelineno-3-154"></a>            <span class="k">return</span> <span class="n">result_dict</span>
<a id="__codelineno-3-155" name="__codelineno-3-155"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-156" name="__codelineno-3-156"></a>            <span class="n">result_dict</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-3-157" name="__codelineno-3-157"></a>            <span class="k">return</span> <span class="n">result_dict</span>
</code></pre></div></td></tr></table></div>
<p>对于<code>swin3d</code>而言，我们只使用<code>stage5</code>，也就是最后一个阶段输出的<strong>最高层（语义最强、分辨率最低）</strong>的特征，然后在体素数量维度N上进行平均池化，得到通道为<span class="arithmatex">\(C_5\)</span>的特征向量，然后通过回归头（一个简单的3层MLP）将特征映射到<code>number_points*3</code>维度上，然后使用真实关键点坐标优化这个输出，得到我们想要的关键点坐标。</p>
<p>创建好<code>pointcept/models/keypoint_swin3d.py</code>文件后，和数据集配置文件类似，在<code>pointcept/models/__init__.py</code>中注册我们创建的模型网络架构，具体来说，在文件末尾添加一行，导入我们创建的模型网络架构类</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">.keypoint_swin3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeypointSwin3D</span>     <span class="c1"># 基于Swin3D的关键点检测模型</span>
</code></pre></div></td></tr></table></div>
<h3 id="4">4、训练模型<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p>在tools/train.py中，分别运行如下代码：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>export PYTHONPATH=.
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>source .venv/bin/activate
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>python tools/train.py --config-file configs/my_dataset/keypoint_swin3d.py
</code></pre></div></td></tr></table></div>
<p>即可开始训练</p>
<h3 id="5">5、推理<a class="headerlink" href="#5" title="Permanent link">&para;</a></h3>
<p>新建<code>tools/inference.py</code>，代码如下：实现了trian、val、test的单独批量评估，并绘制关键点误差散点图。以及单样本推理并使用open3d绘制关键点可视化</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">  1</a></span>
<span class="normal"><a href="#__codelineno-6-2">  2</a></span>
<span class="normal"><a href="#__codelineno-6-3">  3</a></span>
<span class="normal"><a href="#__codelineno-6-4">  4</a></span>
<span class="normal"><a href="#__codelineno-6-5">  5</a></span>
<span class="normal"><a href="#__codelineno-6-6">  6</a></span>
<span class="normal"><a href="#__codelineno-6-7">  7</a></span>
<span class="normal"><a href="#__codelineno-6-8">  8</a></span>
<span class="normal"><a href="#__codelineno-6-9">  9</a></span>
<span class="normal"><a href="#__codelineno-6-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-6-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-6-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-6-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-6-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-6-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-6-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-6-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-6-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-6-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-6-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-6-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-6-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-6-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-6-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-6-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-6-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-6-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-6-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-6-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-6-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-6-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-6-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-6-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-6-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-6-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-6-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-6-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-6-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-6-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-6-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-6-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-6-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-6-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-6-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-6-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-6-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-6-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-6-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-6-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-6-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-6-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-6-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-6-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-6-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-6-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-6-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-6-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-6-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-6-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-6-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-6-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-6-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-6-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-6-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-6-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-6-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-6-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-6-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-6-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-6-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-6-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-6-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-6-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-6-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-6-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-6-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-6-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-6-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-6-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-6-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-6-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-6-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-6-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-6-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-6-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-6-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-6-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-6-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-6-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-6-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-6-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-6-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-6-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-6-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-6-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-6-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-6-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-6-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-6-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-6-100">100</a></span>
<span class="normal"><a href="#__codelineno-6-101">101</a></span>
<span class="normal"><a href="#__codelineno-6-102">102</a></span>
<span class="normal"><a href="#__codelineno-6-103">103</a></span>
<span class="normal"><a href="#__codelineno-6-104">104</a></span>
<span class="normal"><a href="#__codelineno-6-105">105</a></span>
<span class="normal"><a href="#__codelineno-6-106">106</a></span>
<span class="normal"><a href="#__codelineno-6-107">107</a></span>
<span class="normal"><a href="#__codelineno-6-108">108</a></span>
<span class="normal"><a href="#__codelineno-6-109">109</a></span>
<span class="normal"><a href="#__codelineno-6-110">110</a></span>
<span class="normal"><a href="#__codelineno-6-111">111</a></span>
<span class="normal"><a href="#__codelineno-6-112">112</a></span>
<span class="normal"><a href="#__codelineno-6-113">113</a></span>
<span class="normal"><a href="#__codelineno-6-114">114</a></span>
<span class="normal"><a href="#__codelineno-6-115">115</a></span>
<span class="normal"><a href="#__codelineno-6-116">116</a></span>
<span class="normal"><a href="#__codelineno-6-117">117</a></span>
<span class="normal"><a href="#__codelineno-6-118">118</a></span>
<span class="normal"><a href="#__codelineno-6-119">119</a></span>
<span class="normal"><a href="#__codelineno-6-120">120</a></span>
<span class="normal"><a href="#__codelineno-6-121">121</a></span>
<span class="normal"><a href="#__codelineno-6-122">122</a></span>
<span class="normal"><a href="#__codelineno-6-123">123</a></span>
<span class="normal"><a href="#__codelineno-6-124">124</a></span>
<span class="normal"><a href="#__codelineno-6-125">125</a></span>
<span class="normal"><a href="#__codelineno-6-126">126</a></span>
<span class="normal"><a href="#__codelineno-6-127">127</a></span>
<span class="normal"><a href="#__codelineno-6-128">128</a></span>
<span class="normal"><a href="#__codelineno-6-129">129</a></span>
<span class="normal"><a href="#__codelineno-6-130">130</a></span>
<span class="normal"><a href="#__codelineno-6-131">131</a></span>
<span class="normal"><a href="#__codelineno-6-132">132</a></span>
<span class="normal"><a href="#__codelineno-6-133">133</a></span>
<span class="normal"><a href="#__codelineno-6-134">134</a></span>
<span class="normal"><a href="#__codelineno-6-135">135</a></span>
<span class="normal"><a href="#__codelineno-6-136">136</a></span>
<span class="normal"><a href="#__codelineno-6-137">137</a></span>
<span class="normal"><a href="#__codelineno-6-138">138</a></span>
<span class="normal"><a href="#__codelineno-6-139">139</a></span>
<span class="normal"><a href="#__codelineno-6-140">140</a></span>
<span class="normal"><a href="#__codelineno-6-141">141</a></span>
<span class="normal"><a href="#__codelineno-6-142">142</a></span>
<span class="normal"><a href="#__codelineno-6-143">143</a></span>
<span class="normal"><a href="#__codelineno-6-144">144</a></span>
<span class="normal"><a href="#__codelineno-6-145">145</a></span>
<span class="normal"><a href="#__codelineno-6-146">146</a></span>
<span class="normal"><a href="#__codelineno-6-147">147</a></span>
<span class="normal"><a href="#__codelineno-6-148">148</a></span>
<span class="normal"><a href="#__codelineno-6-149">149</a></span>
<span class="normal"><a href="#__codelineno-6-150">150</a></span>
<span class="normal"><a href="#__codelineno-6-151">151</a></span>
<span class="normal"><a href="#__codelineno-6-152">152</a></span>
<span class="normal"><a href="#__codelineno-6-153">153</a></span>
<span class="normal"><a href="#__codelineno-6-154">154</a></span>
<span class="normal"><a href="#__codelineno-6-155">155</a></span>
<span class="normal"><a href="#__codelineno-6-156">156</a></span>
<span class="normal"><a href="#__codelineno-6-157">157</a></span>
<span class="normal"><a href="#__codelineno-6-158">158</a></span>
<span class="normal"><a href="#__codelineno-6-159">159</a></span>
<span class="normal"><a href="#__codelineno-6-160">160</a></span>
<span class="normal"><a href="#__codelineno-6-161">161</a></span>
<span class="normal"><a href="#__codelineno-6-162">162</a></span>
<span class="normal"><a href="#__codelineno-6-163">163</a></span>
<span class="normal"><a href="#__codelineno-6-164">164</a></span>
<span class="normal"><a href="#__codelineno-6-165">165</a></span>
<span class="normal"><a href="#__codelineno-6-166">166</a></span>
<span class="normal"><a href="#__codelineno-6-167">167</a></span>
<span class="normal"><a href="#__codelineno-6-168">168</a></span>
<span class="normal"><a href="#__codelineno-6-169">169</a></span>
<span class="normal"><a href="#__codelineno-6-170">170</a></span>
<span class="normal"><a href="#__codelineno-6-171">171</a></span>
<span class="normal"><a href="#__codelineno-6-172">172</a></span>
<span class="normal"><a href="#__codelineno-6-173">173</a></span>
<span class="normal"><a href="#__codelineno-6-174">174</a></span>
<span class="normal"><a href="#__codelineno-6-175">175</a></span>
<span class="normal"><a href="#__codelineno-6-176">176</a></span>
<span class="normal"><a href="#__codelineno-6-177">177</a></span>
<span class="normal"><a href="#__codelineno-6-178">178</a></span>
<span class="normal"><a href="#__codelineno-6-179">179</a></span>
<span class="normal"><a href="#__codelineno-6-180">180</a></span>
<span class="normal"><a href="#__codelineno-6-181">181</a></span>
<span class="normal"><a href="#__codelineno-6-182">182</a></span>
<span class="normal"><a href="#__codelineno-6-183">183</a></span>
<span class="normal"><a href="#__codelineno-6-184">184</a></span>
<span class="normal"><a href="#__codelineno-6-185">185</a></span>
<span class="normal"><a href="#__codelineno-6-186">186</a></span>
<span class="normal"><a href="#__codelineno-6-187">187</a></span>
<span class="normal"><a href="#__codelineno-6-188">188</a></span>
<span class="normal"><a href="#__codelineno-6-189">189</a></span>
<span class="normal"><a href="#__codelineno-6-190">190</a></span>
<span class="normal"><a href="#__codelineno-6-191">191</a></span>
<span class="normal"><a href="#__codelineno-6-192">192</a></span>
<span class="normal"><a href="#__codelineno-6-193">193</a></span>
<span class="normal"><a href="#__codelineno-6-194">194</a></span>
<span class="normal"><a href="#__codelineno-6-195">195</a></span>
<span class="normal"><a href="#__codelineno-6-196">196</a></span>
<span class="normal"><a href="#__codelineno-6-197">197</a></span>
<span class="normal"><a href="#__codelineno-6-198">198</a></span>
<span class="normal"><a href="#__codelineno-6-199">199</a></span>
<span class="normal"><a href="#__codelineno-6-200">200</a></span>
<span class="normal"><a href="#__codelineno-6-201">201</a></span>
<span class="normal"><a href="#__codelineno-6-202">202</a></span>
<span class="normal"><a href="#__codelineno-6-203">203</a></span>
<span class="normal"><a href="#__codelineno-6-204">204</a></span>
<span class="normal"><a href="#__codelineno-6-205">205</a></span>
<span class="normal"><a href="#__codelineno-6-206">206</a></span>
<span class="normal"><a href="#__codelineno-6-207">207</a></span>
<span class="normal"><a href="#__codelineno-6-208">208</a></span>
<span class="normal"><a href="#__codelineno-6-209">209</a></span>
<span class="normal"><a href="#__codelineno-6-210">210</a></span>
<span class="normal"><a href="#__codelineno-6-211">211</a></span>
<span class="normal"><a href="#__codelineno-6-212">212</a></span>
<span class="normal"><a href="#__codelineno-6-213">213</a></span>
<span class="normal"><a href="#__codelineno-6-214">214</a></span>
<span class="normal"><a href="#__codelineno-6-215">215</a></span>
<span class="normal"><a href="#__codelineno-6-216">216</a></span>
<span class="normal"><a href="#__codelineno-6-217">217</a></span>
<span class="normal"><a href="#__codelineno-6-218">218</a></span>
<span class="normal"><a href="#__codelineno-6-219">219</a></span>
<span class="normal"><a href="#__codelineno-6-220">220</a></span>
<span class="normal"><a href="#__codelineno-6-221">221</a></span>
<span class="normal"><a href="#__codelineno-6-222">222</a></span>
<span class="normal"><a href="#__codelineno-6-223">223</a></span>
<span class="normal"><a href="#__codelineno-6-224">224</a></span>
<span class="normal"><a href="#__codelineno-6-225">225</a></span>
<span class="normal"><a href="#__codelineno-6-226">226</a></span>
<span class="normal"><a href="#__codelineno-6-227">227</a></span>
<span class="normal"><a href="#__codelineno-6-228">228</a></span>
<span class="normal"><a href="#__codelineno-6-229">229</a></span>
<span class="normal"><a href="#__codelineno-6-230">230</a></span>
<span class="normal"><a href="#__codelineno-6-231">231</a></span>
<span class="normal"><a href="#__codelineno-6-232">232</a></span>
<span class="normal"><a href="#__codelineno-6-233">233</a></span>
<span class="normal"><a href="#__codelineno-6-234">234</a></span>
<span class="normal"><a href="#__codelineno-6-235">235</a></span>
<span class="normal"><a href="#__codelineno-6-236">236</a></span>
<span class="normal"><a href="#__codelineno-6-237">237</a></span>
<span class="normal"><a href="#__codelineno-6-238">238</a></span>
<span class="normal"><a href="#__codelineno-6-239">239</a></span>
<span class="normal"><a href="#__codelineno-6-240">240</a></span>
<span class="normal"><a href="#__codelineno-6-241">241</a></span>
<span class="normal"><a href="#__codelineno-6-242">242</a></span>
<span class="normal"><a href="#__codelineno-6-243">243</a></span>
<span class="normal"><a href="#__codelineno-6-244">244</a></span>
<span class="normal"><a href="#__codelineno-6-245">245</a></span>
<span class="normal"><a href="#__codelineno-6-246">246</a></span>
<span class="normal"><a href="#__codelineno-6-247">247</a></span>
<span class="normal"><a href="#__codelineno-6-248">248</a></span>
<span class="normal"><a href="#__codelineno-6-249">249</a></span>
<span class="normal"><a href="#__codelineno-6-250">250</a></span>
<span class="normal"><a href="#__codelineno-6-251">251</a></span>
<span class="normal"><a href="#__codelineno-6-252">252</a></span>
<span class="normal"><a href="#__codelineno-6-253">253</a></span>
<span class="normal"><a href="#__codelineno-6-254">254</a></span>
<span class="normal"><a href="#__codelineno-6-255">255</a></span>
<span class="normal"><a href="#__codelineno-6-256">256</a></span>
<span class="normal"><a href="#__codelineno-6-257">257</a></span>
<span class="normal"><a href="#__codelineno-6-258">258</a></span>
<span class="normal"><a href="#__codelineno-6-259">259</a></span>
<span class="normal"><a href="#__codelineno-6-260">260</a></span>
<span class="normal"><a href="#__codelineno-6-261">261</a></span>
<span class="normal"><a href="#__codelineno-6-262">262</a></span>
<span class="normal"><a href="#__codelineno-6-263">263</a></span>
<span class="normal"><a href="#__codelineno-6-264">264</a></span>
<span class="normal"><a href="#__codelineno-6-265">265</a></span>
<span class="normal"><a href="#__codelineno-6-266">266</a></span>
<span class="normal"><a href="#__codelineno-6-267">267</a></span>
<span class="normal"><a href="#__codelineno-6-268">268</a></span>
<span class="normal"><a href="#__codelineno-6-269">269</a></span>
<span class="normal"><a href="#__codelineno-6-270">270</a></span>
<span class="normal"><a href="#__codelineno-6-271">271</a></span>
<span class="normal"><a href="#__codelineno-6-272">272</a></span>
<span class="normal"><a href="#__codelineno-6-273">273</a></span>
<span class="normal"><a href="#__codelineno-6-274">274</a></span>
<span class="normal"><a href="#__codelineno-6-275">275</a></span>
<span class="normal"><a href="#__codelineno-6-276">276</a></span>
<span class="normal"><a href="#__codelineno-6-277">277</a></span>
<span class="normal"><a href="#__codelineno-6-278">278</a></span>
<span class="normal"><a href="#__codelineno-6-279">279</a></span>
<span class="normal"><a href="#__codelineno-6-280">280</a></span>
<span class="normal"><a href="#__codelineno-6-281">281</a></span>
<span class="normal"><a href="#__codelineno-6-282">282</a></span>
<span class="normal"><a href="#__codelineno-6-283">283</a></span>
<span class="normal"><a href="#__codelineno-6-284">284</a></span>
<span class="normal"><a href="#__codelineno-6-285">285</a></span>
<span class="normal"><a href="#__codelineno-6-286">286</a></span>
<span class="normal"><a href="#__codelineno-6-287">287</a></span>
<span class="normal"><a href="#__codelineno-6-288">288</a></span>
<span class="normal"><a href="#__codelineno-6-289">289</a></span>
<span class="normal"><a href="#__codelineno-6-290">290</a></span>
<span class="normal"><a href="#__codelineno-6-291">291</a></span>
<span class="normal"><a href="#__codelineno-6-292">292</a></span>
<span class="normal"><a href="#__codelineno-6-293">293</a></span>
<span class="normal"><a href="#__codelineno-6-294">294</a></span>
<span class="normal"><a href="#__codelineno-6-295">295</a></span>
<span class="normal"><a href="#__codelineno-6-296">296</a></span>
<span class="normal"><a href="#__codelineno-6-297">297</a></span>
<span class="normal"><a href="#__codelineno-6-298">298</a></span>
<span class="normal"><a href="#__codelineno-6-299">299</a></span>
<span class="normal"><a href="#__codelineno-6-300">300</a></span>
<span class="normal"><a href="#__codelineno-6-301">301</a></span>
<span class="normal"><a href="#__codelineno-6-302">302</a></span>
<span class="normal"><a href="#__codelineno-6-303">303</a></span>
<span class="normal"><a href="#__codelineno-6-304">304</a></span>
<span class="normal"><a href="#__codelineno-6-305">305</a></span>
<span class="normal"><a href="#__codelineno-6-306">306</a></span>
<span class="normal"><a href="#__codelineno-6-307">307</a></span>
<span class="normal"><a href="#__codelineno-6-308">308</a></span>
<span class="normal"><a href="#__codelineno-6-309">309</a></span>
<span class="normal"><a href="#__codelineno-6-310">310</a></span>
<span class="normal"><a href="#__codelineno-6-311">311</a></span>
<span class="normal"><a href="#__codelineno-6-312">312</a></span>
<span class="normal"><a href="#__codelineno-6-313">313</a></span>
<span class="normal"><a href="#__codelineno-6-314">314</a></span>
<span class="normal"><a href="#__codelineno-6-315">315</a></span>
<span class="normal"><a href="#__codelineno-6-316">316</a></span>
<span class="normal"><a href="#__codelineno-6-317">317</a></span>
<span class="normal"><a href="#__codelineno-6-318">318</a></span>
<span class="normal"><a href="#__codelineno-6-319">319</a></span>
<span class="normal"><a href="#__codelineno-6-320">320</a></span>
<span class="normal"><a href="#__codelineno-6-321">321</a></span>
<span class="normal"><a href="#__codelineno-6-322">322</a></span>
<span class="normal"><a href="#__codelineno-6-323">323</a></span>
<span class="normal"><a href="#__codelineno-6-324">324</a></span>
<span class="normal"><a href="#__codelineno-6-325">325</a></span>
<span class="normal"><a href="#__codelineno-6-326">326</a></span>
<span class="normal"><a href="#__codelineno-6-327">327</a></span>
<span class="normal"><a href="#__codelineno-6-328">328</a></span>
<span class="normal"><a href="#__codelineno-6-329">329</a></span>
<span class="normal"><a href="#__codelineno-6-330">330</a></span>
<span class="normal"><a href="#__codelineno-6-331">331</a></span>
<span class="normal"><a href="#__codelineno-6-332">332</a></span>
<span class="normal"><a href="#__codelineno-6-333">333</a></span>
<span class="normal"><a href="#__codelineno-6-334">334</a></span>
<span class="normal"><a href="#__codelineno-6-335">335</a></span>
<span class="normal"><a href="#__codelineno-6-336">336</a></span>
<span class="normal"><a href="#__codelineno-6-337">337</a></span>
<span class="normal"><a href="#__codelineno-6-338">338</a></span>
<span class="normal"><a href="#__codelineno-6-339">339</a></span>
<span class="normal"><a href="#__codelineno-6-340">340</a></span>
<span class="normal"><a href="#__codelineno-6-341">341</a></span>
<span class="normal"><a href="#__codelineno-6-342">342</a></span>
<span class="normal"><a href="#__codelineno-6-343">343</a></span>
<span class="normal"><a href="#__codelineno-6-344">344</a></span>
<span class="normal"><a href="#__codelineno-6-345">345</a></span>
<span class="normal"><a href="#__codelineno-6-346">346</a></span>
<span class="normal"><a href="#__codelineno-6-347">347</a></span>
<span class="normal"><a href="#__codelineno-6-348">348</a></span>
<span class="normal"><a href="#__codelineno-6-349">349</a></span>
<span class="normal"><a href="#__codelineno-6-350">350</a></span>
<span class="normal"><a href="#__codelineno-6-351">351</a></span>
<span class="normal"><a href="#__codelineno-6-352">352</a></span>
<span class="normal"><a href="#__codelineno-6-353">353</a></span>
<span class="normal"><a href="#__codelineno-6-354">354</a></span>
<span class="normal"><a href="#__codelineno-6-355">355</a></span>
<span class="normal"><a href="#__codelineno-6-356">356</a></span>
<span class="normal"><a href="#__codelineno-6-357">357</a></span>
<span class="normal"><a href="#__codelineno-6-358">358</a></span>
<span class="normal"><a href="#__codelineno-6-359">359</a></span>
<span class="normal"><a href="#__codelineno-6-360">360</a></span>
<span class="normal"><a href="#__codelineno-6-361">361</a></span>
<span class="normal"><a href="#__codelineno-6-362">362</a></span>
<span class="normal"><a href="#__codelineno-6-363">363</a></span>
<span class="normal"><a href="#__codelineno-6-364">364</a></span>
<span class="normal"><a href="#__codelineno-6-365">365</a></span>
<span class="normal"><a href="#__codelineno-6-366">366</a></span>
<span class="normal"><a href="#__codelineno-6-367">367</a></span>
<span class="normal"><a href="#__codelineno-6-368">368</a></span>
<span class="normal"><a href="#__codelineno-6-369">369</a></span>
<span class="normal"><a href="#__codelineno-6-370">370</a></span>
<span class="normal"><a href="#__codelineno-6-371">371</a></span>
<span class="normal"><a href="#__codelineno-6-372">372</a></span>
<span class="normal"><a href="#__codelineno-6-373">373</a></span>
<span class="normal"><a href="#__codelineno-6-374">374</a></span>
<span class="normal"><a href="#__codelineno-6-375">375</a></span>
<span class="normal"><a href="#__codelineno-6-376">376</a></span>
<span class="normal"><a href="#__codelineno-6-377">377</a></span>
<span class="normal"><a href="#__codelineno-6-378">378</a></span>
<span class="normal"><a href="#__codelineno-6-379">379</a></span>
<span class="normal"><a href="#__codelineno-6-380">380</a></span>
<span class="normal"><a href="#__codelineno-6-381">381</a></span>
<span class="normal"><a href="#__codelineno-6-382">382</a></span>
<span class="normal"><a href="#__codelineno-6-383">383</a></span>
<span class="normal"><a href="#__codelineno-6-384">384</a></span>
<span class="normal"><a href="#__codelineno-6-385">385</a></span>
<span class="normal"><a href="#__codelineno-6-386">386</a></span>
<span class="normal"><a href="#__codelineno-6-387">387</a></span>
<span class="normal"><a href="#__codelineno-6-388">388</a></span>
<span class="normal"><a href="#__codelineno-6-389">389</a></span>
<span class="normal"><a href="#__codelineno-6-390">390</a></span>
<span class="normal"><a href="#__codelineno-6-391">391</a></span>
<span class="normal"><a href="#__codelineno-6-392">392</a></span>
<span class="normal"><a href="#__codelineno-6-393">393</a></span>
<span class="normal"><a href="#__codelineno-6-394">394</a></span>
<span class="normal"><a href="#__codelineno-6-395">395</a></span>
<span class="normal"><a href="#__codelineno-6-396">396</a></span>
<span class="normal"><a href="#__codelineno-6-397">397</a></span>
<span class="normal"><a href="#__codelineno-6-398">398</a></span>
<span class="normal"><a href="#__codelineno-6-399">399</a></span>
<span class="normal"><a href="#__codelineno-6-400">400</a></span>
<span class="normal"><a href="#__codelineno-6-401">401</a></span>
<span class="normal"><a href="#__codelineno-6-402">402</a></span>
<span class="normal"><a href="#__codelineno-6-403">403</a></span>
<span class="normal"><a href="#__codelineno-6-404">404</a></span>
<span class="normal"><a href="#__codelineno-6-405">405</a></span>
<span class="normal"><a href="#__codelineno-6-406">406</a></span>
<span class="normal"><a href="#__codelineno-6-407">407</a></span>
<span class="normal"><a href="#__codelineno-6-408">408</a></span>
<span class="normal"><a href="#__codelineno-6-409">409</a></span>
<span class="normal"><a href="#__codelineno-6-410">410</a></span>
<span class="normal"><a href="#__codelineno-6-411">411</a></span>
<span class="normal"><a href="#__codelineno-6-412">412</a></span>
<span class="normal"><a href="#__codelineno-6-413">413</a></span>
<span class="normal"><a href="#__codelineno-6-414">414</a></span>
<span class="normal"><a href="#__codelineno-6-415">415</a></span>
<span class="normal"><a href="#__codelineno-6-416">416</a></span>
<span class="normal"><a href="#__codelineno-6-417">417</a></span>
<span class="normal"><a href="#__codelineno-6-418">418</a></span>
<span class="normal"><a href="#__codelineno-6-419">419</a></span>
<span class="normal"><a href="#__codelineno-6-420">420</a></span>
<span class="normal"><a href="#__codelineno-6-421">421</a></span>
<span class="normal"><a href="#__codelineno-6-422">422</a></span>
<span class="normal"><a href="#__codelineno-6-423">423</a></span>
<span class="normal"><a href="#__codelineno-6-424">424</a></span>
<span class="normal"><a href="#__codelineno-6-425">425</a></span>
<span class="normal"><a href="#__codelineno-6-426">426</a></span>
<span class="normal"><a href="#__codelineno-6-427">427</a></span>
<span class="normal"><a href="#__codelineno-6-428">428</a></span>
<span class="normal"><a href="#__codelineno-6-429">429</a></span>
<span class="normal"><a href="#__codelineno-6-430">430</a></span>
<span class="normal"><a href="#__codelineno-6-431">431</a></span>
<span class="normal"><a href="#__codelineno-6-432">432</a></span>
<span class="normal"><a href="#__codelineno-6-433">433</a></span>
<span class="normal"><a href="#__codelineno-6-434">434</a></span>
<span class="normal"><a href="#__codelineno-6-435">435</a></span>
<span class="normal"><a href="#__codelineno-6-436">436</a></span>
<span class="normal"><a href="#__codelineno-6-437">437</a></span>
<span class="normal"><a href="#__codelineno-6-438">438</a></span>
<span class="normal"><a href="#__codelineno-6-439">439</a></span>
<span class="normal"><a href="#__codelineno-6-440">440</a></span>
<span class="normal"><a href="#__codelineno-6-441">441</a></span>
<span class="normal"><a href="#__codelineno-6-442">442</a></span>
<span class="normal"><a href="#__codelineno-6-443">443</a></span>
<span class="normal"><a href="#__codelineno-6-444">444</a></span>
<span class="normal"><a href="#__codelineno-6-445">445</a></span>
<span class="normal"><a href="#__codelineno-6-446">446</a></span>
<span class="normal"><a href="#__codelineno-6-447">447</a></span>
<span class="normal"><a href="#__codelineno-6-448">448</a></span>
<span class="normal"><a href="#__codelineno-6-449">449</a></span>
<span class="normal"><a href="#__codelineno-6-450">450</a></span>
<span class="normal"><a href="#__codelineno-6-451">451</a></span>
<span class="normal"><a href="#__codelineno-6-452">452</a></span>
<span class="normal"><a href="#__codelineno-6-453">453</a></span>
<span class="normal"><a href="#__codelineno-6-454">454</a></span>
<span class="normal"><a href="#__codelineno-6-455">455</a></span>
<span class="normal"><a href="#__codelineno-6-456">456</a></span>
<span class="normal"><a href="#__codelineno-6-457">457</a></span>
<span class="normal"><a href="#__codelineno-6-458">458</a></span>
<span class="normal"><a href="#__codelineno-6-459">459</a></span>
<span class="normal"><a href="#__codelineno-6-460">460</a></span>
<span class="normal"><a href="#__codelineno-6-461">461</a></span>
<span class="normal"><a href="#__codelineno-6-462">462</a></span>
<span class="normal"><a href="#__codelineno-6-463">463</a></span>
<span class="normal"><a href="#__codelineno-6-464">464</a></span>
<span class="normal"><a href="#__codelineno-6-465">465</a></span>
<span class="normal"><a href="#__codelineno-6-466">466</a></span>
<span class="normal"><a href="#__codelineno-6-467">467</a></span>
<span class="normal"><a href="#__codelineno-6-468">468</a></span>
<span class="normal"><a href="#__codelineno-6-469">469</a></span>
<span class="normal"><a href="#__codelineno-6-470">470</a></span>
<span class="normal"><a href="#__codelineno-6-471">471</a></span>
<span class="normal"><a href="#__codelineno-6-472">472</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="sd">Keypoint Detection Inference &amp; Visualization Script</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="sd">功能：</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="sd">1. 支持单样本推理：计算误差 + Open3D 可视化（球体=真值，立方体=预测）</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="sd">2. 支持批量推理：计算整个数据集的平均误差 (Mean) 和标准差 (Std)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="sd">3. 架构通用：通过 config 文件自动加载对应的模型架构</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">open3d</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">o3d</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="c1"># 添加项目根目录到 python path，确保能导入 pointcept</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;../../&quot;</span><span class="p">)))</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.utils.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span><span class="p">,</span> <span class="n">DictAction</span>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_model</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_dataset</span><span class="p">,</span> <span class="n">point_collate_fn</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.utils.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">intersection_and_union</span><span class="p">,</span> <span class="n">make_dirs</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pointcept.engines.defaults</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_argument_parser</span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_args</span><span class="p">():</span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Pointcept Keypoint Inference&quot;</span><span class="p">)</span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--config-file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;configs/my_dataset/keypoint_ptv3.py&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;配置文件路径&quot;</span><span class="p">)</span>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--options&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">DictAction</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;覆盖配置文件的参数&quot;</span><span class="p">)</span>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--weights&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;模型权重文件路径 (.pth)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--subset&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;数据集划分&quot;</span><span class="p">)</span>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--idx&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;单样本索引。如果为 -1，则进行批量推理&quot;</span><span class="p">)</span>
<a id="__codelineno-6-34" name="__codelineno-6-34"></a>
<a id="__codelineno-6-35" name="__codelineno-6-35"></a>    <span class="c1"># 可视化参数</span>
<a id="__codelineno-6-36" name="__codelineno-6-36"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--visualize&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;是否开启 Open3D 可视化 (仅单样本模式有效)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-37" name="__codelineno-6-37"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--sphere-radius&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;真实关键点(球)的半径&quot;</span><span class="p">)</span>
<a id="__codelineno-6-38" name="__codelineno-6-38"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--cube-size&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;预测关键点(正方体)的边长&quot;</span><span class="p">)</span>
<a id="__codelineno-6-39" name="__codelineno-6-39"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--point-size&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Open3D 可视化时点云的点大小&quot;</span><span class="p">)</span>
<a id="__codelineno-6-40" name="__codelineno-6-40"></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--save-dir&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;结果保存路径 (可选)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-41" name="__codelineno-6-41"></a>
<a id="__codelineno-6-42" name="__codelineno-6-42"></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<a id="__codelineno-6-43" name="__codelineno-6-43"></a>    <span class="k">return</span> <span class="n">args</span>
<a id="__codelineno-6-44" name="__codelineno-6-44"></a>
<a id="__codelineno-6-45" name="__codelineno-6-45"></a><span class="k">def</span><span class="w"> </span><span class="nf">setup_model</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">weights_path</span><span class="p">):</span>
<a id="__codelineno-6-46" name="__codelineno-6-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;加载模型和权重&quot;&quot;&quot;</span>
<a id="__codelineno-6-47" name="__codelineno-6-47"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&gt; Building model from config: </span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-48" name="__codelineno-6-48"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-6-49" name="__codelineno-6-49"></a>
<a id="__codelineno-6-50" name="__codelineno-6-50"></a>    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">weights_path</span><span class="p">):</span>
<a id="__codelineno-6-51" name="__codelineno-6-51"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&gt; Loading weights from </span><span class="si">{</span><span class="n">weights_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-52" name="__codelineno-6-52"></a>        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">weights_path</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<a id="__codelineno-6-53" name="__codelineno-6-53"></a>        <span class="n">state_dict</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;state_dict&quot;</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">)</span>
<a id="__codelineno-6-54" name="__codelineno-6-54"></a>        <span class="c1"># 移除 &#39;module.&#39; 前缀 (如果是 DDP 训练保存的)</span>
<a id="__codelineno-6-55" name="__codelineno-6-55"></a>        <span class="n">new_state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;module.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-6-56" name="__codelineno-6-56"></a>        <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">new_state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-6-57" name="__codelineno-6-57"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-58" name="__codelineno-6-58"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No weights found at </span><span class="si">{</span><span class="n">weights_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-59" name="__codelineno-6-59"></a>
<a id="__codelineno-6-60" name="__codelineno-6-60"></a>    <span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<a id="__codelineno-6-61" name="__codelineno-6-61"></a>    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-6-62" name="__codelineno-6-62"></a>    <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-6-63" name="__codelineno-6-63"></a>
<a id="__codelineno-6-64" name="__codelineno-6-64"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_colored_mesh</span><span class="p">(</span><span class="n">geometry_type</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<a id="__codelineno-6-65" name="__codelineno-6-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;创建带颜色的几何体 (球或立方体)&quot;&quot;&quot;</span>
<a id="__codelineno-6-66" name="__codelineno-6-66"></a>    <span class="k">if</span> <span class="n">geometry_type</span> <span class="o">==</span> <span class="s1">&#39;sphere&#39;</span><span class="p">:</span>
<a id="__codelineno-6-67" name="__codelineno-6-67"></a>        <span class="n">mesh</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">TriangleMesh</span><span class="o">.</span><span class="n">create_sphere</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-6-68" name="__codelineno-6-68"></a>    <span class="k">elif</span> <span class="n">geometry_type</span> <span class="o">==</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span>
<a id="__codelineno-6-69" name="__codelineno-6-69"></a>        <span class="n">mesh</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">TriangleMesh</span><span class="o">.</span><span class="n">create_box</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-6-70" name="__codelineno-6-70"></a>        <span class="c1"># Box 默认原点在角落，需要平移到中心</span>
<a id="__codelineno-6-71" name="__codelineno-6-71"></a>        <span class="n">mesh</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<a id="__codelineno-6-72" name="__codelineno-6-72"></a>
<a id="__codelineno-6-73" name="__codelineno-6-73"></a>    <span class="n">mesh</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
<a id="__codelineno-6-74" name="__codelineno-6-74"></a>    <span class="n">mesh</span><span class="o">.</span><span class="n">paint_uniform_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
<a id="__codelineno-6-75" name="__codelineno-6-75"></a>    <span class="k">return</span> <span class="n">mesh</span>
<a id="__codelineno-6-76" name="__codelineno-6-76"></a>
<a id="__codelineno-6-77" name="__codelineno-6-77"></a><span class="k">def</span><span class="w"> </span><span class="nf">visualize_single</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">pred_kps</span><span class="p">,</span> <span class="n">target_kps</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-78" name="__codelineno-6-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;使用 Open3D 可视化 (支持调整点大小)&quot;&quot;&quot;</span>
<a id="__codelineno-6-79" name="__codelineno-6-79"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&gt; Visualizing... (Point Size: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">point_size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-80" name="__codelineno-6-80"></a>    <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-6-81" name="__codelineno-6-81"></a>
<a id="__codelineno-6-82" name="__codelineno-6-82"></a>    <span class="c1"># 1. 点云 (灰色)</span>
<a id="__codelineno-6-83" name="__codelineno-6-83"></a>    <span class="n">pcd</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">PointCloud</span><span class="p">()</span>
<a id="__codelineno-6-84" name="__codelineno-6-84"></a>    <span class="n">pcd</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">utility</span><span class="o">.</span><span class="n">Vector3dVector</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
<a id="__codelineno-6-85" name="__codelineno-6-85"></a>    <span class="n">pcd</span><span class="o">.</span><span class="n">paint_uniform_color</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span> <span class="c1"># 灰色点云</span>
<a id="__codelineno-6-86" name="__codelineno-6-86"></a>    <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pcd</span><span class="p">)</span>
<a id="__codelineno-6-87" name="__codelineno-6-87"></a>
<a id="__codelineno-6-88" name="__codelineno-6-88"></a>    <span class="c1"># 2. 关键点颜色映射</span>
<a id="__codelineno-6-89" name="__codelineno-6-89"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
<a id="__codelineno-6-90" name="__codelineno-6-90"></a>    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_kps</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_kps</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_kps</span><span class="p">)]</span>
<a id="__codelineno-6-91" name="__codelineno-6-91"></a>
<a id="__codelineno-6-92" name="__codelineno-6-92"></a>    <span class="c1"># 3. 绘制关键点</span>
<a id="__codelineno-6-93" name="__codelineno-6-93"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-94" name="__codelineno-6-94"></a>        <span class="c1"># 真实值：圆球 (Sphere)</span>
<a id="__codelineno-6-95" name="__codelineno-6-95"></a>        <span class="k">if</span> <span class="n">target_kps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-96" name="__codelineno-6-96"></a>            <span class="n">sphere</span> <span class="o">=</span> <span class="n">create_colored_mesh</span><span class="p">(</span><span class="s1">&#39;sphere&#39;</span><span class="p">,</span> <span class="n">target_kps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">args</span><span class="o">.</span><span class="n">sphere_radius</span><span class="p">)</span>
<a id="__codelineno-6-97" name="__codelineno-6-97"></a>            <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sphere</span><span class="p">)</span>
<a id="__codelineno-6-98" name="__codelineno-6-98"></a>
<a id="__codelineno-6-99" name="__codelineno-6-99"></a>        <span class="c1"># 预测值：正方体 (Cube)</span>
<a id="__codelineno-6-100" name="__codelineno-6-100"></a>        <span class="n">cube</span> <span class="o">=</span> <span class="n">create_colored_mesh</span><span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">pred_kps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">args</span><span class="o">.</span><span class="n">cube_size</span><span class="p">)</span>
<a id="__codelineno-6-101" name="__codelineno-6-101"></a>        <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<a id="__codelineno-6-102" name="__codelineno-6-102"></a>
<a id="__codelineno-6-103" name="__codelineno-6-103"></a>    <span class="c1"># 4. [修改核心] 使用 Visualizer 来控制渲染选项</span>
<a id="__codelineno-6-104" name="__codelineno-6-104"></a>    <span class="n">vis</span> <span class="o">=</span> <span class="n">o3d</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">Visualizer</span><span class="p">()</span>
<a id="__codelineno-6-105" name="__codelineno-6-105"></a>    <span class="n">vis</span><span class="o">.</span><span class="n">create_window</span><span class="p">(</span><span class="n">window_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Sample </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">idx</span><span class="si">}</span><span class="s2"> (Sphere=GT, Cube=Pred)&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">768</span><span class="p">)</span>
<a id="__codelineno-6-106" name="__codelineno-6-106"></a>
<a id="__codelineno-6-107" name="__codelineno-6-107"></a>    <span class="c1"># 添加所有几何体</span>
<a id="__codelineno-6-108" name="__codelineno-6-108"></a>    <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
<a id="__codelineno-6-109" name="__codelineno-6-109"></a>        <span class="n">vis</span><span class="o">.</span><span class="n">add_geometry</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
<a id="__codelineno-6-110" name="__codelineno-6-110"></a>
<a id="__codelineno-6-111" name="__codelineno-6-111"></a>    <span class="c1"># 获取并修改渲染选项</span>
<a id="__codelineno-6-112" name="__codelineno-6-112"></a>    <span class="n">opt</span> <span class="o">=</span> <span class="n">vis</span><span class="o">.</span><span class="n">get_render_option</span><span class="p">()</span>
<a id="__codelineno-6-113" name="__codelineno-6-113"></a>    <span class="n">opt</span><span class="o">.</span><span class="n">point_size</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">point_size</span>        <span class="c1"># [关键] 设置点的大小</span>
<a id="__codelineno-6-114" name="__codelineno-6-114"></a>    <span class="n">opt</span><span class="o">.</span><span class="n">background_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># [可选] 设置背景为白色，看起来更清晰</span>
<a id="__codelineno-6-115" name="__codelineno-6-115"></a>
<a id="__codelineno-6-116" name="__codelineno-6-116"></a>    <span class="n">vis</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<a id="__codelineno-6-117" name="__codelineno-6-117"></a>    <span class="n">vis</span><span class="o">.</span><span class="n">destroy_window</span><span class="p">()</span>
<a id="__codelineno-6-118" name="__codelineno-6-118"></a>
<a id="__codelineno-6-119" name="__codelineno-6-119"></a>
<a id="__codelineno-6-120" name="__codelineno-6-120"></a><span class="k">def</span><span class="w"> </span><span class="nf">inference_single_sample</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<a id="__codelineno-6-121" name="__codelineno-6-121"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;单样本推理逻辑&quot;&quot;&quot;</span>
<a id="__codelineno-6-122" name="__codelineno-6-122"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">idx</span>
<a id="__codelineno-6-123" name="__codelineno-6-123"></a>    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
<a id="__codelineno-6-124" name="__codelineno-6-124"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> out of bounds (Dataset size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-125" name="__codelineno-6-125"></a>        <span class="k">return</span>
<a id="__codelineno-6-126" name="__codelineno-6-126"></a>
<a id="__codelineno-6-127" name="__codelineno-6-127"></a>    <span class="c1"># 1. 获取数据</span>
<a id="__codelineno-6-128" name="__codelineno-6-128"></a>    <span class="n">data_dict</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-6-129" name="__codelineno-6-129"></a>    <span class="c1"># Collate: 即使是单个样本，也需要伪造成 batch 为 1 的形式 (增加 batch 维度)</span>
<a id="__codelineno-6-130" name="__codelineno-6-130"></a>    <span class="n">data_dict</span> <span class="o">=</span> <span class="n">point_collate_fn</span><span class="p">([</span><span class="n">data_dict</span><span class="p">])</span>
<a id="__codelineno-6-131" name="__codelineno-6-131"></a>
<a id="__codelineno-6-132" name="__codelineno-6-132"></a>    <span class="c1"># 转移到 GPU</span>
<a id="__codelineno-6-133" name="__codelineno-6-133"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-134" name="__codelineno-6-134"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-6-135" name="__codelineno-6-135"></a>            <span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-6-136" name="__codelineno-6-136"></a>
<a id="__codelineno-6-137" name="__codelineno-6-137"></a>    <span class="c1"># 2. 推理</span>
<a id="__codelineno-6-138" name="__codelineno-6-138"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-6-139" name="__codelineno-6-139"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<a id="__codelineno-6-140" name="__codelineno-6-140"></a>        <span class="c1"># 兼容不同的返回格式 (有的模型返回字典，有的返回 Tensor)</span>
<a id="__codelineno-6-141" name="__codelineno-6-141"></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">result</span>
<a id="__codelineno-6-142" name="__codelineno-6-142"></a>
<a id="__codelineno-6-143" name="__codelineno-6-143"></a>    <span class="c1"># 3. 数据后处理 (GPU -&gt; CPU -&gt; Numpy)</span>
<a id="__codelineno-6-144" name="__codelineno-6-144"></a>    <span class="c1"># pred shape: (1, K, 3) -&gt; (K, 3)</span>
<a id="__codelineno-6-145" name="__codelineno-6-145"></a>    <span class="c1"># target shape: (1, K, 3) -&gt; (K, 3)</span>
<a id="__codelineno-6-146" name="__codelineno-6-146"></a>    <span class="n">num_kps</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_keypoints</span>
<a id="__codelineno-6-147" name="__codelineno-6-147"></a>    <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-6-148" name="__codelineno-6-148"></a>
<a id="__codelineno-6-149" name="__codelineno-6-149"></a>    <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-6-150" name="__codelineno-6-150"></a>    <span class="k">if</span> <span class="s2">&quot;target&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-151" name="__codelineno-6-151"></a>        <span class="n">target</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-6-152" name="__codelineno-6-152"></a>
<a id="__codelineno-6-153" name="__codelineno-6-153"></a>    <span class="c1"># 获取点云坐标用于可视化 (优先用原始 coord，如果没有则用 grid_coord * grid_size)</span>
<a id="__codelineno-6-154" name="__codelineno-6-154"></a>    <span class="n">coord</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-6-155" name="__codelineno-6-155"></a>
<a id="__codelineno-6-156" name="__codelineno-6-156"></a>    <span class="c1"># 4. 计算误差 (逆归一化)</span>
<a id="__codelineno-6-157" name="__codelineno-6-157"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-6-158" name="__codelineno-6-158"></a>    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-159" name="__codelineno-6-159"></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># (1,) -&gt; scalar</span>
<a id="__codelineno-6-160" name="__codelineno-6-160"></a>    <span class="k">elif</span> <span class="s2">&quot;grid_size&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-161" name="__codelineno-6-161"></a>        <span class="c1"># 如果没有 scale 只有 grid_size，且 target 是体素坐标，则用 grid_size</span>
<a id="__codelineno-6-162" name="__codelineno-6-162"></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;grid_size&quot;</span><span class="p">]</span>
<a id="__codelineno-6-163" name="__codelineno-6-163"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-6-164" name="__codelineno-6-164"></a>
<a id="__codelineno-6-165" name="__codelineno-6-165"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">====== Inference Result [Sample IDX: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">] ======&quot;</span><span class="p">)</span>
<a id="__codelineno-6-166" name="__codelineno-6-166"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scale Factor: </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-167" name="__codelineno-6-167"></a>
<a id="__codelineno-6-168" name="__codelineno-6-168"></a>    <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-169" name="__codelineno-6-169"></a>        <span class="c1"># 计算欧氏距离</span>
<a id="__codelineno-6-170" name="__codelineno-6-170"></a>        <span class="c1"># 注意：pred 和 target 目前通常是在归一化坐标系下</span>
<a id="__codelineno-6-171" name="__codelineno-6-171"></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (K,)</span>
<a id="__codelineno-6-172" name="__codelineno-6-172"></a>
<a id="__codelineno-6-173" name="__codelineno-6-173"></a>        <span class="c1"># 逆归一化到原始物理尺度</span>
<a id="__codelineno-6-174" name="__codelineno-6-174"></a>        <span class="n">real_diff</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">*</span> <span class="n">scale</span> 
<a id="__codelineno-6-175" name="__codelineno-6-175"></a>
<a id="__codelineno-6-176" name="__codelineno-6-176"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-6-177" name="__codelineno-6-177"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Keypoint ID&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Error (Original Scale)&#39;</span><span class="si">:</span><span class="s2">&lt;25</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-178" name="__codelineno-6-178"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-6-179" name="__codelineno-6-179"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-180" name="__codelineno-6-180"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KP </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">real_diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-181" name="__codelineno-6-181"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-6-182" name="__codelineno-6-182"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Error      | </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">real_diff</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-183" name="__codelineno-6-183"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-6-184" name="__codelineno-6-184"></a>
<a id="__codelineno-6-185" name="__codelineno-6-185"></a>    <span class="c1"># 5. 可视化</span>
<a id="__codelineno-6-186" name="__codelineno-6-186"></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">visualize</span><span class="p">:</span>
<a id="__codelineno-6-187" name="__codelineno-6-187"></a>        <span class="c1"># 坐标通常也需要缩放以便可视化正确（如果 coord 也是归一化的）</span>
<a id="__codelineno-6-188" name="__codelineno-6-188"></a>        <span class="c1"># 这里我们直接画归一化空间下的，或者全部乘 scale</span>
<a id="__codelineno-6-189" name="__codelineno-6-189"></a>        <span class="c1"># 为了方便观察相对位置，直接画归一化空间下的即可，只要 scale 一致</span>
<a id="__codelineno-6-190" name="__codelineno-6-190"></a>        <span class="n">visualize_single</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">)</span>
<a id="__codelineno-6-191" name="__codelineno-6-191"></a>
<a id="__codelineno-6-192" name="__codelineno-6-192"></a>
<a id="__codelineno-6-193" name="__codelineno-6-193"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_batch_errors</span><span class="p">(</span><span class="n">all_errors</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-194" name="__codelineno-6-194"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-195" name="__codelineno-6-195"></a><span class="sd">    绘制关键点误差散点图</span>
<a id="__codelineno-6-196" name="__codelineno-6-196"></a><span class="sd">    layout: 2行3列 (针对6个关键点)</span>
<a id="__codelineno-6-197" name="__codelineno-6-197"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-6-198" name="__codelineno-6-198"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="__codelineno-6-199" name="__codelineno-6-199"></a>
<a id="__codelineno-6-200" name="__codelineno-6-200"></a>    <span class="c1"># 设置绘图风格</span>
<a id="__codelineno-6-201" name="__codelineno-6-201"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<a id="__codelineno-6-202" name="__codelineno-6-202"></a>
<a id="__codelineno-6-203" name="__codelineno-6-203"></a>    <span class="c1"># 创建画布，2行3列</span>
<a id="__codelineno-6-204" name="__codelineno-6-204"></a>    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<a id="__codelineno-6-205" name="__codelineno-6-205"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-6-206" name="__codelineno-6-206"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Keypoint Prediction Errors (Batch Inference)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-6-207" name="__codelineno-6-207"></a>
<a id="__codelineno-6-208" name="__codelineno-6-208"></a>    <span class="c1"># 展平 axes 方便索引</span>
<a id="__codelineno-6-209" name="__codelineno-6-209"></a>    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<a id="__codelineno-6-210" name="__codelineno-6-210"></a>
<a id="__codelineno-6-211" name="__codelineno-6-211"></a>    <span class="c1"># 样本序号 (X轴)</span>
<a id="__codelineno-6-212" name="__codelineno-6-212"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">all_errors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-6-213" name="__codelineno-6-213"></a>
<a id="__codelineno-6-214" name="__codelineno-6-214"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-215" name="__codelineno-6-215"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span> <span class="k">break</span> <span class="c1"># 防止关键点数量超过子图数量</span>
<a id="__codelineno-6-216" name="__codelineno-6-216"></a>
<a id="__codelineno-6-217" name="__codelineno-6-217"></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-6-218" name="__codelineno-6-218"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">all_errors</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="c1"># 第 i 个关键点的所有样本误差</span>
<a id="__codelineno-6-219" name="__codelineno-6-219"></a>
<a id="__codelineno-6-220" name="__codelineno-6-220"></a>        <span class="c1"># 统计指标</span>
<a id="__codelineno-6-221" name="__codelineno-6-221"></a>        <span class="n">mean_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-6-222" name="__codelineno-6-222"></a>        <span class="n">std_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-6-223" name="__codelineno-6-223"></a>        <span class="n">upper_limit</span> <span class="o">=</span> <span class="n">mean_val</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">std_val</span>
<a id="__codelineno-6-224" name="__codelineno-6-224"></a>
<a id="__codelineno-6-225" name="__codelineno-6-225"></a>        <span class="c1"># 1. 绘制散点</span>
<a id="__codelineno-6-226" name="__codelineno-6-226"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sample Error&#39;</span><span class="p">)</span>
<a id="__codelineno-6-227" name="__codelineno-6-227"></a>
<a id="__codelineno-6-228" name="__codelineno-6-228"></a>        <span class="c1"># 2. 绘制平均值虚线 (红色)</span>
<a id="__codelineno-6-229" name="__codelineno-6-229"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_val</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean: </span><span class="si">{</span><span class="n">mean_val</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-230" name="__codelineno-6-230"></a>
<a id="__codelineno-6-231" name="__codelineno-6-231"></a>        <span class="c1"># 3. 绘制 2*标准差 虚线 (绿色)</span>
<a id="__codelineno-6-232" name="__codelineno-6-232"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">upper_limit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean+2Std: </span><span class="si">{</span><span class="n">upper_limit</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-233" name="__codelineno-6-233"></a>
<a id="__codelineno-6-234" name="__codelineno-6-234"></a>        <span class="c1"># 标签设置</span>
<a id="__codelineno-6-235" name="__codelineno-6-235"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Keypoint </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-6-236" name="__codelineno-6-236"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample Index&#39;</span><span class="p">)</span>
<a id="__codelineno-6-237" name="__codelineno-6-237"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error (m)&#39;</span><span class="p">)</span>
<a id="__codelineno-6-238" name="__codelineno-6-238"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-6-239" name="__codelineno-6-239"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-6-240" name="__codelineno-6-240"></a>
<a id="__codelineno-6-241" name="__codelineno-6-241"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span> <span class="c1"># 调整布局防止重叠</span>
<a id="__codelineno-6-242" name="__codelineno-6-242"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># 弹出窗口</span>
<a id="__codelineno-6-243" name="__codelineno-6-243"></a>
<a id="__codelineno-6-244" name="__codelineno-6-244"></a><span class="k">def</span><span class="w"> </span><span class="nf">inference_batch</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<a id="__codelineno-6-245" name="__codelineno-6-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;批量推理逻辑&quot;&quot;&quot;</span>
<a id="__codelineno-6-246" name="__codelineno-6-246"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&gt; Start Batch Inference on [</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">subset</span><span class="si">}</span><span class="s2">] set...&quot;</span><span class="p">)</span>
<a id="__codelineno-6-247" name="__codelineno-6-247"></a>    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<a id="__codelineno-6-248" name="__codelineno-6-248"></a>        <span class="n">dataset</span><span class="p">,</span> 
<a id="__codelineno-6-249" name="__codelineno-6-249"></a>        <span class="n">batch_size</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">batch_size</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;batch_size&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-6-250" name="__codelineno-6-250"></a>        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-6-251" name="__codelineno-6-251"></a>        <span class="n">num_workers</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_worker</span><span class="p">,</span> 
<a id="__codelineno-6-252" name="__codelineno-6-252"></a>        <span class="n">collate_fn</span><span class="o">=</span><span class="n">point_collate_fn</span><span class="p">,</span>
<a id="__codelineno-6-253" name="__codelineno-6-253"></a>        <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-6-254" name="__codelineno-6-254"></a>    <span class="p">)</span>
<a id="__codelineno-6-255" name="__codelineno-6-255"></a>
<a id="__codelineno-6-256" name="__codelineno-6-256"></a>    <span class="n">num_kps</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_keypoints</span>
<a id="__codelineno-6-257" name="__codelineno-6-257"></a>    <span class="n">all_errors</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 存储所有样本所有关键点的误差</span>
<a id="__codelineno-6-258" name="__codelineno-6-258"></a>
<a id="__codelineno-6-259" name="__codelineno-6-259"></a>    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-6-260" name="__codelineno-6-260"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-6-261" name="__codelineno-6-261"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data_dict</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)):</span>
<a id="__codelineno-6-262" name="__codelineno-6-262"></a>            <span class="c1"># GPU</span>
<a id="__codelineno-6-263" name="__codelineno-6-263"></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-264" name="__codelineno-6-264"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-6-265" name="__codelineno-6-265"></a>                    <span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">cuda</span><span class="p">(</span><span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-6-266" name="__codelineno-6-266"></a>
<a id="__codelineno-6-267" name="__codelineno-6-267"></a>            <span class="c1"># Forward</span>
<a id="__codelineno-6-268" name="__codelineno-6-268"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
<a id="__codelineno-6-269" name="__codelineno-6-269"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">result</span>
<a id="__codelineno-6-270" name="__codelineno-6-270"></a>
<a id="__codelineno-6-271" name="__codelineno-6-271"></a>            <span class="n">target</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
<a id="__codelineno-6-272" name="__codelineno-6-272"></a>
<a id="__codelineno-6-273" name="__codelineno-6-273"></a>            <span class="c1"># Reshape (B, K, 3)</span>
<a id="__codelineno-6-274" name="__codelineno-6-274"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-6-275" name="__codelineno-6-275"></a>            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-6-276" name="__codelineno-6-276"></a>
<a id="__codelineno-6-277" name="__codelineno-6-277"></a>            <span class="c1"># Calc Distance in Normalized Space</span>
<a id="__codelineno-6-278" name="__codelineno-6-278"></a>            <span class="n">dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">target</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># (B, K)</span>
<a id="__codelineno-6-279" name="__codelineno-6-279"></a>
<a id="__codelineno-6-280" name="__codelineno-6-280"></a>            <span class="c1"># Inverse Normalization</span>
<a id="__codelineno-6-281" name="__codelineno-6-281"></a>            <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-282" name="__codelineno-6-282"></a>                <span class="n">scale</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span> <span class="c1"># (B,)</span>
<a id="__codelineno-6-283" name="__codelineno-6-283"></a>                <span class="k">if</span> <span class="n">scale</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-6-284" name="__codelineno-6-284"></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">*</span> <span class="n">scale</span>
<a id="__codelineno-6-285" name="__codelineno-6-285"></a>            <span class="k">elif</span> <span class="s2">&quot;grid_size&quot;</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
<a id="__codelineno-6-286" name="__codelineno-6-286"></a>                <span class="c1"># Fallback logic</span>
<a id="__codelineno-6-287" name="__codelineno-6-287"></a>                <span class="n">g</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;grid_size&quot;</span><span class="p">]</span>
<a id="__codelineno-6-288" name="__codelineno-6-288"></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">*</span> <span class="n">g</span>
<a id="__codelineno-6-289" name="__codelineno-6-289"></a>
<a id="__codelineno-6-290" name="__codelineno-6-290"></a>            <span class="n">all_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<a id="__codelineno-6-291" name="__codelineno-6-291"></a>
<a id="__codelineno-6-292" name="__codelineno-6-292"></a>    <span class="c1"># Concatenate all batches: (Total_Samples, K)</span>
<a id="__codelineno-6-293" name="__codelineno-6-293"></a>    <span class="n">all_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">all_errors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-6-294" name="__codelineno-6-294"></a>
<a id="__codelineno-6-295" name="__codelineno-6-295"></a>    <span class="c1"># Statistics</span>
<a id="__codelineno-6-296" name="__codelineno-6-296"></a>    <span class="n">mean_per_kp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_errors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-6-297" name="__codelineno-6-297"></a>    <span class="n">std_per_kp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">all_errors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-6-298" name="__codelineno-6-298"></a>    <span class="n">total_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_errors</span><span class="p">)</span>
<a id="__codelineno-6-299" name="__codelineno-6-299"></a>
<a id="__codelineno-6-300" name="__codelineno-6-300"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">====== Batch Inference Statistics ======&quot;</span><span class="p">)</span>
<a id="__codelineno-6-301" name="__codelineno-6-301"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Samples: </span><span class="si">{</span><span class="n">all_errors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-302" name="__codelineno-6-302"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
<a id="__codelineno-6-303" name="__codelineno-6-303"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Keypoint ID&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Mean Error&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Std Dev&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-304" name="__codelineno-6-304"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
<a id="__codelineno-6-305" name="__codelineno-6-305"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_kps</span><span class="p">):</span>
<a id="__codelineno-6-306" name="__codelineno-6-306"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KP </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">mean_per_kp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">            | </span><span class="si">{</span><span class="n">std_per_kp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-307" name="__codelineno-6-307"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
<a id="__codelineno-6-308" name="__codelineno-6-308"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;OVERALL&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">total_mean</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-309" name="__codelineno-6-309"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">65</span><span class="p">)</span>
<a id="__codelineno-6-310" name="__codelineno-6-310"></a>
<a id="__codelineno-6-311" name="__codelineno-6-311"></a>    <span class="c1"># [新增] 调用绘图函数</span>
<a id="__codelineno-6-312" name="__codelineno-6-312"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&gt; Plotting error distribution...&quot;</span><span class="p">)</span>
<a id="__codelineno-6-313" name="__codelineno-6-313"></a>    <span class="n">plot_batch_errors</span><span class="p">(</span><span class="n">all_errors</span><span class="p">,</span> <span class="n">num_kps</span><span class="p">)</span>
<a id="__codelineno-6-314" name="__codelineno-6-314"></a>
<a id="__codelineno-6-315" name="__codelineno-6-315"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-6-316" name="__codelineno-6-316"></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<a id="__codelineno-6-317" name="__codelineno-6-317"></a>
<a id="__codelineno-6-318" name="__codelineno-6-318"></a>    <span class="c1"># 1. 加载配置</span>
<a id="__codelineno-6-319" name="__codelineno-6-319"></a>    <span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">config_file</span><span class="p">)</span>
<a id="__codelineno-6-320" name="__codelineno-6-320"></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
<a id="__codelineno-6-321" name="__codelineno-6-321"></a>        <span class="n">cfg</span><span class="o">.</span><span class="n">merge_from_dict</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-6-322" name="__codelineno-6-322"></a>
<a id="__codelineno-6-323" name="__codelineno-6-323"></a>    <span class="c1"># 2. 构建模型</span>
<a id="__codelineno-6-324" name="__codelineno-6-324"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">setup_model</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
<a id="__codelineno-6-325" name="__codelineno-6-325"></a>
<a id="__codelineno-6-326" name="__codelineno-6-326"></a>    <span class="c1"># 3. 构建数据集</span>
<a id="__codelineno-6-327" name="__codelineno-6-327"></a>    <span class="c1"># 注意：只构建 args.subset 指定的那一部分 (train/val/test)</span>
<a id="__codelineno-6-328" name="__codelineno-6-328"></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">subset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
<a id="__codelineno-6-329" name="__codelineno-6-329"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subset </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">subset</span><span class="si">}</span><span class="s2"> not found in config.data&quot;</span><span class="p">)</span>
<a id="__codelineno-6-330" name="__codelineno-6-330"></a>
<a id="__codelineno-6-331" name="__codelineno-6-331"></a>    <span class="n">dataset_cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">subset</span><span class="p">]</span>
<a id="__codelineno-6-332" name="__codelineno-6-332"></a>    <span class="n">dataset_cfg</span><span class="o">.</span><span class="n">data_root</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">data_root</span> <span class="c1"># 确保 data_root 被正确传递</span>
<a id="__codelineno-6-333" name="__codelineno-6-333"></a>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">build_dataset</span><span class="p">(</span><span class="n">dataset_cfg</span><span class="p">)</span>
<a id="__codelineno-6-334" name="__codelineno-6-334"></a>
<a id="__codelineno-6-335" name="__codelineno-6-335"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&gt; Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples from </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">subset</span><span class="si">}</span><span class="s2"> set.&quot;</span><span class="p">)</span>
<a id="__codelineno-6-336" name="__codelineno-6-336"></a>
<a id="__codelineno-6-337" name="__codelineno-6-337"></a>    <span class="c1"># 4. 执行推理</span>
<a id="__codelineno-6-338" name="__codelineno-6-338"></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-6-339" name="__codelineno-6-339"></a>        <span class="c1"># 单样本模式</span>
<a id="__codelineno-6-340" name="__codelineno-6-340"></a>        <span class="n">inference_single_sample</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<a id="__codelineno-6-341" name="__codelineno-6-341"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-342" name="__codelineno-6-342"></a>        <span class="c1"># 批量模式</span>
<a id="__codelineno-6-343" name="__codelineno-6-343"></a>        <span class="n">inference_batch</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
<a id="__codelineno-6-344" name="__codelineno-6-344"></a>
<a id="__codelineno-6-345" name="__codelineno-6-345"></a>
<a id="__codelineno-6-346" name="__codelineno-6-346"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-347" name="__codelineno-6-347"></a><span class="sd">## 基于 Pointcept-PTv3 模型的推理脚本</span>
<a id="__codelineno-6-348" name="__codelineno-6-348"></a><span class="sd">python tools/inference.py \</span>
<a id="__codelineno-6-349" name="__codelineno-6-349"></a><span class="sd">    --config-file configs/my_dataset/keypoint_ptv3.py \</span>
<a id="__codelineno-6-350" name="__codelineno-6-350"></a><span class="sd">    --weights exp/keypoint_ptv3/model/model_best.pth \</span>
<a id="__codelineno-6-351" name="__codelineno-6-351"></a><span class="sd">    --subset test \</span>
<a id="__codelineno-6-352" name="__codelineno-6-352"></a><span class="sd">    --idx -1 \</span>
<a id="__codelineno-6-353" name="__codelineno-6-353"></a><span class="sd">    --visualize \</span>
<a id="__codelineno-6-354" name="__codelineno-6-354"></a><span class="sd">    --sphere-radius 0.02 \</span>
<a id="__codelineno-6-355" name="__codelineno-6-355"></a><span class="sd">    --cube-size 0.02</span>
<a id="__codelineno-6-356" name="__codelineno-6-356"></a><span class="sd">====== Batch Inference Statistics ======</span>
<a id="__codelineno-6-357" name="__codelineno-6-357"></a><span class="sd">Total Samples: 28</span>
<a id="__codelineno-6-358" name="__codelineno-6-358"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-359" name="__codelineno-6-359"></a><span class="sd">Keypoint ID     | Mean Error           | Std Dev             </span>
<a id="__codelineno-6-360" name="__codelineno-6-360"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-361" name="__codelineno-6-361"></a><span class="sd">KP 0            | 22.65371            | 13.36939</span>
<a id="__codelineno-6-362" name="__codelineno-6-362"></a><span class="sd">KP 1            | 21.20184            | 13.95168</span>
<a id="__codelineno-6-363" name="__codelineno-6-363"></a><span class="sd">KP 2            | 30.23071            | 20.58898</span>
<a id="__codelineno-6-364" name="__codelineno-6-364"></a><span class="sd">KP 3            | 27.92994            | 20.37176</span>
<a id="__codelineno-6-365" name="__codelineno-6-365"></a><span class="sd">KP 4            | 32.97409            | 18.85650</span>
<a id="__codelineno-6-366" name="__codelineno-6-366"></a><span class="sd">KP 5            | 34.39021            | 21.52718</span>
<a id="__codelineno-6-367" name="__codelineno-6-367"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-368" name="__codelineno-6-368"></a><span class="sd">OVERALL         | 28.23009</span>
<a id="__codelineno-6-369" name="__codelineno-6-369"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-370" name="__codelineno-6-370"></a>
<a id="__codelineno-6-371" name="__codelineno-6-371"></a>
<a id="__codelineno-6-372" name="__codelineno-6-372"></a>
<a id="__codelineno-6-373" name="__codelineno-6-373"></a><span class="sd">## 基于 Pointcept-OctFormer 模型的推理脚本</span>
<a id="__codelineno-6-374" name="__codelineno-6-374"></a><span class="sd">python tools/inference.py \</span>
<a id="__codelineno-6-375" name="__codelineno-6-375"></a><span class="sd">    --config-file configs/my_dataset/keypoint_octformer.py \</span>
<a id="__codelineno-6-376" name="__codelineno-6-376"></a><span class="sd">    --weights exp/keypoint_octformer/model/model_best.pth \</span>
<a id="__codelineno-6-377" name="__codelineno-6-377"></a><span class="sd">    --subset test \</span>
<a id="__codelineno-6-378" name="__codelineno-6-378"></a><span class="sd">    --idx -1 \</span>
<a id="__codelineno-6-379" name="__codelineno-6-379"></a><span class="sd">    --visualize \</span>
<a id="__codelineno-6-380" name="__codelineno-6-380"></a><span class="sd">    --sphere-radius 0.02 \</span>
<a id="__codelineno-6-381" name="__codelineno-6-381"></a><span class="sd">    --cube-size 0.02</span>
<a id="__codelineno-6-382" name="__codelineno-6-382"></a><span class="sd">====== Batch Inference Statistics ======</span>
<a id="__codelineno-6-383" name="__codelineno-6-383"></a><span class="sd">Total Samples: 28</span>
<a id="__codelineno-6-384" name="__codelineno-6-384"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-385" name="__codelineno-6-385"></a><span class="sd">Keypoint ID     | Mean Error           | Std Dev             </span>
<a id="__codelineno-6-386" name="__codelineno-6-386"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-387" name="__codelineno-6-387"></a><span class="sd">KP 0            | 33.27346            | 16.75899</span>
<a id="__codelineno-6-388" name="__codelineno-6-388"></a><span class="sd">KP 1            | 26.27490            | 15.12749</span>
<a id="__codelineno-6-389" name="__codelineno-6-389"></a><span class="sd">KP 2            | 31.13291            | 19.68741</span>
<a id="__codelineno-6-390" name="__codelineno-6-390"></a><span class="sd">KP 3            | 27.60023            | 18.44568</span>
<a id="__codelineno-6-391" name="__codelineno-6-391"></a><span class="sd">KP 4            | 32.59894            | 17.00893</span>
<a id="__codelineno-6-392" name="__codelineno-6-392"></a><span class="sd">KP 5            | 38.96297            | 19.05381</span>
<a id="__codelineno-6-393" name="__codelineno-6-393"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-394" name="__codelineno-6-394"></a><span class="sd">OVERALL         | 31.64057</span>
<a id="__codelineno-6-395" name="__codelineno-6-395"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-396" name="__codelineno-6-396"></a>
<a id="__codelineno-6-397" name="__codelineno-6-397"></a><span class="sd">## 基于 Pointcept-PTv1 模型的推理脚本</span>
<a id="__codelineno-6-398" name="__codelineno-6-398"></a><span class="sd">export PYTHONPATH=.</span>
<a id="__codelineno-6-399" name="__codelineno-6-399"></a><span class="sd">python tools/inference.py \</span>
<a id="__codelineno-6-400" name="__codelineno-6-400"></a><span class="sd">    --config-file configs/my_dataset/keypoint_ptv1.py \</span>
<a id="__codelineno-6-401" name="__codelineno-6-401"></a><span class="sd">    --weights exp/keypoint_ptv1/model/model_best.pth \</span>
<a id="__codelineno-6-402" name="__codelineno-6-402"></a><span class="sd">    --subset test \</span>
<a id="__codelineno-6-403" name="__codelineno-6-403"></a><span class="sd">    --idx -1 \</span>
<a id="__codelineno-6-404" name="__codelineno-6-404"></a><span class="sd">    --visualize \</span>
<a id="__codelineno-6-405" name="__codelineno-6-405"></a><span class="sd">    --sphere-radius 0.02 \</span>
<a id="__codelineno-6-406" name="__codelineno-6-406"></a><span class="sd">    --cube-size 0.02</span>
<a id="__codelineno-6-407" name="__codelineno-6-407"></a><span class="sd">====== Batch Inference Statistics ======</span>
<a id="__codelineno-6-408" name="__codelineno-6-408"></a><span class="sd">Total Samples: 28</span>
<a id="__codelineno-6-409" name="__codelineno-6-409"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-410" name="__codelineno-6-410"></a><span class="sd">Keypoint ID     | Mean Error           | Std Dev             </span>
<a id="__codelineno-6-411" name="__codelineno-6-411"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-412" name="__codelineno-6-412"></a><span class="sd">KP 0            | 26.13216            | 11.06119</span>
<a id="__codelineno-6-413" name="__codelineno-6-413"></a><span class="sd">KP 1            | 24.93169            | 17.54638</span>
<a id="__codelineno-6-414" name="__codelineno-6-414"></a><span class="sd">KP 2            | 31.74557            | 21.16514</span>
<a id="__codelineno-6-415" name="__codelineno-6-415"></a><span class="sd">KP 3            | 24.36304            | 16.39521</span>
<a id="__codelineno-6-416" name="__codelineno-6-416"></a><span class="sd">KP 4            | 22.96082            | 11.83866</span>
<a id="__codelineno-6-417" name="__codelineno-6-417"></a><span class="sd">KP 5            | 32.36544            | 11.43148</span>
<a id="__codelineno-6-418" name="__codelineno-6-418"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-419" name="__codelineno-6-419"></a><span class="sd">OVERALL         | 27.08312</span>
<a id="__codelineno-6-420" name="__codelineno-6-420"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-421" name="__codelineno-6-421"></a>
<a id="__codelineno-6-422" name="__codelineno-6-422"></a><span class="sd">## 基于 Pointcept-PTv2 模型的推理脚本</span>
<a id="__codelineno-6-423" name="__codelineno-6-423"></a><span class="sd">python tools/inference.py \</span>
<a id="__codelineno-6-424" name="__codelineno-6-424"></a><span class="sd">    --config-file configs/my_dataset/keypoint_ptv2.py \</span>
<a id="__codelineno-6-425" name="__codelineno-6-425"></a><span class="sd">    --weights exp/keypoint_ptv2/model/model_best.pth \</span>
<a id="__codelineno-6-426" name="__codelineno-6-426"></a><span class="sd">    --subset train \</span>
<a id="__codelineno-6-427" name="__codelineno-6-427"></a><span class="sd">    --idx -1 \</span>
<a id="__codelineno-6-428" name="__codelineno-6-428"></a><span class="sd">    --visualize \</span>
<a id="__codelineno-6-429" name="__codelineno-6-429"></a><span class="sd">    --sphere-radius 0.02 \</span>
<a id="__codelineno-6-430" name="__codelineno-6-430"></a><span class="sd">    --cube-size 0.02</span>
<a id="__codelineno-6-431" name="__codelineno-6-431"></a><span class="sd">====== Batch Inference Statistics ======</span>
<a id="__codelineno-6-432" name="__codelineno-6-432"></a><span class="sd">Total Samples: 28</span>
<a id="__codelineno-6-433" name="__codelineno-6-433"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-434" name="__codelineno-6-434"></a><span class="sd">Keypoint ID     | Mean Error           | Std Dev             </span>
<a id="__codelineno-6-435" name="__codelineno-6-435"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-436" name="__codelineno-6-436"></a><span class="sd">KP 0            | 27.17042            | 15.76558</span>
<a id="__codelineno-6-437" name="__codelineno-6-437"></a><span class="sd">KP 1            | 21.63920            | 18.46684</span>
<a id="__codelineno-6-438" name="__codelineno-6-438"></a><span class="sd">KP 2            | 30.25765            | 20.59952</span>
<a id="__codelineno-6-439" name="__codelineno-6-439"></a><span class="sd">KP 3            | 25.22526            | 18.56907</span>
<a id="__codelineno-6-440" name="__codelineno-6-440"></a><span class="sd">KP 4            | 25.64672            | 13.56527</span>
<a id="__codelineno-6-441" name="__codelineno-6-441"></a><span class="sd">KP 5            | 31.95988            | 13.46944</span>
<a id="__codelineno-6-442" name="__codelineno-6-442"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-443" name="__codelineno-6-443"></a><span class="sd">OVERALL         | 26.98319</span>
<a id="__codelineno-6-444" name="__codelineno-6-444"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-445" name="__codelineno-6-445"></a>
<a id="__codelineno-6-446" name="__codelineno-6-446"></a>
<a id="__codelineno-6-447" name="__codelineno-6-447"></a><span class="sd">## 基于 Swin3D 模型的推理脚本</span>
<a id="__codelineno-6-448" name="__codelineno-6-448"></a><span class="sd">python tools/inference.py \</span>
<a id="__codelineno-6-449" name="__codelineno-6-449"></a><span class="sd">    --config-file configs/my_dataset/keypoint_swin3d.py \</span>
<a id="__codelineno-6-450" name="__codelineno-6-450"></a><span class="sd">    --weights exp/keypoint_swin3d/model/model_best.pth \</span>
<a id="__codelineno-6-451" name="__codelineno-6-451"></a><span class="sd">    --subset test \</span>
<a id="__codelineno-6-452" name="__codelineno-6-452"></a><span class="sd">    --idx -1 \</span>
<a id="__codelineno-6-453" name="__codelineno-6-453"></a><span class="sd">    --visualize \</span>
<a id="__codelineno-6-454" name="__codelineno-6-454"></a><span class="sd">    --sphere-radius 0.02 \</span>
<a id="__codelineno-6-455" name="__codelineno-6-455"></a><span class="sd">    --cube-size 0.02</span>
<a id="__codelineno-6-456" name="__codelineno-6-456"></a><span class="sd">====== Batch Inference Statistics ======</span>
<a id="__codelineno-6-457" name="__codelineno-6-457"></a><span class="sd">Total Samples: 28</span>
<a id="__codelineno-6-458" name="__codelineno-6-458"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-459" name="__codelineno-6-459"></a><span class="sd">Keypoint ID     | Mean Error           | Std Dev             </span>
<a id="__codelineno-6-460" name="__codelineno-6-460"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-461" name="__codelineno-6-461"></a><span class="sd">KP 0            | 19.49621            | 11.82266</span>
<a id="__codelineno-6-462" name="__codelineno-6-462"></a><span class="sd">KP 1            | 21.12213            | 17.46186</span>
<a id="__codelineno-6-463" name="__codelineno-6-463"></a><span class="sd">KP 2            | 31.11461            | 21.69423</span>
<a id="__codelineno-6-464" name="__codelineno-6-464"></a><span class="sd">KP 3            | 25.54762            | 19.42591</span>
<a id="__codelineno-6-465" name="__codelineno-6-465"></a><span class="sd">KP 4            | 23.38527            | 13.12805</span>
<a id="__codelineno-6-466" name="__codelineno-6-466"></a><span class="sd">KP 5            | 25.49153            | 12.77503</span>
<a id="__codelineno-6-467" name="__codelineno-6-467"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-468" name="__codelineno-6-468"></a><span class="sd">OVERALL         | 24.35956</span>
<a id="__codelineno-6-469" name="__codelineno-6-469"></a><span class="sd">-----------------------------------------------------------------</span>
<a id="__codelineno-6-470" name="__codelineno-6-470"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-471" name="__codelineno-6-471"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-6-472" name="__codelineno-6-472"></a>    <span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>例如，</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span>
<span class="normal"><a href="#__codelineno-7-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>python tools/inference.py \
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>  --config-file configs/my_dataset/keypoint_swin3d.py \
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>  --weights exp/keypoint_swin3d/model/model_best.pth \
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>  --subset test \
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>  --idx 10 \
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>  --visualize \
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>  --sphere-radius 0.02 \
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>  --cube-size 0.02
</code></pre></div></td></tr></table></div>
<p>运行效果如下：</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>====== Inference Result [Sample IDX: 10] ======
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>Scale Factor: 873.6885986328125
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>----------------------------------------
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>Keypoint ID     | Error (Original Scale)   
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>----------------------------------------
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>KP 0            | 12.1654
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>KP 1            | 6.9847
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>KP 2            | 10.8451
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>KP 3            | 16.2290
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>KP 4            | 14.2673
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>KP 5            | 12.6374
<a id="__codelineno-8-12" name="__codelineno-8-12"></a>----------------------------------------
<a id="__codelineno-8-13" name="__codelineno-8-13"></a>Mean Error      | 12.1882
<a id="__codelineno-8-14" name="__codelineno-8-14"></a>----------------------------------------
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>=&gt; Visualizing... (Point Size: 2.0)
</code></pre></div></td></tr></table></div>
<p><img alt="image-20251214115708498" src="https://cdn.jsdelivr.net/gh/Gongzihang6/Pictures@main/Medias/2025%5C12%5Cimage-20251214115708498.png" /></p>
<div class='document-dates-plugin-wrapper document-dates-bottom'><div class='document-dates-plugin' locale='zh'><div class='dd-left'><span class='dd-item' data-tippy-content data-tippy-raw='2026-01-01'><span class='material-icons' data-icon='doc_created'></span><time datetime='2026-01-01T11:23:52.062844+00:00'>2026-01-01</time></span><span class='dd-item' data-tippy-content data-tippy-raw='2026-01-01'><span class='material-icons' data-icon='doc_updated'></span><time datetime='2026-01-01T11:23:52.062844+00:00'>2026-01-01</time></span></div><div class='dd-right'><span class='material-icons' data-icon='doc_author'></span><div class='author-group'><div class='avatar-wrapper' data-name='gzh' data-tippy-content data-tippy-raw='gzh'><span class='avatar-text'></span><img class='avatar' data-src='' data-email='' /></div></div></div></div></div>
<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Render date of last update -->


<!-- Render date of creation -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render authors -->


<!-- ---------------------------------------------------------------------- -->

<!-- Render committers from GitHub -->


<!-- Render committers from GitLab -->


<!-- Render committers -->


<!-- ---------------------------------------------------------------------- -->

<!-- Determine date of last update -->

  

  <!-- Determine date of creation -->
  


<!-- Source file information -->

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine feedback configuration -->

  


<!-- Determine whether to show feedback -->


<!-- Was this page helpful? -->

  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        此页面有帮助吗？
      </legend>
      <div class="md-feedback__inner">

        <!-- Feedback ratings -->
        <div class="md-feedback__list">
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page was helpful"
              data-md-value="1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button
              class="md-feedback__icon md-icon"
              type="submit"
              title="This page could be improved"
              data-md-value="0"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>

        <!-- Feedback rating notes (shown after submission) -->
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              谢谢你的反馈！
            </div>
          
            <div data-md-value="0" hidden>
              

              <!-- Determine title -->
              
                
              

              <!-- Replace {url} and {title} placeholders in note -->
              Thanks for your feedback! Help us improve this page by using our <a href="https://marketingplatform.google.com/about/analytics/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Comment system -->





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <style>
  .md-footer {
      background-color: #f0f0f0;
  }
</style>


<!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    
      
      <nav
        class="md-footer__inner md-grid"
        aria-label="页脚"
        
      >

        <!-- Link to previous page -->
        
          
          <a
            href="../PointMamba/"
            class="md-footer__link md-footer__link--prev"
            aria-label="上一页: PointMamba"
          >
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                PointMamba
              </div>
            </div>
            
          </a>
        

        <!-- Link to next page -->
        
          
          <a
            href="../../../%E4%BC%98%E5%8C%96/Levenberg-Marquardt%E7%AE%97%E6%B3%95/"
            class="md-footer__link md-footer__link--next"
            aria-label="下一页: Levenberg Marquardt算法"
          >
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Levenberg Marquardt算法
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; gzh
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
   
      <font color="#B9B9B9">
      <div class="footer-visit-count" style="display: flex; justify-content: center; align-items: center;color: #000;">
        本站访问量：<script async src="//finicounter.eu.org/finicounter.js"></script>
        <span id="finicount_views"></span>    &nbsp;|&nbsp;
        <footer>
          <a href="https://icp.gov.moe/?keyword=20230640" target="_blank">萌ICP备20230640号</a>
        </footer>
      </div>
      </font>

        <style>
          .footer-visit-count {
              height: fit-content;
              min-height: 55px; /* 根据实际情况调整此高度 */
              color: #000;
          }
          </style>
        
          
<div class="md-social">
  
    
    
    
    
    <a href="https://cdn.jsdelivr.net/gh/Gongzihang6/Pictures@main/Medias/%E6%88%91%E7%9A%84%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81.png" target="_blank" rel="noopener" title="Wechat" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
    
    
    
    
    <a href="https://t.me/gongzihang" target="_blank" rel="noopener" title="telegram" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m115 168.7c-3.7 39.2-19.9 134.4-28.1 178.3-3.5 18.6-10.3 24.8-16.9 25.4-14.4 1.3-25.3-9.5-39.3-18.7-21.8-14.3-34.2-23.2-55.3-37.2-24.5-16.1-8.6-25 5.3-39.5 3.7-3.8 67.1-61.5 68.3-66.7.2-.7.3-3.1-1.2-4.4s-3.6-.8-5.1-.5c-2.2.5-37.1 23.5-104.6 69.1-9.9 6.8-18.9 10.1-26.9 9.9-8.9-.2-25.9-5-38.6-9.1-15.5-5-27.9-7.7-26.8-16.3.6-4.5 6.7-9 18.4-13.7 72.3-31.5 120.5-52.3 144.6-62.3 68.9-28.6 83.2-33.6 92.5-33.8 2.1 0 6.6.5 9.6 2.9 2 1.7 3.2 4.1 3.5 6.7.5 3.2.6 6.5.4 9.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ZihangGong28792" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Gongzihang6" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<zihanggong24@gmail.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M61.4 64C27.5 64 0 91.5 0 125.4c0 .9 0 1.7.1 2.6H0v256c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V128h-.1c0-.9.1-1.7.1-2.6 0-33.9-27.5-61.4-61.4-61.4zM464 192.3V384c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192.3l154.8 117.4c31.4 23.9 74.9 23.9 106.4 0zM48 125.4c0-7.4 6-13.4 13.4-13.4h389.2c7.4 0 13.4 6 13.4 13.4 0 4.2-2 8.2-5.3 10.7L280.2 271.5c-14.3 10.8-34.1 10.8-48.4 0L53.3 136.1c-3.3-2.5-5.3-6.5-5.3-10.7"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://space.bilibili.com/688234000/lists" target="_blank" rel="noopener" title="space.bilibili.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92c-26.4-.8-48.2-9.8-65.3-27.2S.7 396.5 0 368.2V169.8c.8-26 9.7-47.6 26.7-65.7C43.8 87.8 65.5 78.8 92 78h29.4L96 52.2c-5.7-5.7-8.6-13-8.6-21.8S90.3 14.3 96 8.6 109 0 117.9 0s16.1 2.9 21.9 8.6L213.1 78h88l74.5-69.4C381.7 2.9 389.2 0 398 0s16.1 2.9 21.9 8.6c5.7 5.7 8.6 13 8.6 21.8s-2.9 16.1-8.6 21.8L394.6 78h29.3c26.4.8 48 9.8 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96c-9.6.4-17.4 3.7-23.6 9.8-6.1 6.1-9.4 13.9-9.8 23.5v194.4c0 9.2 3.3 17 9.8 23.5s14.4 9.8 23.6 9.8h320.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg>
    </a>
  
</div>
        
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["announce.dismiss", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "navigation.expand", "navigation.indexes", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../../javascripts/extra.js"></script>
      
        <script src="../../../../../javascripts/config_mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../../javascripts/简历.js"></script>
      
        <script src="../../../../../assets/document_dates/tippy/popper.min.js"></script>
      
        <script src="../../../../../assets/document_dates/tippy/tippy.umd.min.js"></script>
      
        <script src="../../../../../assets/document_dates/core/md5.min.js"></script>
      
        <script src="../../../../../assets/document_dates/core/default.config.js"></script>
      
        <script src="../../../../../assets/document_dates/user.config.js"></script>
      
        <script src="../../../../../assets/document_dates/core/utils.js"></script>
      
        <script src="../../../../../assets/document_dates/core/core.js"></script>
      
    
  </body>
</html>